<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0">
  <channel>
    <title>Gorpeln的个人博客 - Gorpeln</title>
    <link>https://gorpeln.com/</link>
    <description>一个涉猎广泛（iOS、UI、PHP、VUE、APIClound、HTML、小程序、运维、产品、服务器、数据库）且致力于成为一名架构师的、狂热的iOS程序猿，充满新奇的想法并正在付诸于实际，幻想着有一天能升职加薪，当上总经理，出任CEO，迎娶白富美，走上人生巅峰！（梦想还是要有的，万一哪天实现了呢！）</description>
    
      <item>
        <title>App Store 审核指南</title>
        <link>https://gorpeln.com//article/15713825459</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15713825459</guid>
        <pubDate>Fri, 18 Oct 2019 00:00:00 +0800</pubDate>
        <description>&lt;html xmlns=&quot;https://www.w3.org/1999/xhtml&quot; xml:lang=&quot;zh-CN&quot; lang=&quot;zh-CN&quot;&gt;

&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, viewport-fit=cover&quot; /&gt;
&lt;/head&gt;

&lt;body&gt;
    &lt;main id=&quot;main&quot; class=&quot;&quot; role=&quot;main&quot;&gt;
        &lt;div&gt;App 正在改变世界，丰富人们的生活，并为像您一样的开发者提供前所未有的创新机会。因此，App Store 已成长为一个激动人心且充满活力的生态系统，正为数百万的开发者和超过十亿的用户提供服务。不管是开发新手，还是由经验丰富的程序员所组成的大型团队，我们都非常欢迎您为 App Store 开发 app，并希望能够帮助您了解我们的准则，以确保您的 app 能够快速通过审核流程。&lt;/div&gt;
        &lt;div class=&quot;column-flex large-3 small-12&quot;&gt;
            &lt;ul class=&quot;Sidenav_container&quot;&gt;
                &lt;div class=&quot;SidenavLine_line helpers.module_transition&quot; style=&quot;transform: translateY(0px);&quot;&gt;&lt;/div&gt;
                &lt;li&gt;&lt;a href=&quot;#introduction&quot; class=&quot;SidenavItem_link helpers.module_transition SidenavItem_active&quot;&gt;简介&lt;/a&gt;
                    &lt;!----&gt;
                &lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#before-you-submit&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;提交之前&lt;/a&gt;
                    &lt;!----&gt;
                &lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#safety&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;1. 安全&lt;/a&gt;
                    &lt;ul class=&quot;SidenavItem_children&quot;&gt;
                        &lt;li&gt;&lt;a href=&quot;#objectionable-content&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;1.1 令人反感的内容&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#user-generated-content&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;1.2 用户生成的内容&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#kids-category&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;1.3 儿童类别&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#physical-harm&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;1.4 人身伤害&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#developer-information&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;1.5 开发者信息&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#data-security&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;1.6 数据安全&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#performance&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;2. 性能&lt;/a&gt;
                    &lt;ul class=&quot;SidenavItem_children&quot;&gt;
                        &lt;li&gt;&lt;a href=&quot;#app-completeness&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;2.1 App 完成度&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#beta-testing&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;2.2 Beta 测试&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#accurate-metadata&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;2.3 准确的元数据&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#hardware-compatibility&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;2.4 硬件兼容性&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#software-requirements&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;2.5 软件要求&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#business&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3. 商务&lt;/a&gt;
                    &lt;ul class=&quot;SidenavItem_children&quot;&gt;
                        &lt;li&gt;&lt;a href=&quot;#payments&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1 付款&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#in-app-purchase&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1.1 App 内购买项目&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#subscriptions&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1.2 订阅&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#reader-apps&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1.3(a)“阅读器”App&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#multiplatform-services&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1.3(b) 多平台服务&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#hardware-specific-content&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1.4 硬件相关内容&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#goods-and-services&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1.5 (a) App 之外的商品和服务&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#cryptocurrencies&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1.5 (b) 加密货币&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#apple-pay&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1.6 Apple Pay&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#advertising&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.1.7 广告&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#other-business-model-issues&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.2 其他业务模式问题&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#acceptable&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.2.1 可以接受&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#unacceptable&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;3.2.2 不可接受&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#design&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;4. 设计&lt;/a&gt;
                    &lt;ul class=&quot;SidenavItem_children&quot;&gt;
                        &lt;li&gt;&lt;a href=&quot;#copycats&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;4.1 抄袭者&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#minimum-functionality&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;4.2 最低功能要求&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#spam&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;4.3 重复 App&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#extensions&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;4.4 扩展&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#apple-sites-and-services&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;4.5 Apple 站点和服务&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#alternate-app-icons&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;4.6 备选 App 图标&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#third-party-software&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;4.7 HTML5 游戏与聊天机器人 (Bot) 等&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#sign-in-with-apple&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;4.8 通过 Apple 登录&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#legal&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5. 法律&lt;/a&gt;
                    &lt;ul class=&quot;SidenavItem_children&quot;&gt;
                        &lt;li&gt;&lt;a href=&quot;#privacy&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.1 隐私&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#data-collection-and-storage&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.1.1 数据收集和存储&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#data-use-and-sharing&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.1.2 数据使用和共享&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#health-and-health-research&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.1.3 健康和健康研究&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#kids&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.1.4 儿童&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#location&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.1.5 定位服务&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#intellectual-property&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.2 知识产权&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#gaming-gambling-and-lotteries&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.3 游戏、赌博和彩票&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#vpn-apps&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.4 VPN App&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#mobile-device-management&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.5 移动设备管理&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                        &lt;li&gt;&lt;a href=&quot;#code-of-conduct&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;5.6 开发者行为准则&lt;/a&gt;
                            &lt;!----&gt;
                        &lt;/li&gt;
                    &lt;/ul&gt;
                &lt;/li&gt;
                &lt;li&gt;&lt;a href=&quot;#after-you-submit&quot; class=&quot;SidenavItem_link helpers.module_transition&quot;&gt;提交之后&lt;/a&gt;
                    &lt;!----&gt;
                &lt;/li&gt;
            &lt;/ul&gt;
        &lt;/div&gt;
        &lt;section class=&quot;section section-guidelines&quot;&gt;
            &lt;div class=&quot;section-content&quot;&gt;
                &lt;div class=&quot;row-flex&quot;&gt;
                    &lt;div class=&quot;column-flex large-3 small-12&quot;&gt;
                        &lt;ul class=&quot;sidenav-container&quot;&gt;&lt;/ul&gt;
                        &lt;script src=&quot;https://developer.apple.com/assets/scripts/sidenav.built.js&quot;&gt;&lt;/script&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;column-flex large-9 small-12 margin-bottom&quot;&gt;
                        &lt;h3 data-sidenav=&quot;&quot; id=&quot;introduction&quot;&gt;简介&lt;/h3&gt;
                        &lt;p&gt;&lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 的指导原则非常简单 - 我们希望为用户获取 app 时提供更安全可靠的体验，并为所有开发者提供借助 app 获得成功的契机。为此，我们精心打造了 &lt;span class=&quot;nowrap&quot;&gt;App Store，&lt;/span&gt;其中的每个 app 都会经过专家审核，而且还有编辑团队每天帮助广大用户发现新的 app。至于别的一切，可以考虑在开放的互联网上分享。如果 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 模式和准则与您的 app 或经营理念不能完美契合，那也没关系，我们的 Safari 浏览器也能提供出色的 Web 体验。&lt;/p&gt;
                        &lt;p&gt;在以下页面中，您会发现我们已把最新的准则清晰地划分为五个部分：安全、性能、业务、设计及法律。&lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 一直在不断变化和改善，紧跟我们客户和产品的需求。您的 app 也需要做出改变与改进，才能留在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上。&lt;/p&gt;
                        &lt;p&gt;另外，请将以下几点谨记在心：&lt;/p&gt;
                        &lt;ul class=&quot;disc top-level&quot;&gt;
                            &lt;li&gt;很多儿童会从我们这里大量下载各种 app。尽管家长控制功能能为儿童提供有效保护，但您也必须做好自己份内的工作。因此，您要知道，我们时刻都在关注这些儿童。&lt;/li&gt;
                            &lt;li&gt;&lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 是向全球数亿人分享 app 的好方法。如果您开发 app 只是为了分发给亲朋好友，那么 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 并不是最适合的途径。这时可考虑使用 Xcode 将 app 免费安装到设备上，或者使用面向 &lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 会员推出的 Ad Hoc 分发。如果您刚开始开发 app，请进一步了解 &lt;a href=&quot;https://developer.apple.com/cn/programs/&quot;&gt;&lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program&lt;/a&gt;。&lt;/li&gt;
                            &lt;li&gt;在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上发布的所有观点，我们都非常支持 — 只要这些 app 尊重用户的不同意见，并能带来良好的 app 体验。如果我们认为 app 的任何内容或行为超出了可接受的范围，我们将拒绝该 App。您可能会问，这个可接受的范围是什么？套用最高法院大法官的一句话：“当我看到的时候，我就知道了”。而且，我们相信，当您超出这个范围时，您自己也会意识到。&lt;/li&gt;
                            &lt;li&gt;如果您试图欺骗系统 (例如，试图在审核流程中弄虚作假，窃取用户数据，抄袭其他开发者的作品，操纵评分或 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上的发现方法)，我们会从商店中移除您的 app，并将您从 Developer Program 中除名。&lt;/li&gt;
                            &lt;li&gt;您要确保 app 中所含内容全部符合这些准则的要求，包括广告网络、分析服务和第三方 SDK 等；因此，在审核和选择这些内容时务必要慎重。&lt;/li&gt;
                            &lt;li&gt;某些一般不提供给开发者的功能和技术可能会以授权的形式提供，供开发者在受限情况中使用。例如，我们提供 CarPlay 车载音频、HyperVisor 和特权文件操作的授权。请查看 developer.apple.com 上的文档，进一步了解各种授权。&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;p&gt;我们希望这些准则能帮助您顺利通过 App Review 流程，并使批准和拒绝标准在整体上更加一致。本文是一个动态文稿；如果新的 app 引发了新的问题，我们可能会随时制定新的规则。也许，您的 app 就将促成新的规则。我们同样热爱 app 开发，并且尊重您所做的一切。我们正竭尽全力为您营造世界上最优秀的平台，既能让您展示才华，还能让您获得回报。&lt;/p&gt;
                        &lt;h3 data-sidenav=&quot;&quot; id=&quot;before-you-submit&quot;&gt;提交之前&lt;/h3&gt;
                        &lt;p&gt;为了帮助您尽可能顺利地通过 app 审批，请查看下方列出的常见错误行为，这些行为可能会导致审核流程延误或导致 app 被拒。这些内容不能代替准则或保证 app 获批，但确保核对这个列表中的每一项会是一个良好的开始。如果您的 app 无法再按预期方式工作，或者您不再积极地对其提供支持，那么这个 app 将从 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中移除。&lt;a href=&quot;https://developer.apple.com/cn/support/app-store-improvements/&quot;&gt;进一步了解 App Store 所做的改善&lt;/a&gt;。&lt;/p&gt;
                        &lt;p&gt;请确保：&lt;/p&gt;
                        &lt;ul class=&quot;disc top-level&quot;&gt;
                            &lt;li&gt;测试 app 是否会发生崩溃、是否存在错误&lt;/li&gt;
                            &lt;li&gt;确保所有 app 信息及元数据完整且正确&lt;/li&gt;
                            &lt;li&gt;更新您的联系信息，以便 App Review 部门在需要时与您取得联系&lt;/li&gt;
                            &lt;li&gt;提供有效的演示帐户和登录信息，以及审核 app 时所需的任何其他硬件或资源 (例如，登录凭证或示例二维码)&lt;/li&gt;
                            &lt;li&gt;启用后台服务，以使其在审核期间处于活动和可用状态&lt;/li&gt;
                            &lt;li&gt;在 App Review 备注中附上与非明显功能及 App 内购买项目相关的详细说明，包括支持文稿 (如适用)。&lt;/li&gt;
                            &lt;li&gt;检查 app 是否遵循了其他文稿中的相关指南，如：&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;div id=&quot;documentation&quot;&gt;
                            &lt;p&gt;&lt;strong&gt;开发指南&lt;/strong&gt;&lt;/p&gt;
                            &lt;ul class=&quot;links small&quot;&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;http://developer.apple.com/library/archive/documentation/iPhone/Conceptual/iPhoneOSProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40007072&quot;&gt;App 编程指南 (英文)&lt;/a&gt;&lt;/li&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/&quot;&gt;App 扩展编程指南 (英文)&lt;/a&gt;&lt;/li&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;https://developer.apple.com/icloud/documentation/data-storage/index.html&quot;&gt;iOS 数据存储指南 (英文)&lt;/a&gt;&lt;/li&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010672&quot;&gt;macOS 文件系统文档 (英文)&lt;/a&gt;&lt;/li&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;https://developer.apple.com/documentation/safariservices/safari_app_extensions&quot;&gt;Safari 浏览器 App 扩展 (英文)&lt;/a&gt;&lt;/li&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;https://help.apple.com/app-store-connect/&quot;&gt;&lt;span class=&quot;nowrap&quot;&gt;App Store Connect&lt;/span&gt; 帮助&lt;/a&gt;&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;p&gt;&lt;strong&gt;设计指南&lt;/strong&gt;&lt;/p&gt;
                            &lt;ul class=&quot;links small&quot;&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;https://developer.apple.com/design/human-interface-guidelines/&quot;&gt;Human Interface Guidelines (英文)&lt;/a&gt;&lt;/li&gt;
                            &lt;/ul&gt;
                            &lt;p&gt;&lt;strong&gt;品牌和营销指南&lt;/strong&gt;&lt;/p&gt;
                            &lt;ul class=&quot;links small&quot;&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;https://developer.apple.com/cn/app-store/marketing/guidelines/&quot;&gt;营销资源和识别标志指南&lt;/a&gt;&lt;/li&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;https://developer.apple.com/cn/apple-pay/marketing/&quot;&gt;Apple Pay 识别标志指南&lt;/a&gt;&lt;/li&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;https://developer.apple.com/wallet/Add-to-Apple-Wallet-Guidelines.pdf&quot;&gt;“添加到 Apple 钱包” 指南 (英文)&lt;/a&gt;&lt;/li&gt;
                                &lt;li class=&quot;document&quot;&gt;&lt;a href=&quot;http://www.apple.com/legal/intellectual-property/guidelinesfor3rdparties.html&quot;&gt;Apple 商标及版权使用准则 (英文)&lt;/a&gt;&lt;/li&gt;
                            &lt;/ul&gt;
                        &lt;/div&gt;
                        &lt;h3 data-sidenav=&quot;&quot; id=&quot;safety&quot;&gt;&lt;span id=&quot;1&quot;&gt;&lt;/span&gt;1. 安全&lt;/h3&gt;
                        &lt;p class=&quot;section-intro&quot;&gt;当用户通过 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 安装 app 时，他们希望获得安全的体验：app 不含令人不快或具有攻击性的内容，不会损坏用户的设备，不会在使用中造成人身伤害。我们在下方列出了主要的安全隐患。如果您想恐吓、攻击他人，则您的 app 不适合出现在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中。&lt;/p&gt;
                        &lt;ul class=&quot;no-bullet&quot;&gt;
                            &lt;li data-sidenav=&quot;1.1 令人反感的内容&quot; id=&quot;objectionable-content&quot;&gt;&lt;span id=&quot;1.1&quot;&gt;&lt;/span&gt;&lt;strong&gt;1.1 令人反感的内容&lt;/strong&gt;
                                &lt;p&gt;App 不应包含具有攻击性、不顾及他人感受、令人不安、惹人厌恶、低俗不堪或只是让人感到毛骨悚然的内容。此类内容的示例有：&lt;/p&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;1.1.1&quot;&gt;&lt;strong&gt;1.1.1&lt;/strong&gt; 诽谤、歧视或恶意的内容，包括有关宗教、种族、性取向、性别、国籍、种族起源或其他目标群体的引用或评论，特别是当 app 很可能对特定的个人或团体进行羞辱、恐吓、或造成伤害时。通常情况下，专业政治讽刺和政治幽默作家不受此要求限制。&lt;/li&gt;
                                    &lt;li id=&quot;1.1.2&quot;&gt;&lt;strong&gt;1.1.2&lt;/strong&gt; 人类或动物遭到杀害、残害、酷刑、虐待的写实描绘，或者鼓励暴力的内容。在游戏中，“敌人”不能单单针对特定种族、文化、真实存在的政府或企业，或是任何其他真实存在的实体。&lt;/li&gt;
                                    &lt;li id=&quot;1.1.3&quot;&gt;&lt;strong&gt;1.1.3&lt;/strong&gt; 鼓励非法使用或不负责任地使用武器和危险物品的描述，或者促进军火或弹药购买的描述。&lt;/li&gt;
                                    &lt;li id=&quot;1.1.4&quot;&gt;&lt;strong&gt;1.1.4&lt;/strong&gt; 过于色情的内容 (韦氏词典对“色情”一词的定义是：对性器官或性活动的露骨描述或展示，目的在于刺激性快感，而非带来美学价值或触发情感)。&lt;/li&gt;
                                    &lt;li id=&quot;1.1.5&quot;&gt;&lt;strong&gt;1.1.5&lt;/strong&gt; 具有煽动性的宗教评论，或者对宗教文本进行错误或误导性的引用。&lt;/li&gt;
                                    &lt;li id=&quot;1.1.6&quot;&gt;&lt;strong&gt;1.1.6&lt;/strong&gt; 虚假信息和功能，其中包括不准确的设备数据或用于恶作剧/开玩笑的功能，如虚假的位置跟踪器。即使指明 app“仅供娱乐”，也不能违背这一准则。支持匿名或恶作剧电话或短信/彩信的 app 会被拒绝。&lt;/li&gt;
                                    &lt;li id=&quot;1.1.7&quot;&gt;&lt;strong&gt;1.1.7&lt;/strong&gt; App Store 评论：
                                        &lt;ul class=&quot;disc&quot;&gt;
                                            &lt;li&gt;&lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 客户评论是 app 体验中不可或缺的一部分；因此，在回复客户的评论时，您应当对他们保持尊重。另外，您的回复应直接回应客户评论的主题，请勿在回复中包含个人信息、垃圾信息或营销广告。 &lt;/li&gt;
                                            &lt;li&gt;利用我们提供的 API 提示用户评价您的 app：通过这项便利功能，客户无需离开 app，就可直接在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中留下评分和评论；不允许使用预定的评论提示。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;1.2 用户生成的内容&quot; id=&quot;user-generated-content&quot;&gt;&lt;span id=&quot;1.2&quot;&gt;&lt;/span&gt;&lt;strong&gt;1.2 用户生成的内容&lt;/strong&gt;
                                &lt;p&gt;对于包含用户生成内容的 App，有特定的难题需要解决，比如知识产权侵权、匿名欺凌等。为了避免滥用，包含用户生成内容或社交网络服务的 app 必须满足以下条件：&lt;/p&gt;
                                &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                    &lt;li&gt;采用相应的方法来过滤令人反感的内容，以免这些内容在 app 中发布&lt;/li&gt;
                                    &lt;li&gt;制定一个机制，以举报攻击性内容并在出现问题时及时作出回应&lt;/li&gt;
                                    &lt;li&gt;若用户发布攻击性内容，可以取消其使用服务的资格&lt;/li&gt;
                                    &lt;li&gt;公布联系信息，以便用户与您联系&lt;/li&gt;
                                &lt;/ul&gt;
                                &lt;p&gt;如果 App 中所含的用户生成内容或服务最终主要用于色情内容、客观化现实生活中的某人（如“性感与否”投票）、进行人身威胁或欺凌，则这些 App 不适合出现在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中，它们可能会在未经通知的情况下被移除。如果应用中所含的用户生成内容来自于基于 Web 的服务，则可显示意外产生的“NSFW（公众场所不宜）”内容，前提是这些内容是默认隐藏的，只有当用户通过您的网站打开时才会显示。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;1.3 儿童类别&quot; id=&quot;kids-category&quot;&gt;&lt;span id=&quot;1.3&quot;&gt;&lt;/span&gt;&lt;strong&gt;1.3 儿童类别&lt;/strong&gt;
                                &lt;p&gt;“儿童类别”可帮助用户轻松找到专为儿童设计的 app。如果您希望参与“儿童类别”，则应该致力于为年纪较小的用户量身打造卓越的使用体验。这些 app 不得提供 app 外链接、购买机会或其他会对儿童造成干扰的内容，除非其保留在受家长监控的指定区域中。请谨记，一旦客户认为您的 app 能够满足“儿童类别”要求，您的 app 就需要一直满足后续更新中的相应准则；即使您决定取消选择此类别，也是如此。进一步了解&lt;a href=&quot;https://developer.apple.com/cn/app-store/parental-gates/&quot;&gt;家长监控&lt;/a&gt;。&lt;/p&gt;
                                &lt;p&gt;您必须遵守世界各地与在线收集儿童数据相关的适用隐私法。请务必查阅本指南的&lt;a href=&quot;#privacy&quot;&gt;“隐私”部分&lt;/a&gt;，以了解更多信息。此外，“儿童”类别的 app 不得向第三方发送个人身份识别信息或设备信息。“儿童”类别中的 app 不应包含第三方数据分析或第三方广告。这些做法可为儿童提供更安全的体验。在少数情况下，可能允许包含第三方数据分析，前提是相关服务不会收集或传输 IDFA 或关于儿童的任何身份识别信息 (如姓名、出生日期、电子邮件地址)、儿童所在位置或其设备。这包括任何设备、网络或其他可直接用来或结合其他信息来识别用户及其设备的信息。在少数情况下，也可能允许包含与页面内容相关的第三方广告，前提是该服务拥有适合“儿童”类别 app 的公开备案做法和政策，包括人工审核广告创意以确保适合相应年龄段。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;1.4 人身伤害&quot; id=&quot;physical-harm&quot;&gt;&lt;span id=&quot;1.4&quot;&gt;&lt;/span&gt;&lt;strong&gt;1.4 人身伤害&lt;/strong&gt;
                                &lt;p&gt;如果 app 的行为方式可能会造成人身伤害，我们可能会拒绝该 app。例如：&lt;/p&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;1.4.1&quot;&gt;&lt;strong&gt;1.4.1&lt;/strong&gt; 如果医疗 app 可能会提供错误的数据或信息，或用于诊断或治疗病患，则这些 app 可能会面临更加严格的审核。
                                        &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                            &lt;li&gt;App 必须清楚地披露相关数据和方法，用于佐证声明的健康测量准确度，如果准确度或方法得不到验证，我们会拒绝该 app。例如，如果 app 声称仅通过设备上的传感器就能照 X 光、测血压、测体温、测血糖浓度或测血氧含量，则这个 app 会被拒绝。&lt;/li&gt;
                                            &lt;li&gt;App 应当提醒用户，除了使用该 app，还应咨询医生的意见，然后才能做出医疗决定。&lt;/li&gt;
                                        &lt;/ul&gt;
                                        如果您的医疗 app 已经获得监管部门的批准，请随 app 提交相关文稿的链接。
                                    &lt;/li&gt;
                                    &lt;li id=&quot;1.4.2&quot;&gt;&lt;strong&gt;1.4.2&lt;/strong&gt; 药物剂量计算器必须来自药品生产企业、医院、大学、健康保险公司、药店或经过 FDA 或其相应国际部门的批准的其他实体。由于可能会对病患造成伤害，我们需要确保 app 将在长时间内获得支持，并保持更新。&lt;/li&gt;
                                    &lt;li id=&quot;1.4.3&quot;&gt;&lt;strong&gt;1.4.3&lt;/strong&gt; &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中不允许分发任何鼓励消费烟草及电子烟产品、使用违禁药物或摄入过量酒精的 app。鼓励未成年人摄入任何上述物品的 app 都会被拒绝。为大麻、烟草或管制物品的销售提供便利 (经授权的药店除外) 同样不被允许。&lt;/li&gt;
                                    &lt;li id=&quot;1.4.4&quot;&gt;&lt;strong&gt;1.4.4&lt;/strong&gt; App 只能显示由相关执法部门公布的酒后驾车检查点，不得鼓励酒后驾车和包括超速在内的其他鲁莽行为。&lt;/li&gt;
                                    &lt;li id=&quot;1.4.5&quot;&gt;&lt;strong&gt;1.4.5&lt;/strong&gt; App 不得促使客户参与赌博或挑战等活动，或以可能对自己或他人造成人身伤害的方式来使用他们的设备。&lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;1.5 开发者信息&quot; id=&quot;developer-information&quot;&gt;&lt;span id=&quot;1.5&quot;&gt;&lt;/span&gt;&lt;strong&gt;1.5 开发者信息&lt;/strong&gt;
                                &lt;p&gt;用户需要知道如何就疑问和支持问题与您取得联系。确保您的 app 及其支持 URL 中包含能轻松联系到您的联系信息；对于可能会在课堂中使用的 app 而言，这一点尤为重要。如果未能提供准确的最新联系信息，不但会让客户有不好的感受，可能还会违反某些国家/地区的法律。另外，请确保在钱包凭证中包含发卡机构的有效联系方式，以及分配给凭证的品牌或商标所有者的专用证书。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;1.6 数据安全&quot; id=&quot;data-security&quot;&gt;&lt;span id=&quot;1.6&quot;&gt;&lt;/span&gt;&lt;strong&gt;1.6 数据安全&lt;/strong&gt;
                                &lt;p&gt;App 应实施适当的安全举措，确保按照“&lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 许可协议”和这些准则 (更多信息见“准则 5.1”) 妥善处理收集到的用户信息，防止对这些信息进行未经授权使用、披露或者被第三方访问。&lt;/p&gt;
                            &lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;h3 data-sidenav=&quot;&quot; id=&quot;performance&quot;&gt;&lt;span id=&quot;2&quot;&gt;&lt;/span&gt;2. 性能&lt;/h3&gt;
                        &lt;ul class=&quot;no-bullet&quot;&gt;
                            &lt;li data-sidenav=&quot;2.1 App 完成度&quot; id=&quot;app-completeness&quot;&gt;&lt;span id=&quot;2.1&quot;&gt;&lt;/span&gt;&lt;strong&gt;2.1 App 完成度&lt;/strong&gt;
                                &lt;p&gt;提交至 App Review 的申请 (包括可供预订的 app) 应为该 app 的最终版本，并应包含所有必要的元数据和有效网址。所有占位符文本、空白网站和其他临时内容应在提交前移除。在提交 app 之前，请务必在设备上对 app 的错误和稳定性进行测试；如果您的 app 需要登录，请提供演示帐户信息 (并打开您的后台服务！)。如果您在 app 中提供了 App 内购买项目，请确保审核人员能够看到这些内容，并确保这些内容处于完整且最新的状态，否则请在审核备注中说明相关原因。请不要将 App Review 视作软件测试服务。我们将拒绝不完整的 app 套装以及会出现崩溃或存在明显技术问题的二进制文件。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;2.2 Beta 测试&quot; id=&quot;beta-testing&quot;&gt;&lt;span id=&quot;2.2&quot;&gt;&lt;/span&gt;&lt;strong&gt;2.2 Beta 测试&lt;/strong&gt;
                                &lt;p&gt;App 的演示版、Beta 版和试用版不适合出现在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中 - 请使用 TestFlight。所有通过 TestFlight 提交以进行测试发布的 App 都应旨在公开发布，并应遵循“App Review 准则”。请注意，使用 TestFlight 的 app 不得分发给测试者用以换取任何类型的报酬，包括作为众筹资金的奖励。对于 beta 版 app 的大幅更新应先提交至 TestFlight App Review 团队，然后再分发给您的测试者。欲了解更多信息，请访问“&lt;a href=&quot;https://developer.apple.com/cn/testflight/&quot;&gt;TestFlight Beta 测试&lt;/a&gt;”。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;2.3 准确的元数据&quot; id=&quot;accurate-metadata&quot;&gt;&lt;span id=&quot;2.3&quot;&gt;&lt;/span&gt;&lt;strong&gt;2.3 准确的元数据&lt;/strong&gt;
                                &lt;p&gt;客户应该知道他们在下载或购买您的 app 时会得到什么，所以请确保 app 的描述、屏幕快照和预览能够准确反映 app 的核心体验，并记得不断更新，以便保持与新版本相应的最新状态。&lt;/p&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;2.3.1&quot;&gt;&lt;strong&gt;2.3.1&lt;/strong&gt; 请勿在 app 中包含未记录的功能或隐藏功能；不管是对于最终用户还是 App Review 团队，app 功能都应清晰可见。同样，您不应该在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 或离线情况下，营销您的 app 中实际并不提供的内容或服务 (例如基于 iOS 的病毒和恶意软件扫描工具)。如果出现恶劣或屡教不改的行为，则可能会从 Apple Developer Program 中除名。我们正努力将 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 打造成值得信赖的生态系统，并希望我们的 App 开发者也能如此；如果您不诚实以待，我们之间就不会有任何业务往来。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.2&quot;&gt;&lt;strong&gt;2.3.2&lt;/strong&gt; 如果您的应用包含 App 内购买项目，请确保应用的描述、屏幕快照和预览清楚地指明是否有需要另行购买的精选项目、关卡和订阅等。如果您决定在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中推广 App 内购买项目，请确保 App 内购买项目的显示名称、屏幕快照和描述适合所有公众，并遵循“&lt;a href=&quot;https://developer.apple.com/cn/app-store/promoting-in-app-purchases/&quot;&gt;推广您的 App 内购买项目&lt;/a&gt;”中的准则；此外，您的 app 也应正确使用 &lt;a href=&quot;https://developer.apple.com/documentation/storekit/skpaymenttransactionobserver/2877502-paymentqueue&quot;&gt;SKPaymentTransactionObserver 方法 (英文)&lt;/a&gt;，以便客户可以在 app 内无缝完成购买。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.3&quot;&gt;&lt;strong&gt;2.3.3&lt;/strong&gt; 屏幕快照应展示 app 的使用情况，而非仅显示标题封面、登录页面或初始屏幕。屏幕快照还可以包括文本及图像说明 (例如：演示输入机制，如触控点或 Apple Pencil 的动画)，并展示设备上的扩展功能，如触控栏。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.4&quot;&gt;&lt;strong&gt;2.3.4&lt;/strong&gt; 预览是让客户了解 app 外观和功能的好方法。为了确保客户理解他们将在 app 中获得的体验，预览只可使用从 app 中采集的视频屏幕。Stickers 和 iMessage 信息扩展可以将用户体验展示在“信息”app 中。您也可以添加旁白和视频，或添加文本说明，以帮助说明任何无法仅通过视频进行阐明的内容。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.5&quot;&gt;&lt;strong&gt;2.3.5&lt;/strong&gt; 请为 app 选择最适合的类别，并在需要帮助时参考“&lt;a href=&quot;https://developer.apple.com/cn/app-store/categories/&quot;&gt;App Store 类别定义&lt;/a&gt;”。如果选择的类别与实际情况相差较远，我们可能会更改 app 的类别。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.6&quot;&gt;&lt;strong&gt;2.3.6&lt;/strong&gt; 请在 &lt;span class=&quot;nowrap&quot;&gt;App Store Connect&lt;/span&gt; 中诚实地回答年龄分级问题，以便让 app 与家长控制功能的分级保持一致。如果 app 分级有误，客户在获得 app 时可能会感到诧异，或促使政府监管部门展开相应调查。如果 app 所含的媒体内容要求显示内容分级或警告 (如电影、音乐和游戏等)，则需在销售 app 的每个地区内遵循当地要求。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.7&quot;&gt;&lt;strong&gt;2.3.7&lt;/strong&gt; 请选择一个独一无二的 app 名称，指定能够准确描述 app 的关键词，不要试图用商标术语、流行 app 的名称或其他不相关的短语来包装任何元数据，以此欺骗系统。App 名称必须限制在 30 个字符以内，且不得包含不属于 app 名称的价格、词语或描述。App 副标题是详细介绍 app 背景信息的绝佳之处。副标题必须遵循我们的标准元数据规则，且不得包含不当内容、提及其他 app 或做出无法证实的产品声明。Apple 可以随时修改不合适的关键字或采取其他相应步骤，以防止不当使用。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.8&quot;&gt;&lt;strong&gt;2.3.8&lt;/strong&gt; 元数据应适合所有受众，所以请确保您的 app 和 App 内购买项目的相关图标、屏幕快照和预览保持在 4+ 年龄分级；即使您的 app 分级更高，也应如此。例如，如果您的 app 是包含暴力的游戏，请勿选择包含惨烈的死亡或用枪瞄准特定角色的图像。只有“儿童类别”的 app 才能在元数据中使用类似“适合幼儿”和“适合儿童”等词语。请务必确保包括 app 名称和图标 (小图标、大图标、Apple Watch app 和备用图标等) 在内的元数据彼此相似，以免引起困惑。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.9&quot;&gt;&lt;strong&gt;2.3.9&lt;/strong&gt; 您应负责确保有权使用 app 图标、屏幕快照和预览中的所有材料，并应显示虚构的帐户信息，而非真实个人的数据。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.10&quot;&gt;&lt;strong&gt;2.3.10&lt;/strong&gt; 请确保您的 app 注重 iOS、Mac、&lt;span class=&quot;nowrap&quot;&gt;Apple TV&lt;/span&gt; 或 &lt;span class=&quot;nowrap&quot;&gt;Apple Watch&lt;/span&gt; 体验，并且不在 app 或元数据中包含其他移动平台的名称、图标或图像，除非存在已获批的特定互动功能。确保您的 app 元数据注重 app 本身及其体验。不要包含无关的信息，包括但不限于关于 Apple 或开发流程的信息。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.11&quot;&gt;&lt;strong&gt;2.3.11&lt;/strong&gt; 您提交至 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 可供预订的 app 必须为完整且可发布的状态。请确保您最终发布的 app 与其可供预订状态时所宣传的内容没有实质性差异。如果您对该 app 进行了重大更改 (例如更改其商业模式)，则应重新开始其预订销售。&lt;/li&gt;
                                    &lt;li id=&quot;2.3.12&quot;&gt;&lt;strong&gt;2.3.12&lt;/strong&gt; App 必须在其“新功能”文本中清楚地描述新功能和产品更改情况。一些简单的错误修复、安全更新和性能改进可以通过一般描述来说明，但较为重大的更改必须列明在备注中。&lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;2.4 硬件兼容性&quot; id=&quot;hardware-compatibility&quot;&gt;&lt;span id=&quot;2.4&quot;&gt;&lt;/span&gt;&lt;strong&gt;2.4 硬件兼容性&lt;/strong&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;2.4.1&quot;&gt;&lt;strong&gt;2.4.1&lt;/strong&gt; 为了确保用户能够充分利用您的 app，iPhone app 应尽量能在 iPad 上运行。我们鼓励您考虑开发通用 app，这样客户就可以在所有设备上加以使用。进一步了解 &lt;a href=&quot;https://developer.apple.com/go/?id=xcode-universal&quot;&gt;通用 app (英文)&lt;/a&gt;。&lt;/li&gt;
                                    &lt;li id=&quot;2.4.2&quot;&gt;&lt;strong&gt;2.4.2&lt;/strong&gt; 通过设计，让您的 app 节省能耗，且其使用方式不会带来设备损坏的风险。App 不应快速耗尽电池电能、产生过多的热量或对设备资源造成不必要的负担。例如，app 不得鼓励在充电期间将设备置于床垫或枕头下，或对固态硬盘进行过多的写入循环操作。App 及其中显示的任何第三方广告均不可运行无关的后台进程，如加密货币挖矿。&lt;/li&gt;
                                    &lt;li id=&quot;2.4.3&quot;&gt;&lt;strong&gt;2.4.3&lt;/strong&gt; 对于 Apple TV app，应确保用户无需使用除 Siri Remote 或第三方游戏控制器之外的硬件输入，但您可以随意提供增强功能供连接其他外围设备时使用。如果需要用户配备游戏控制器，请务必在元数据中清晰说明，以便用户知晓他们需要额外的设备才能玩游戏。&lt;/li&gt;
                                    &lt;li id=&quot;2.4.4&quot;&gt;&lt;strong&gt;2.4.4&lt;/strong&gt; App 不得建议或要求重新启动设备，或者修改与 app 核心功能无关的系统设置。例如，请勿鼓励用户关闭 Wi-Fi 或停用安全功能等。&lt;/li&gt;
                                    &lt;li id=&quot;2.4.5&quot;&gt;&lt;strong&gt;2.4.5&lt;/strong&gt; 对于通过 &lt;span class=&quot;nowrap&quot;&gt;Mac App Store&lt;/span&gt; 分发的 app，还有几个额外要求需要您留意：
                                        &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                            &lt;li&gt;&lt;strong&gt;(i)&lt;/strong&gt; 这些 app 必须妥当地沙箱化，并遵循“&lt;a href=&quot;https://developer.apple.com/library/archive/documentation/FileManagement/Conceptual/FileSystemProgrammingGuide/Introduction/Introduction.html#//apple_ref/doc/uid/TP40010672&quot;&gt;macOS 文件系统文档 (英文)&lt;/a&gt;”。另外，这些 app 只应使用相应的 macOS API 来修改其他 app 存储的用户数据 (如书签、“地址簿”或“日历”条目)。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ii)&lt;/strong&gt; 这些 app 必须使用 Xcode 中提供的技术来进行打包和提交；不允许使用第三方安装器。另外，这些 app 必须是单个的自包含 app 安装包，不能将代码或资源安装在共享位置。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iii)&lt;/strong&gt; 这些 app 不得自动启动或者在启动时包含其他自动运行的代码，不得在未经同意的情况下登录，也不得大量生成在用户退出 app 后仍在未经同意的情况下继续运行的进程。这些 app 不得将图标自动添加到程序坞中，或在用户桌面上留下快捷方式。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iv)&lt;/strong&gt; 这些 app 不得下载或安装独立的 app、kext、额外代码或资源，以向我们在审核过程中看到的 app 添加功能，或进行大幅更改。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(v)&lt;/strong&gt; 这些 app 不得申请升级至 root 特权或使用 setuid 属性。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(vi)&lt;/strong&gt; 这些 app 不得在启动时显示许可证屏幕、需要使用许可证密匙或实施自己的拷贝保护措施。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(vii)&lt;/strong&gt; 这些 app 必须使用 &lt;span class=&quot;nowrap&quot;&gt;Mac App Store&lt;/span&gt; 分发更新；不允许使用其他更新机制。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(viii)&lt;/strong&gt; 这些 app 应在当前发布的 OS 上运行，不得使用已停用或选装的技术 (如 Java、Rosetta)。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ix)&lt;/strong&gt; 这些 app 必须在单个 app 套装内包含所有的语言和本地化支持。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;2.5 软件要求&quot; id=&quot;software-requirements&quot;&gt;&lt;span id=&quot;2.5&quot;&gt;&lt;/span&gt;&lt;strong&gt;2.5 软件要求&lt;/strong&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;2.5.1&quot;&gt;&lt;strong&gt;2.5.1&lt;/strong&gt; App 仅可使用公共 API，并且必须在当前发布的 OS 上运行。进一步了解&lt;a href=&quot;https://developer.apple.com/documentation/&quot;&gt;已发布 APIs (英文)&lt;/a&gt;。及时更新您的 app，在未来的操作系统版本中不再支持的任何过时功能、框架或技术皆应被淘汰。App 使用的 API 和框架应该是为了实现预期用途，并在 app 描述中说明集成详情。例如，HomeKit 框架应提供家居自动化服务，HealthKit 则应该用于保持健康和健身目的，并集成在“健康”app 中。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.2&quot;&gt;&lt;strong&gt;2.5.2&lt;/strong&gt; App 应自包含在自己的套装中，不得在指定容器范围外读取或写入数据，也不得下载、安装或执行会引入或更改 app 特性或功能的代码，包括其他 app。仅在特殊情况下，用于教授、开发或允许学生测试可执行代码的教育类 app 可以下载所提供的代码，但这类代码不得用于其他用途。这类 app 必须开放 app 提供的源代码，让客户可以完全查看和编辑这些源代码。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.3&quot;&gt;&lt;strong&gt;2.5.3&lt;/strong&gt; 如果 app 传输的病毒、文件、计算机代码或程序会对操作系统和/或硬件功能 (包括推送通知和 Game Center) 的正常运行造成负面影响或导致其中断，则该 app 会被拒绝。屡教不改或恶劣的违规行为会导致开发者从 Apple Developer Program 中被除名。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.4&quot;&gt;&lt;strong&gt;2.5.4&lt;/strong&gt; 多任务处理 app 只允许在实现预期用途时使用后台服务：VoIP、音频播放、地理位置、任务完成记录和本地通知等。如果应用使用定位后台模式，请提醒用户，这么做会大幅降低电池续航能力。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.5&quot;&gt;&lt;strong&gt;2.5.5&lt;/strong&gt; App 必须能够在仅支持 IPv6 的网络上完全正常地运作。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.6&quot;&gt;&lt;strong&gt;2.5.6&lt;/strong&gt; 如果 app 会浏览网页，则必须使用相应的 WebKit 框架和 WebKit Javascript。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.7&quot;&gt;&lt;strong&gt;2.5.7&lt;/strong&gt; 基于蜂窝移动网络且超过 10 分钟的视频流内容必须使用 HTTP 实时流化，并包含一个 192 kbps 为底线的 HTTP 实时流化。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.8&quot;&gt;&lt;strong&gt;2.5.8&lt;/strong&gt; 如果 app 会创建替代的桌面/主屏幕环境，或者模拟多 app 插件体验，则该 app 会遭到拒绝。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.9&quot;&gt;&lt;strong&gt;2.5.9&lt;/strong&gt; 如果 app 会改变或停用标准开关 (如调高/调低音量和铃声/静音开关) 的功能，或者改变或停用其他的原生用户界面元素或行为，则该 app 会遭到拒绝。例如，app 不应屏蔽转向其他 app 的链接，或用户希望以某种特定方式运行的功能。进一步了解如何正确处理&lt;a href=&quot;https://developer.apple.com/cn/design/&quot;&gt;链接&lt;/a&gt;。 &lt;/li&gt;
                                    &lt;li id=&quot;2.5.10&quot;&gt;&lt;strong&gt;2.5.10&lt;/strong&gt; 不得提交包含空白广告横幅或测试广告的 app。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.11&quot;&gt;&lt;strong&gt;2.5.11&lt;/strong&gt; SiriKit 和快捷方式
                                        &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                            &lt;li&gt;&lt;strong&gt;(i)&lt;/strong&gt; 集成 SiriKit 和快捷方式的 app 只能登记无需其他 app 支持便可处理的意图，而且这个意图应当与用户对所述功能的预期相符。例如，如果您的 app 属于膳食计划 app，则不应融入开始体能训练的意图，即使这个 app 共享了与健身 app 的集成也不可以。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ii)&lt;/strong&gt; 确保 plist 中的词汇和短语与您的 app 及它所登记意图的 Siri 功能相符。别名必须与您的 app 或公司名称直接相关，不得使用通用术语或者包含第三方 app 名称或服务。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iii)&lt;/strong&gt; 以最直接的方式解析 Siri 请求或快捷方式，不要在请求与实现之间插入任何广告或其他市场营销信息。只有在完成相关任务需要时 (例如让用户指定特定类型的体能训练时)，才可以要求解疑。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li id=&quot;2.5.12&quot;&gt;&lt;strong&gt;2.5.12&lt;/strong&gt; 利用 CallKit 或包含 SMS Fraud 扩展的 app 应该只拦截已确认用于发送垃圾信息的电话号码。具有通话、短信或彩信拦截功能或垃圾信息识别功能的 app 必须在营销文本中清楚标识这些功能，并且说明归入拦截列表和垃圾信息列表的标准。通过这些工具获得的数据不得用于与运行或改进您的 app 或扩展没有直接关联的任何其他目的 (例如，不得出于跟踪或创建用户资料等目的来使用、共享或销售这些数据)。。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.13&quot;&gt;&lt;strong&gt;2.5.13 &lt;/strong&gt; 若有可能，使用人脸识别进行帐户验证的 app 必须使用 &lt;a href=&quot;https://developer.apple.com/documentation/localauthentication/&quot;&gt;LocalAuthentication (英文)&lt;/a&gt; (而非 ARKit 或其他人脸识别技术)，且必须对未满 13 岁的用户使用备用身份验证方式。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.14&quot;&gt;&lt;strong&gt;2.5.14&lt;/strong&gt; 在录像、记录日志或以其他方式记录用户活动时，app 必须征得用户的明确同意，而且要提供清晰的视觉和/或听觉指示。这亦包括任何对设备摄像头、麦克风、屏幕录像或其他用户输入方式的使用。&lt;/li&gt;
                                    &lt;li id=&quot;2.5.15&quot;&gt;&lt;strong&gt;2.5.15 &lt;/strong&gt; 能够让用户查看和选择文件的 app 应包含“文件”app 中的项目和用户的 iCloud 文稿。&lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;h3 data-sidenav=&quot;&quot; id=&quot;business&quot;&gt;&lt;span id=&quot;3&quot;&gt;&lt;/span&gt;3. 商务&lt;/h3&gt;
                        &lt;p class=&quot;section-intro&quot;&gt;在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中，您可以通过多种方式让自己的 App 实现盈利。如果您的业务模式并不显而易见，请务必在其元数据和 App Review 备注中加以说明。如果我们无法理解 app 的工作方式，或者 App 内购买项目不是那么一目了然，则审核会有所延误，并可能会导致 app 被拒绝。尽管价格由您决定，但是我们不会分发要价明显过高的 app 和 App 内购买项目。对于试图以不合常理的高昂价格欺骗用户的 app，我们将予以拒绝。&lt;/p&gt;
                        &lt;p class=&quot;section-intro margin-bottom-small&quot;&gt;如果我们发现您试图操纵评价，通过付费、提供奖励、经过筛选或伪造的反馈来提高排名，或者要求第三方服务代您这样做，我们将采取相应措施以保持 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 的公正性，其中可能包括将您从 Apple Developer Program 中除名。&lt;/p&gt;
                        &lt;ul class=&quot;no-bullet&quot;&gt;
                            &lt;li data-sidenav=&quot;3.1 付款&quot; id=&quot;payments&quot;&gt;&lt;span id=&quot;3.1&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1 付款&lt;/strong&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li data-sidenav=&quot;3.1.1 App 内购买项目&quot; id=&quot;in-app-purchase&quot;&gt;&lt;span id=&quot;3.1.1&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.1 App 内购买项目：&lt;/strong&gt;
                                        &lt;ul class=&quot;disc no-margin-top&quot;&gt;
                                            &lt;li&gt;如果您想要在 app 内解锁特性或功能 (解锁方式有：订阅、游戏内货币、游戏关卡、优质内容的访问权限或解锁完整版等)，则必须使用 App 内购买项目。App 不得使用自身机制来解锁内容或功能，如许可证密钥、增强现实标记、二维码等。App 及对应元数据不得包含指引客户使用非 App 内购买项目机制进行购买的按钮、外部链接或其他行动号召用语。&lt;/li&gt;
                                            &lt;li&gt;App 可以提供 App 内购买货币，供客户在 app 内“打赏”数字内容提供商。&lt;/li&gt;
                                            &lt;li&gt;通过 App 内购买项目购买的所有点数和游戏货币不得过期，并且您应确保为所有可恢复的 App 内购买项目设计一套恢复机制。&lt;/li&gt;
                                            &lt;li&gt;请务必指定正确的可购买类型，否则您的 app 将被拒绝。&lt;/li&gt;
                                            &lt;li&gt;App 可以允许用户将符合 App 内购买项目条件的物品赠予他人。此类礼品只能退款给原始购买者，而且不可交货。&lt;/li&gt;
                                            &lt;li&gt;通过 &lt;span class=&quot;nowrap&quot;&gt;Mac App Store&lt;/span&gt; 分发的 app 可托管基于非 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 机制的插件或扩展。&lt;/li&gt;
                                            &lt;li&gt;提供“战利品箱”或其他随机虚拟物品购买机制的 app 必须在客户购买前，向客户披露每种类型物品的获取几率。&lt;/li&gt;
                                            &lt;li&gt;非订阅型 app 在提供完整解锁选项前可以提供按时间计算的免费试用期，方法是在“价格等级 0”中设置非消耗型 IAP 项目，并按照命名约定“XX 天试用”来命名。在开始试用之前，app 必须清楚指明试用期时长、试用期结束后不再能访问的内容或服务，以及用户为获得完整功能而需要支付的任何后续费用。进一步了解如何使用&lt;a href=&quot;https://developer.apple.com/library/archive/releasenotes/General/ValidateAppStoreReceipt/Introduction.html&quot;&gt;收据 (英文)&lt;/a&gt;和&lt;a href=&quot;https://developer.apple.com/documentation/devicecheck&quot;&gt;设备检查 (英文)&lt;/a&gt; 来管理内容访问权限和试用期时长。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li data-sidenav=&quot;3.1.2 订阅&quot; id=&quot;subscriptions&quot;&gt;&lt;span id=&quot;3.1.2&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.2 订阅：&lt;/strong&gt;无论属于 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上哪一类别，app 都可以提供自动续订的 App 内购买订阅。在 app 内集成可自动续订的订阅时，请务必遵循下述指导原则。&lt;/li&gt;
                                    &lt;li id=&quot;permissible-uses&quot;&gt;&lt;span id=&quot;3.1.2a&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.2(a) 允许的用途：&lt;/strong&gt;如果您提供自动续订订阅，则必须为客户提供持续的价值，订阅期必须持续至少七天，并且能够在用户的所有设备上访问。以下并非详尽列表，适当的订阅示例包括：新游戏关卡；连载内容；多玩家支持；持续提供实质性更新的 app；对媒体内容的大型合集或持续更新的访问权限；软件即服务 (SAAS)；以及云服务支持。此外：
                                        &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                            &lt;li&gt;订阅可与单点式服务一起提供。例如，您可以提供整个影片库的订阅，以及单部影片购买或租赁。&lt;/li&gt;
                                            &lt;li&gt;您可以在您的多个 app 和服务中提供跨 app 的订阅项目，但这些订阅不可扩展到第三方的 app 或服务。游戏订阅中提供的游戏必须由该开发者拥有或已受独家许可 (例如：非属于游戏发布平台的一部分)。所有游戏都必须直接从 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 下载。游戏须避免订阅用户的重复支付，且不应损害非订阅用户的利益。&lt;/li&gt;
                                            &lt;li&gt; 订阅必须适用于可使用该 app 的所有用户设备。进一步了解&lt;a href=&quot;https://developer.apple.com/library/archive/documentation/NetworkingInternet/Conceptual/StoreKitGuide/Chapters/Subscriptions.html&quot;&gt;在您的多个 app 之间共享订阅项目 (英文)&lt;/a&gt;。 &lt;/li&gt;
                                            &lt;li&gt;App 不得强制要求用户为 app 评级或点评、下载其他 app，或执行其他类似操作，然后才能访问该 app 的功能、内容或者使用该 app。&lt;/li&gt;
                                            &lt;li&gt;与所有 app 一样，此类服务订阅应当允许用户直接获得付费购买的项目而无需执行额外任务，如在社交媒体上发帖、上传通讯录，以及在 app 内签到特定次数等。 &lt;/li&gt;
                                            &lt;li&gt;订阅可以包含消耗性的积分、宝石或游戏内货币等。您也可以提供包含消耗性商品打折权益的订阅 (例如能以优惠价购买宝石包的高级会员资格)。&lt;/li&gt;
                                            &lt;li&gt;如果要将现有 app 更改为基于订阅的业务模式，您不得减掉现有用户已付费购买的主要功能。例如，针对新客户引入订阅模式后，已购买“完整游戏解锁”的客户应能够继续访问完整版游戏。&lt;/li&gt;
                                            &lt;li&gt;支持自动续期订阅的 app 可以通过提供 &lt;span class=&quot;nowrap&quot;&gt;App Store Connect&lt;/span&gt; 中规定的相关信息，来为客户提供免费试用期。&lt;/li&gt;
                                            &lt;li&gt;试图诓骗用户的 app 会从 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中被移除。这包括试图通过虚假信息诱骗用户购买订阅或涉及“诱购”和欺诈行为的 app，这些 app 会被从 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中移除，您也可能会从 &lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 中除名。进一步了解&lt;a href=&quot;https://developer.apple.com/cn/app-store/subscriptions/&quot;&gt;订阅免费试用期&lt;/a&gt;。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li id=&quot;upgrades-and-downgrades&quot;&gt;&lt;span id=&quot;3.1.2b&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.2(b) 升级和降级：&lt;/strong&gt;用户应能获得无缝的升级/降级体验，并且不会出现无意间订阅同一内容的多个不同版本。请查阅关于管理订阅升级和降级选项的&lt;a href=&quot;https://developer.apple.com/cn/app-store/subscriptions/&quot;&gt;最佳做法&lt;/a&gt;。&lt;/li&gt;
                                    &lt;li&gt;&lt;span id=&quot;3.1.2c&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.2(c) 订阅信息：&lt;/strong&gt;在让客户订阅之前，您应当清晰描述付费后的具体权益。每月有几期？云存储容量有多大？具体能访问您的哪些服务？务必清晰地传达“&lt;a href=&quot;http://www.apple.com/itunes/go/itunesconnect/contracts&quot;&gt;协议、税务和银行业务&lt;/a&gt;”下“&lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 许可协议”的“附件 2”中所述的要求。&lt;/li&gt;
                                    &lt;li data-sidenav=&quot;3.1.3(a)“阅读器”App&quot; id=&quot;reader-apps&quot;&gt;&lt;span id=&quot;3.1.3a&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.3(a)“阅读器”App：&lt;/strong&gt;App 可以允许用户访问先前购买的内容或内容订阅 (具体包括：杂志、报纸、图书、音频、音乐、视频、专业数据库访问权限、VoIP、云存储以及经批准的服务，如课堂管理 app)，前提是您同意不会直接或间接引导 iOS 用户使用非 App 内购买项目机制进行购买，并且在您介绍其他购买方式的普通沟通中没有刻意阻止用户使用 App 内购买项目。&lt;/li&gt;
                                    &lt;li data-sidenav=&quot;3.1.3(b) 多平台服务&quot; id=&quot;multiplatform-services&quot;&gt;&lt;span id=&quot;3.1.3b&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.3(b) 多平台服务：&lt;/strong&gt;跨平台运行的 app 可以允许用户访问用户在别处获取的内容、订阅或功能，包括多平台游戏中的消耗品，前提是这些项目也在 app 中以 App 内购买项目的形式提供。您不得直接或间接引导 iOS 用户使用非 App 内购买机制进行购买，在您关于其他购买方式的一般说明中亦不可刻意阻止用户使用 App 内购买项目。&lt;/li&gt;
                                    &lt;li data-sidenav=&quot;3.1.4 硬件相关内容&quot; id=&quot;hardware-specific-content&quot;&gt;&lt;span id=&quot;3.1.4&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.4 硬件相关内容：&lt;/strong&gt;在为数不多的情形中，例如当功能依赖于特定的硬件功能时，app 可在不使用 App 内购买项目的情况下解锁相应功能 (例如，天文 app 会在与望远镜同步后增加功能)。与经过批准的实际产品 (如玩具) 配合使用的&lt;em&gt;可选&lt;/em&gt; app 功能可在不使用 App 内购买项目的情况下解锁特定功能，前提是它同时也提供 App 内购买项目选项。您不得要求用户通过购买无关产品或参与广告或市场活动来解锁 app 功能。&lt;/li&gt;
                                    &lt;li data-sidenav=&quot;3.1.5 (a) App 之外的商品和服务&quot; id=&quot;goods-and-services&quot;&gt;&lt;span id=&quot;3.1.5a&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.5 (a) App 之外的商品和服务：&lt;/strong&gt;如果 app 允许用户购买将在 app 之外使用的商品或服务，则必须使用 App 内购买项目以外的购买方式来收取相应款项，如 Apple Pay 或传统的信用卡入口。&lt;/li&gt;
                                    &lt;li data-sidenav=&quot;3.1.5 (b) 加密货币&quot; id=&quot;cryptocurrencies&quot;&gt;&lt;span id=&quot;3.1.5b&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.5 (b) 加密货币：&lt;/strong&gt;
                                        &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                            &lt;li&gt;(i) 钱包：App 可以协助虚拟货币储值，前提是它们由组织类别帐户的开发者提供。&lt;/li&gt;
                                            &lt;li&gt;(ii) 挖矿：App 不可参与虚拟货币挖矿，除非处理过程是在设备外进行的 (例如，云端挖矿)。&lt;/li&gt;
                                            &lt;li&gt;(iii) 兑换：App 可以通过经批准的交易所协助加密货币交易或传输，前提是它们是由交易所本身提供的。&lt;/li&gt;
                                            &lt;li&gt;(iv) 首次代币发行：App 如支持首次代币发行 (“ICO”)、数字加密货币期货交易以及其他数字加密证券或准证券交易，发布方须为已创立的银行、证券公司、期货经纪商 (“FCM”) 或其他经批准的金融机构，并遵守所有相关法律。&lt;/li&gt;
                                            &lt;li&gt;(v) 加密货币 app 不可通过完成任务来提供货币，如下载其他 app、鼓励其他用户下载，以及在社交网络发帖等。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li data-sidenav=&quot;3.1.6 Apple Pay&quot; id=&quot;apple-pay&quot;&gt;&lt;span id=&quot;3.1.6&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.6 Apple Pay：&lt;/strong&gt;如果 app 使用 Apple Pay，则在销售任何商品或服务之前，必须先向用户提供所有的基本购买信息，并且必须正确使用 Apple Pay 品牌和用户界面元素，具体要求可参考“&lt;a href=&quot;https://developer.apple.com/cn/apple-pay/marketing/&quot;&gt;Apple Pay 识别标志指南&lt;/a&gt;”和“&lt;a href=&quot;https://developer.apple.com/design/human-interface-guidelines/apple-pay/&quot;&gt;Human Interface Guidelines (英文)&lt;/a&gt;”。使用 Apple Pay 提供重复付款服务的 app 至少需要披露以下信息：
                                        &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                            &lt;li&gt;续订周期的时长；除非被取消，否则续订将会继续&lt;/li&gt;
                                            &lt;li&gt;每个周期中会提供哪些服务&lt;/li&gt;
                                            &lt;li&gt;将向客户收取的实际费用&lt;/li&gt;
                                            &lt;li&gt;如何取消&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li data-sidenav=&quot;3.1.7 广告&quot; id=&quot;advertising&quot;&gt;&lt;span id=&quot;3.1.7&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.1.7 广告：&lt;/strong&gt;App 内显示的广告必须与 app 的年龄分级相符。应允许用户查看用于将他们定向至这个广告的所有信息 (不要求用户离开 app)，并且不可涉及基于敏感用户数据的定向或行为广告。敏感的用户数据包括健康/医疗数据 (如来自 HealthKit API 的数据)、学校和课堂数据 (如来自 ClassKit 的数据)，或儿童的数据 (如来自儿童类别的 app 的数据)，等等。插播广告、会中断或阻止用户体验的广告必须清楚地表明它们属于广告，不得操纵或欺骗用户轻点它们，并且必须提供可以轻松访问和清晰可见的关闭/跳过按钮，按钮大小要足以让用户轻松解除广告。&lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;3.2 其他业务模式问题&quot; id=&quot;other-business-model-issues&quot;&gt;&lt;span id=&quot;3.2&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.2 其他业务模式问题&lt;/strong&gt;
                                &lt;p&gt;下方列表并非详尽清单，并且您提交的 app 可能会导致我们的政策有所更改或更新，但这里有一些额外的应做事宜和勿做事宜需要您谨记在心：&lt;/p&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li data-sidenav=&quot;3.2.1 可以接受&quot; id=&quot;acceptable&quot;&gt;&lt;span id=&quot;3.2.1&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.2.1 可以接受&lt;/strong&gt;
                                        &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                            &lt;li&gt;&lt;strong&gt;(i)&lt;/strong&gt; 在您的 app 中，出于购买或促销目的而展示您的其他 app，只要您的 app 不只是简单地罗列其他 app。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ii)&lt;/strong&gt; 显示或推荐专为经批准的特定需求而设计的第三方 app (如健康管理、航空以及辅助功能等)。您的 app 应能提供持续不断的编辑内容，这样 app 才不会看起来像是个摆设。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iii)&lt;/strong&gt; 在租借期限结束后，禁止访问经批准的特定租借内容 (例如电影、电视节目、音乐、图书)；所有其他项目服务不得存在过期时间。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iv)&lt;/strong&gt; 钱包凭证可用于付款或接收付款、传输交易或是提供身份验证 (例如电影票、优惠券和 VIP 凭据)。如将钱包凭证用作其他用途，则可能会导致 app 被拒，钱包凭据也有可能被撤销。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(v)&lt;/strong&gt; 保险类 app 必须免费提供，并且必须遵守 app 发布地区的相关法律，且不得使用 App 内购买项目。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(vi)&lt;/strong&gt; 经批准的非营利组织可以在他们持有的 App 或第三方 app 内进行筹款活动，前提是这些筹款活动必须遵守所有的 App Review 准则并提供 Apple Pay 支持。这类 app 必须披露资金的计划用途，遵守所有必要的当地和联邦政府法律，并且确保向捐款人提供相应的报税收据。在被要求时，还应向 App Review 团队提供其他信息。向捐款人介绍其他非营利组织的非营利组织平台必须确保 app 中列出的每一家非营利组织都已通过非营利组织批准流程。进一步了解如何成为&lt;a href=&quot;https://developer.apple.com/apple-pay/nonprofits/&quot;&gt;受批准的非营利组织 (英文)&lt;/a&gt;。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(vii)&lt;/strong&gt; App 可允许个人用户使用非 App 内购买项目机制向另一位个人送赠货币式礼物，前提为：a) 送赠方拥有决定是否进行送赠的完全自主权，b) 获赠方收取 100% 的礼物金额。然而，礼物若在任何时间点对应或包含接收任何数字内容或服务，则必须使用 App 内购买项目。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(viii)&lt;/strong&gt; App 如用于金融交易，投资或资金管理，发布方应为执行此类服务的金融机构，或必须使用由相应机构根据自身条款与条件提供的公共 API。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li data-sidenav=&quot;3.2.2 不可接受&quot; id=&quot;unacceptable&quot;&gt;&lt;span id=&quot;3.2.2&quot;&gt;&lt;/span&gt;&lt;strong&gt;3.2.2 不可接受&lt;/strong&gt;
                                        &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                            &lt;li&gt;&lt;strong&gt;(i)&lt;/strong&gt; 创建与 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 类似且用于显示第三方 app、扩展功能或插件的界面，或将其作为热门 app 的合集。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ii)&lt;/strong&gt; 通过由硬件或操作系统提供的内置功能 (诸如推送通知、照相机或陀螺仪) 或 Apple 服务 (如 Apple Music 访问或 iCloud 存储) 获利。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iii)&lt;/strong&gt; 人为地刷广告展示次数或者广告点进次数的 app，以及主要设计目的在于显示广告的 app。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iv)&lt;/strong&gt; 在 app 内为慈善机构和募款方筹集资金，除非您是经批准的非营利组织或依上文 3.2.1 (vi) 规定获得了许可。出于以上目的筹集资金的 app 必须在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上免费，并只能在 app 之外筹集，例如通过 Safari 浏览器或短信。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(v)&lt;/strong&gt; 强行限制 app 的用户群，例如限制特定地区或运营商。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(vi) &lt;/strong&gt; App 应当允许用户直接获得付费购买的项目而无需执行额外的任务，如在社交媒体上发帖、上传通讯录，以及在 app 内签到特定次数等。App 不得要求用户必须先为 app 评分或点评、观看视频、下载其他 app、点击广告或进行其他类似操作，然后才能访问 app 的功能、内容或使用 app，或者收到现金或其他补偿，包括但不限于礼品卡和代码。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(vii)&lt;/strong&gt; 人为操纵用户在其他服务中的可见性、状态或排名，除非相关服务的条款和条件允许这样做。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(viii)&lt;/strong&gt; &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中不允许分发协助进行二元期权交易的 app。请考虑使用网页版 app。App 如支持差价合约或其他金融衍生工具 (如外汇) 交易，则必须在提供服务的所有司法管辖区获得相应的许可。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ix)&lt;/strong&gt; App 不得强制要求用户为 app 评级或点评、下载其他 app，或执行其他类似操作，然后才能访问 app 的功能、内容或者使用 app。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;h3 data-sidenav=&quot;&quot; id=&quot;design&quot;&gt;&lt;span id=&quot;4&quot;&gt;&lt;/span&gt;4. 设计&lt;/h3&gt;
                        &lt;p class=&quot;section-intro&quot;&gt;Apple 客户非常注重简洁、雅致、创新且易于使用的产品，这也正是我们希望在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上看到的。您可尽情提供各种优秀设计，但要想获准在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上发布 app，至少需要满足以下标准。另请记住，即使在 app 获得批准之后，您也应当对其进行更新，确保 app 功能正常并持续吸引新客户和现有客户。停止服务或体验下降的 app 随时可能会从 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中移除。&lt;/p&gt;
                        &lt;ul class=&quot;no-bullet&quot;&gt;
                            &lt;li data-sidenav=&quot;4.1 抄袭者&quot; id=&quot;copycats&quot;&gt;&lt;span id=&quot;4.1&quot;&gt;&lt;/span&gt;&lt;strong&gt;4.1 抄袭者&lt;/strong&gt;
                                &lt;p&gt;请拿出您自己的想法。我们知道您有自己的奇思妙想，那么请将它们付诸实际。请不要简单照搬 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上的热门 app，或只是细微修改其他 app 的名称或 UI，就将其挪为己用。这么做不但有引发知识产权侵权索赔的风险，更会加剧在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中浏览的难度，并对您的开发者同仁来说也很不公平。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;4.2 最低功能要求&quot; id=&quot;minimum-functionality&quot;&gt;&lt;span id=&quot;4.2&quot;&gt;&lt;/span&gt;&lt;strong&gt;4.2 最低功能要求&lt;/strong&gt;
                                &lt;p&gt;App 应包含功能、内容和 UI，而不仅仅是一个经过重新包装的网站。如果 app 没有什么实用价值、毫无新意或者不太像是一个 app，那它就不适合出现在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中。如果 app 不能带来持久的娱乐价值，则可能无法获得批准。如果 app 只是一首歌曲或一部影片，则应提交到 &lt;span class=&quot;nowrap&quot;&gt;iTunes Store。&lt;/span&gt;如果 app 只是一本图书或游戏指南，则应提交到 &lt;span class=&quot;nowrap&quot;&gt;Apple Books Store。&lt;/span&gt;&lt;/p&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;4.2.1&quot;&gt;&lt;strong&gt;4.2.1&lt;/strong&gt; 使用 ARKit 的 app 应提供丰富而完整的增强现实体验，仅将模型放入 AR 视图或重播动画并不足够。&lt;/li&gt;
                                    &lt;li id=&quot;4.2.2&quot;&gt;&lt;strong&gt;4.2.2&lt;/strong&gt; 除了目录类 app 之外，app 不应只包含市场营销材料、广告、网络剪报、内容聚合或链接集合。&lt;/li&gt;
                                    &lt;li id=&quot;4.2.3&quot;&gt;&lt;strong&gt;4.2.3&lt;/strong&gt;
                                        &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                            &lt;li&gt;(i) App 应能独立工作，无需安装其他 app。&lt;/li&gt;
                                            &lt;li&gt;(ii) 确保 app 发布时在其二进制文件中包含有正常运行所需的充足内容。&lt;/li&gt;
                                            &lt;li&gt;(iii) 如果 app 需要下载其他资源，请披露下载大小并在下载之前提醒用户。现有 app 在 2019 年 1 月 1 日后提交的所有更新都必须遵循这一准则。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li id=&quot;4.2.4&quot;&gt;&lt;strong&gt;4.2.4&lt;/strong&gt; 与表盘类似的 &lt;span class=&quot;nowrap&quot;&gt;Apple Watch&lt;/span&gt; app 可能会令人感到困惑，因为用户会认为这些 app 能与各种设备功能 (如轻扫、通知和第三方复杂功能) 配合使用。将创意性的时间表现方式用作 app 界面是个好点子 (例如，供冲浪者使用的潮汐时钟)，但是如果您的 app 与表盘过于相像，则可能会被我们拒绝。&lt;/li&gt;
                                    &lt;li id=&quot;4.2.5&quot;&gt;&lt;strong&gt;4.2.5&lt;/strong&gt; 主要用作 iCloud 和 iCloud 云盘文件管理器的 app 需要包含更多的 app 功能，才能获得批准。&lt;/li&gt;
                                    &lt;li id=&quot;4.2.6&quot;&gt;&lt;strong&gt;4.2.6&lt;/strong&gt; 利用商业化模板或 app 生成服务创建的 app 将被拒绝，除非这个 app 由相应内容的提供商直接提交。这些模板服务若要为不同的客户提供差异化的用户体验，可提供工具来帮助客户自行创建创新的 app，但不应代表客户提交 app。模板提供商也可以考虑创建单一的二进制文件，以汇总或“选取”的模型托管所有客户端内容 (例如：在搜索餐厅的 app 里为每个客户餐厅定制独立的条目或页面，或在聚会活动 app 里为每个客户的活动创建单独的条目)。&lt;/li&gt;
                                    &lt;li id=&quot;4.2.7&quot;&gt;&lt;strong&gt;4.2.7 远程桌面客户端：&lt;/strong&gt;如果您的远程桌面 app 用作特定软件或服务的镜像，而不是主机设备的普通镜像，则必须符合以下规定：
                                        &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                            &lt;li&gt;(a) App 必须仅连接到归用户所有的主机设备 (即归用户所有的个人电脑或专用游戏控制台)；主机设备和客户端皆须通过本地局域网连接。&lt;/li&gt;
                                            &lt;li&gt;(b) 客户端中显示的任何软件或服务应完全在主机设备上执行，在主机设备屏幕上完整呈现，并且不可使用超出远程桌面传输所需的 API 或平台功能。&lt;/li&gt;
                                            &lt;li&gt;(c) 所有帐户的创建和管理均必须从主机设备发起。&lt;/li&gt;
                                            &lt;li&gt;(d) 客户端上显示的 UI 不与 iOS 或 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 视图相似，不提供商店类界面，也不能供用户浏览、选择或购买用户尚未拥有或授权的软件。为明确起见，在镜像的软件中发生的交易不需要使用 App 内购买，前提是这些交易是在主机设备上处理的。&lt;/li&gt;
                                            &lt;li&gt;(e) 云端 app 的瘦客户端不适合在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上发布。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;4.3 重复 App&quot; id=&quot;spam&quot;&gt;&lt;span id=&quot;4.3&quot;&gt;&lt;/span&gt;&lt;strong&gt;4.3 重复 App&lt;/strong&gt;
                                &lt;p&gt;请不要为同一个 app 创建多个套装 ID。如果您的 app 针对特定位置、运动队、大学等存在不同版本，请考虑提交单个 app，并提供 App 内购买项目以提供不同的功能。同时，请避免继续在已有大量类似 app 的类别下进行开发；&lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上已经有太多模拟放屁、打嗝声音的 app，以及手电筒和爱经 app。上传大量相似版本 app 的开发者会遭到 &lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 的除名。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;4.4 扩展&quot; id=&quot;extensions&quot;&gt;&lt;span id=&quot;4.4&quot;&gt;&lt;/span&gt;&lt;strong&gt;4.4 扩展&lt;/strong&gt;
                                &lt;p&gt;托管或包含扩展的 app 必须遵循“&lt;a href=&quot;https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/index.html#//apple_ref/doc/uid/TP40014214&quot;&gt;App 扩展编程指南 (英文)&lt;/a&gt;”或“&lt;a href=&quot;https://developer.apple.com/documentation/safariservices/safari_app_extensions&quot;&gt;Safari 浏览器 App 扩展指南 (英文)&lt;/a&gt;”；如果可行，还应包含诸如帮助屏幕和设置界面在内的一系列功能。您应当在 app 的市场营销文本中清晰且准确地披露提供了哪些扩展，扩展中不可包含营销、广告或 App 内购买项目。&lt;/p&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;4.4.1&quot;&gt;&lt;strong&gt;4.4.1&lt;/strong&gt; Keyboard 扩展还需要遵循一些额外的规则。&lt;br /&gt;
                                        &lt;p&gt;它们必须：&lt;/p&gt;
                                        &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                            &lt;li&gt;提供键盘输入功能 (如可输入字符)；&lt;/li&gt;
                                            &lt;li&gt;如果键盘中含有图像或表情符号，请遵循贴纸准则；&lt;/li&gt;
                                            &lt;li&gt;提供切换到下一个键盘的方法；&lt;/li&gt;
                                            &lt;li&gt;在没有网络连接和不要求完全访问权限的情况下仍能使用；&lt;/li&gt;
                                            &lt;li&gt;收集用户活动数据只是为了改进其 Keyboard 扩展在 iOS 设备上的性能。&lt;/li&gt;
                                        &lt;/ul&gt;
                                        &lt;p&gt;它们不得：&lt;/p&gt;
                                        &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                            &lt;li&gt;启动“设置”之外的其他 app；或者&lt;/li&gt;
                                            &lt;li&gt;将键盘按键用于其他行为，例如按住 return 键来启动相机等。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li id=&quot;4.4.2&quot;&gt;&lt;strong&gt;4.4.2&lt;/strong&gt; Safari 浏览器扩展必须在 macOS 上的最新版 Safari 浏览器上运行。它们不得干扰系统和 Safari 浏览器 UI 元素，并绝不能包含恶意或误导性的内容或代码。违背此规则会遭到 Apple Developer Program 除名。除了正常工作所必需的网站，Safari 浏览器扩展不得要求访问更多网站。&lt;/li&gt;
                                    &lt;li id=&quot;4.4.3&quot;&gt;&lt;strong&gt;4.4.3&lt;/strong&gt; 表情贴纸
                                        &lt;p&gt;表情贴纸是让“信息”变得更动态、更有趣的绝佳方式，让人们能够以更巧妙、有趣、有意义的方式表达自我。无论您的 app 是含有 Sticker 扩展，还是您要创建单独的表情贴纸包，其内容均不得冒犯用户、造成负面体验或违反相关法律。&lt;/p&gt;
                                        &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                            &lt;li&gt;&lt;strong&gt;(i)&lt;/strong&gt; 通常，不适合在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上发布的内容也不适合放入表情贴纸内。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ii)&lt;/strong&gt; 考虑地区敏感性，不要在难以接受或者会违反当地法律的国家/地区提供您的表情贴纸包。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iii)&lt;/strong&gt; 如果您的表情贴纸含义不易理解，请在审核备注中附上清晰的说明，从而避免导致审核流程的延误。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iv)&lt;/strong&gt; 确保您的表情贴纸在您的朋友与家人之外具有相关性；它们不应特定于个人活动、群体或关系。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(v)&lt;/strong&gt; 您必须对表情贴纸中的内容，持有所有必要的著作权、商标权和形象权及授权许可，不得提交任何未经授权的内容。请记住，您必须能够在要求时提供可核实的文件。若 app 内含有您无权使用的表情贴纸内容，这个 app 会被从 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中移除，屡次侵权者会被从 Developer Program 中除名。如果您认为自己的内容遭到其他提供商侵权，请&lt;a href=&quot;https://www.apple.com/legal/internet-services/itunes/appstorenotices/#?lang=zh&quot;&gt;点击此处提交申诉&lt;/a&gt;。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;4.5 Apple 站点和服务&quot; id=&quot;apple-sites-and-services&quot;&gt;&lt;span id=&quot;4.5&quot;&gt;&lt;/span&gt;&lt;strong&gt;4.5 Apple 站点和服务&lt;/strong&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;4.5.1&quot;&gt;&lt;strong&gt;4.5.1&lt;/strong&gt; App 可以使用获批的 Apple RSS Feed (如 &lt;span class=&quot;nowrap&quot;&gt;iTunes Store&lt;/span&gt; RSS Feed)，但不能抹除 Apple 站点 (如 apple.com、&lt;span class=&quot;nowrap&quot;&gt;iTunes Store、&lt;/span&gt;&lt;span class=&quot;nowrap&quot;&gt;App Store、&lt;/span&gt;&lt;span class=&quot;nowrap&quot;&gt;App Store Connect&lt;/span&gt; 和开发者门户等) 的任何信息，也不能使用这类信息进行排名。&lt;/li&gt;
                                    &lt;li id=&quot;4.5.2&quot;&gt;&lt;strong&gt;4.5.2&lt;/strong&gt; Apple Music
                                        &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                            &lt;li&gt;&lt;strong&gt;(i)&lt;/strong&gt; MusicKit API 可以让客户在使用您的 app 时访问自己的订阅。它们旨在为 &lt;span class=&quot;nowrap&quot;&gt;Apple Music&lt;/span&gt; 订阅用户提供轻松简便的音乐播放体验。用户必须能够发起 &lt;span class=&quot;nowrap&quot;&gt;Apple Music&lt;/span&gt; 流媒体播放，并且能够使用“播放”、“暂停”和“跳过”等标准媒体控件来浏览音乐内容。此外，您的 app 不得要求用户通过付款或间接的货币化方式来获取 &lt;span class=&quot;nowrap&quot;&gt;Apple Music&lt;/span&gt; 服务的访问权限 (如 App 内购买项目、广告、要求使用用户信息等)。请勿下载、上传或分享源自 MusicKit API 的音乐文件，除非 &lt;a href=&quot;https://developer.apple.com/musickit/&quot;&gt;MusicKit (英文)&lt;/a&gt; 文稿中已明确允许。 &lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ii)&lt;/strong&gt; 使用 MusicKit API 并不能取代为获得更深入或更复杂的音乐集成而可能需要的授权许可。例如，如果您希望您的 app 在特定时刻播放特定的歌曲，或者创建可以在社交媒体上分享的音频或视频文件，您需要直接联系版权持有人来获得许可 (如同步或改编权利) 和资源。封面插图和其他元数据仅可用于与音乐播放或播放列表相关的用途 (包括展示 app 功能的 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 屏幕快照)，未经版权持有人明确授权，不得用于任何市场营销或广告目的。在 app 中集成 Apple Music 服务时，请务必遵循“&lt;a href=&quot;https://www.apple.com/itunes/marketing-on-music/identity-guidelines.html&quot;&gt;Apple Music 识别标志指南 (英文)&lt;/a&gt;”。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iii)&lt;/strong&gt; 访问 Apple Music 用户数据 (如播放列表和个人收藏) 的 app 必须在用途字符串中清楚披露这类访问行为。收集的任何数据均不得与第三方分享，也不得用于除支持或改进 app 体验之外的任何其他用途。这类数据不得用于识别用户身份或设备，也不得用于广告定向宣传目的。 &lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;li id=&quot;4.5.3&quot;&gt;&lt;strong&gt;4.5.3&lt;/strong&gt; 不得使用 Apple 服务 (包括 Game Center 或推送通知等) 发送垃圾邮件、进行网络钓鱼，或者向客户发送未经请求的信息。不得尝试进行查找、跟踪、关联、挖掘、获得或利用玩家 ID、别名以及通过 Game Center 获得的其他信息。否则将会遭到 Apple Developer Program 的除名。&lt;/li&gt;
                                    &lt;li id=&quot;4.5.4&quot;&gt;&lt;strong&gt;4.5.4&lt;/strong&gt; App 不得将推送通知列为必需条件，并不能将这项功能用于广告、推广或直接营销用途，或者用来发送敏感的个人或机密信息。不当使用这些服务可能会导致撤销您的权限。&lt;/li&gt;
                                    &lt;li id=&quot;4.5.5&quot;&gt;&lt;strong&gt;4.5.5&lt;/strong&gt; 仅以 Game Center 团队批准的方式使用 Game Center 玩家 ID，并不得在 app 中显示或向任何第三方显示。&lt;/li&gt;
                                    &lt;li id=&quot;4.5.6&quot;&gt;&lt;strong&gt;4.5.6&lt;/strong&gt; App 可以在自身和 app 元数据中使用会呈现为 Apple 表情符号的 Unicode 字符。Apple 表情符号不可在其他平台中使用，也不可直接嵌入到您的 app 二进制文件中。&lt;/li&gt;
                                &amp;lt;/ul&amp;gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;4.6 备选 App 图标&quot; id=&quot;alternate-app-icons&quot;&gt;&lt;span id=&quot;4.6&quot;&gt;&lt;/span&gt;&lt;strong&gt;4.6 备选 App 图标&lt;/strong&gt;
                                &lt;p&gt;App 可以使用自定图标以传达特定信息 (例如表达对某个运动团队的喜爱)，前提是每次更改都由用户发起，并且 app 中应包含恢复至原始图标的设置。所有图标变体必须与 app 的内容相关，并且更改内容在所有系统资源之间应保持一致，以便“设置”和“通知”等位置中显示的图标与新的 Springboard 图标相吻合。这项功能不可用于动态、自动或连续性更改，例如用于反映最新天气信息和日历通知等。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;4.7 HTML5 游戏与聊天机器人 (Bot) 等&quot; id=&quot;third-party-software&quot;&gt;&lt;span id=&quot;4.7&quot;&gt;&lt;/span&gt;&lt;strong&gt;4.7 HTML5 游戏与聊天机器人 (Bot) 等&lt;/strong&gt;
                                &lt;p&gt;App 可包含或运行未嵌入二进制文件的代码 (如基于 HTML5 的游戏和聊天机器人等)，前提是 app 的主要目的并非代码分发，代码亦没有在商店界面或类似商店的界面中提供，而且相关软件 (1) 为免费软件或需通过 App 内购买项目进行购买；(2) 仅使用标准 WebKit 视图中提供的功能 (例如，它必须在 Safari 浏览器中原生打开和运行，且无需修改也无需其他软件)；您的 app 必须使用 WebKit 和 JavaScript Core 来运行第三方软件，且不得试图扩展或披露原生平台 API 给第三方软件；(3) 由已加入 &lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 且签署“&lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 许可协议”的开发者提供；(4) 不提供对真实货币游戏、彩票或慈善捐助的访问；(5) 遵守各个 App Review 指南中的条款 (例如，不含令人反感的内容)；并且 (6) 不支持数字商务。在被要求时，您必须提供 app 中所含软件和元数据的索引信息。它必须包含软件提供商的 &lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 团队 ID，以及可供 App Review 团队用于确认软件符合上述要求的 URL。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;4.8 通过 Apple 登录&quot; id=&quot;sign-in-with-apple&quot;&gt;&lt;span id=&quot;4.8&quot;&gt;&lt;/span&gt;&lt;strong&gt;4.8 通过 Apple 登录&lt;/strong&gt;
                                &lt;p&gt;如果 app 专门使用第三方或社交登录服务 (例如，Facebook 登录、Google 登录、通过 Twitter 登录、通过 LinkedIn 登录、通过 Amazon 登录或微信登录) 来对其进行设置或验证这个 app 的用户主帐户，则该 app 必须同时提供“通过 Apple 登录”作为等效选项。用户的主帐户是指在 app 中建立的、用于标识身份、登录和访问功能和相关服务的帐户。&lt;/p&gt;
                                &lt;p&gt;在以下情况下，不要求提供“通过 Apple 登录”选项：
                                    &lt;ul class=&quot;disc margin-top-small&quot;&gt;
                                        &lt;li&gt;您的 app 仅使用公司自有的帐户设置和登录系统。&lt;/li&gt;
                                        &lt;li&gt;您的 app 是一款教育、企业或商务 app，要求用户使用现有的教育或企业帐户登录。&lt;/li&gt;
                                        &lt;li&gt;您的 app 使用政府或行业支持的公民身份系统或电子身份证来鉴定用户身份。&lt;/li&gt;
                                        &lt;li&gt;您的 app 是特定第三方服务的客户端，用户需要使用他们的邮件、社交媒体或其他第三方帐户直接登录才能访问内容。&lt;/li&gt;
                                    &lt;/ul&gt;
                                &lt;/p&gt;
                            &lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;h3 data-sidenav=&quot;&quot; id=&quot;legal&quot;&gt;&lt;span id=&quot;5&quot;&gt;&lt;/span&gt;5. 法律&lt;/h3&gt;
                        &lt;p class=&quot;section-intro&quot;&gt;只要 app 向某个地区的用户提供，那么就必须遵守该地区的所有法律要求 (如果您不太确定，请与律师联系)。我们知道这些东西非常复杂，但除了下方所列准则以外，同时理解所有本地法律，并确保您的 app 能满足所有法律要求，是您必须承担的责任。当然，如果 app 存在唆使、宣传或鼓励犯罪的行为或明显不负责任的行为，则会被拒绝。在发现涉及如方便人口贩卖和/或剥削儿童的 app 的极端情况下，我们将通知有关当局。&lt;/p&gt;
                        &lt;ul class=&quot;no-bullet&quot;&gt;
                            &lt;li data-sidenav=&quot;5.1 隐私&quot; id=&quot;privacy&quot;&gt;&lt;span id=&quot;5.1&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.1 隐私&lt;/strong&gt;
                                &lt;p&gt;在 Apple 生态体系中，保护用户隐私总是第一要务。您要在处理个人数据时小心谨慎，以确保遵守了&lt;a href=&quot;https://developer.apple.com/documentation/uikit/core_app/protecting_the_user_s_privacy&quot;&gt;隐私保护最佳做法 (英文)&lt;/a&gt;、适用的法律和“&lt;a href=&quot;https://developer.apple.com/terms/&quot;&gt;&lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 许可协议 (英文)&lt;/a&gt;”中的条款，并满足客户的期望。尤其是：&lt;/p&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li data-sidenav=&quot;5.1.1 数据收集和存储&quot; id=&quot;data-collection-and-storage&quot;&gt;&lt;span id=&quot;5.1.1&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.1.1 数据收集和存储&lt;/strong&gt;
                                        &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                            &lt;li&gt;&lt;strong&gt;(i) 隐私政策：&lt;/strong&gt;所有 app 必须在 &lt;span class=&quot;nowrap&quot;&gt;App Store Connect&lt;/span&gt; 元数据栏位和 app 内部包含可轻松访问的隐私政策链接。隐私政策必须明确而清楚地：
                                                &lt;ul class=&quot;disc&quot;&gt;
                                                    &lt;li&gt;指明 app/服务所收集的数据 (若有)、收集数据的方式，以及这些数据的所有用途。&lt;/li&gt;
                                                    &lt;li&gt;确认与 app 共享用户数据 (遵从这些准则) 的任何第三方 (例如，分析工具、广告网络和第三方 SDK，以及能够访问用户数据的任何母公司、子公司或其他相关实体) 会提供与 app 隐私政策所述及这些准则所要求相同或等同的用户数据保护措施。&lt;/li&gt;
                                                    &lt;li&gt;解释数据保留/删除政策，并且说明用户可以如何撤销同意和/或请求删除用户数据。&lt;/li&gt;
                                                &lt;/ul&gt;
                                            &lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ii) 许可 &lt;/strong&gt;如果 app 会收集用户数据或使用数据，即使此类数据在收集当时或收集后即刻被匿名处理，app 也必须征得用户的同意才能收集。付费功能不得依赖于或要求用户授予访问这些数据的权限。App 还必须为客户提供简单易懂且易于操作的方式来撤销同意。确保您在用途说明中清楚且完整地阐述您对数据的使用。如果 app 依据欧盟《一般数据保护条例》(“GDPR”) 或类似法规，出于合法权益而不经事先同意就收集数据，则必须遵循此类法律的所有条款。进一步了解&lt;a href=&quot;https://developer.apple.com/documentation/uikit/core_app/protecting_the_user_s_privacy&quot;&gt;请求许可 (英文)&lt;/a&gt;。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iii) 数据最少化：&lt;/strong&gt;App 仅可请求访问与 app 核心功能相关的数据，并且仅可收集和使用完成相关任务所需的数据。若有可能，请使用进程外选取器或共享列表，而不要请求“照片”或“通讯录”等受保护资源的完整访问权限。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iv) 访问权限：&lt;/strong&gt;App 必须尊重用户的权限设置，不得操纵、欺骗或强迫用户同意不必要的数据访问。例如，可发布照片到社交网络的 app 不得在允许用户上传照片前要求麦克风访问权限。若有可能，请为不同意的用户提供替代解决方案。例如，如果用户拒绝共享位置，请提供手动输入地址的功能。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(v) 帐户登录：&lt;/strong&gt;如果 app 不包含基于帐户的重要功能，请允许用户在不登录的情况下使用。App 不得要求用户提供个人信息才能正常使用，除非个人信息与 app 的核心功能直接相关，或是法律要求时。如果您的核心 app 功能与特定的社交网络 (如 Facebook、微信、微博或 Twitter 等) 不相关，您必须提供无需登录或其他类似机制的访问权限。调取基本档案信息、分享到社交网络或邀请朋友使用 app 等不视为核心 app 功能。App 还必须包含用于撤销社交网络凭证的机制，以及从 app 内停用 app 与社交网络之间数据访问的机制。App 不可在设备外存储社交网络的凭证或令牌，而且只能使用此类凭证或令牌来在 app 使用期间从 app 本身直接连接社交网络。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(vi) &lt;/strong&gt;如果开发者开发的 app 试图暗中收集用户密码或其他用户私人数据，那么开发者会被从 Apple Developer Program 中除名。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iv)&lt;/strong&gt; 必须使用 SafariViewController 在显著位置向用户显示信息；不得隐藏这个控制器，也不能被其他视图或图层遮挡。此外，未经用户的知情和同意，app 不得私下利用 Safari 浏览器 ViewController 来追踪用户。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(viii)&lt;/strong&gt; 汇编个人信息的 app，如果其来源未经用户的明确同意，或并非直接源自用户 (即使是公共数据库)，则不可在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中发布。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li data-sidenav=&quot;5.1.2 数据使用和共享&quot; id=&quot;data-use-and-sharing&quot;&gt;&lt;span id=&quot;5.1.2&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.1.2 数据使用和共享&lt;/strong&gt;
                                        &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                            &lt;li&gt;&lt;strong&gt;(i) &lt;/strong&gt;除非法律另有许可，否则您不得未经他人允许而使用、传输或共享他们的个人数据。您必须提供相应的信息，说明以何种方式在哪里使用这些数据。App 收集的数据只有在为了改进 app 或用于广告投放用途 (遵守 &lt;a href=&quot;https://developer.apple.com/terms/&quot;&gt;&lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 许可协议 (英文)&lt;/a&gt;) 的前提下，才能与第三方共享。如果 app 在未经用户同意或未能符合数据隐私保护法律的情况下共享用户数据，则 app 可能会被下架，并且可能会导致您从 &lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 中除名。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ii) &lt;/strong&gt;除非法律另有明确许可，否则未经用户的额外同意，为一个用途而收集的数据不可用于其他用途。 &lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iii) &lt;/strong&gt;App 不得试图暗中基于收集的数据构建用户资料，也不得尝试、协助或鼓励他人根据从 Apple 提供的 API 收集的数据，或您所谓以“匿名”、“汇总”或其他不可识别的方式收集的数据来识别匿名用户的身份或重建用户资料。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iv) &lt;/strong&gt;请勿使用来自“通讯录”、“照片”或能访问用户数据的其他 API 的信息来构建联系人数据库，以供自己使用或出售/分发给第三方，也不要收集关于用户设备上安装有哪些 app 的信息，以用于分析或投放广告/市场营销。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(v) &lt;/strong&gt;请勿使用通过“通讯录”或“照片”收集的信息来联系用户，除非用户以个人方式明确主动发起联系；请勿包含“全部选择”选项，也不要默认选中所有联系人。在信息发送之前，您必须向用户清楚说明这个信息会如何呈现给收件人 (例如，信息中包含什么内容？发件人显示为谁？)。 &lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(vi)&lt;/strong&gt; 从 HomeKit API、HealthKit、消费者健康记录 API、MovementDisorder API、ClassKit 或深度图和/或面谱绘制工具 (例如 ARKit、相机 API 或照片 API) 收集的数据，不得用于市场营销、投放广告或基于使用情况进行其他数据挖掘，包括第三方在内。进一步了解实施 &lt;a href=&quot;https://developer.apple.com/documentation/callkit&quot;&gt;CallKit (英文)&lt;/a&gt;、&lt;a href=&quot;https://developer.apple.com/documentation/healthkit&quot;&gt;HealthKit (英文)&lt;/a&gt;、&lt;a href=&quot;https://developer.apple.com/documentation/classkit&quot;&gt;ClassKit (英文)&lt;/a&gt; 和 &lt;a href=&quot;https://developer.apple.com/cn/documentation/&quot;&gt;ARKit&lt;/a&gt; 的最佳做法。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(vii)&lt;/strong&gt; 使用 Apple Pay 的 app 只能与第三方共享通过 Apple Pay 获得的用户数据，以帮助或改进商品或服务的交付。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li data-sidenav=&quot;5.1.3 健康和健康研究&quot; id=&quot;health-and-health-research&quot;&gt;&lt;span id=&quot;5.1.3&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.1.3 健康和健康研究&lt;/strong&gt;
                                        &lt;p&gt;健康、健身和医疗数据特别敏感，涵盖这些领域的 app 必须满足额外的规则，并确保客户隐私受到保护：&lt;/p&gt;
                                        &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                            &lt;li&gt;&lt;strong&gt;(i)&lt;/strong&gt; App 仅能在获得批准的情况下，出于改进健康管理或健康研究的目的，使用在健康、健身和医疗研究背景下收集的数据 (包括从临床健康记录 API、HealthKit API、“运动与健身”、MovementDisorderAPI 或健康领域人体研究中收集的数据) 或将它披露给第三方，不得用于广告投放、市场营销或基于使用情况进行其他数据挖掘。不过，App 可以使用用户的健康或健身数据直接向该用户提供权益 (如保费减免)，前提是 app 须由提供相应权益的实体提交，而且其数据不得与第三方共享。同时，app 必须清楚说明将从设备收集的具体健康数据。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(ii)&lt;/strong&gt; App 不得将虚假或错误数据写入 HealthKit 或其他任何医疗研究/健康管理 App，不得在 iCloud 中存储个人健康信息。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iii)&lt;/strong&gt; 开展健康领域人体研究的 app 必须获得参与人员提供的知情同意书，如果涉及未成年人，则必须获得由其家长或监护人提供的知情同意书。上述知情同意书必须涵盖以下内容：(a) 研究的性质、目的和时长；(b) 具体规程，给参与人员带来的风险和益处；(c) 关于保密和数据处理 (包括与第三方共享信息的情况) 的信息；(d) 用于回答参与人员问题的联系人；以及 (e) 退出流程。&lt;/li&gt;
                                            &lt;li&gt;&lt;strong&gt;(iv)&lt;/strong&gt; 用于开展健康领域人体研究的 app 必须获得一家独立伦理审查委员会的批准。一经要求，必须提供此类批准的证明。&lt;/li&gt;
                                        &lt;/ul&gt;
                                    &lt;/li&gt;
                                    &lt;li data-sidenav=&quot;5.1.4 儿童&quot; id=&quot;kids&quot;&gt;&lt;span id=&quot;5.1.4&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.1.4 儿童&lt;/strong&gt;
                                        &lt;p&gt;出于诸多原因，您在处理儿童的个人数据时请务必小心谨慎。我们建议您仔细阅读所有要求，以遵循相关法律，如《儿童在线隐私保护法》(“COPPA”)、欧盟《一般数据保护条例》(“GDPR”) 以及任何其他适用的法律法规。&lt;/p&gt;
                                        &lt;p&gt;App 只能出于遵守适用儿童隐私法规的目的要求用户提供出生日期或家长联系信息，但必须提供一些适用于各年龄层用户的实用功能或娱乐价值。&lt;/p&gt;
                                        &lt;p&gt;主要面向儿童的 app 不应包含第三方数据分析或第三方广告。这样可以为儿童提供更安全的体验。在少数情况下，可能允许包含第三方数据分析和第三方广告，前提是这些服务遵守上文“&lt;a href=&quot;#1.3&quot;&gt;准则 1.3&lt;/a&gt;”中所述的条款。&lt;/p&gt;
                                        &lt;p&gt;此外，“儿童类别”中的 app，以及向未成年人收集个人信息 (例如姓名、地址、电子邮件、位置、照片、视频、图画、能否聊天、其他个人数据，或是将永久标识符与以上任何信息组合使用)、传输此类信息或能够共享此类信息的 app，则必须拥有隐私政策，且必须遵守适用的儿童隐私保护法规。为了清楚起见，“儿童类别”的&lt;a href=&quot;#kids-category&quot;&gt;家长监控要求&lt;/a&gt;，通常并不完全等同于在这些隐私法规下征得家长的同意后收集个人数据。&lt;/p&gt;
                                        &lt;p&gt;特此提醒，“&lt;a href=&quot;#2.3.8&quot;&gt;准则 2.3.8&lt;/a&gt;”要求只有“儿童”类别的 app 才能在元数据中使用类似“适合幼儿”和“适合儿童”等词语。不属于“儿童”类别的 app 不得在 app 名称、副标题、图标、屏幕快照或描述中包含任何暗示 app 主要受众为儿童的词汇。&lt;/p&gt;
                                    &lt;/li&gt;
                                    &lt;li data-sidenav=&quot;5.1.5 定位服务&quot; id=&quot;location&quot;&gt;&lt;span id=&quot;5.1.5&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.1.5 定位服务&lt;/strong&gt;
                                        &lt;p&gt;只有在定位服务与 app 提供的功能和服务直接相关时，才能在 app 中使用定位服务。基于位置的 API 不得用于提供紧急服务，不得对汽车、飞机和其他设备进行自主控制 (小型设备，如轻量无人机和玩具除外)，不得遥控汽车防盗系统等。在收集、传输或使用位置数据之前，务必进行通知并获得用户同意。如果 app 会使用定位服务，请务必在 app 中说明相应的原因；请参考“&lt;a href=&quot;https://developer.apple.com/design/human-interface-guidelines/ios/app-architecture/requesting-permission/&quot;&gt;Human Interface Guidelines (英文)&lt;/a&gt;”，了解相应的最佳做法。&lt;/p&gt;
                                    &lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;5.2 知识产权&quot; id=&quot;intellectual-property&quot;&gt;&lt;span id=&quot;5.2&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.2 知识产权&lt;/strong&gt;
                                &lt;p&gt;请确保 app 只包含由您创建或拥有使用许可的内容。如果您已越线并在未经许可的情况下使用了内容，您的 app 可能会被移除。当然，这也意味着如果他人抄袭了您的作品，则他们的 app 也可能会被移除。如果您认为自己的知识产权在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上受到了其他开发者的侵犯，请通过&lt;a href=&quot;http://www.apple.com/legal/internet-services/itunes/appstorenotices/#?lang=zh&quot;&gt;此网页表格&lt;/a&gt;提交权利主张。各个国家/地区的法律互不相同，但请务必避免以下常见错误：&lt;/p&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;5.2.1&quot;&gt;&lt;strong&gt;5.2.1&lt;/strong&gt; 一般性：不得在未经授权的情况下，在 app 中使用受保护的第三方材料 (例如商标、版权作品、专利设计)；也不得在 app 套装或开发者名称中包含虚假、抄袭或误导性的演示、名称或元数据。App 提交方应当是拥有或获授权使用知识产权和其他相关权利的个人或法律实体，并且应对提供 app 中的任何服务负责。&lt;/li&gt;
                                    &lt;li id=&quot;5.2.2&quot;&gt;&lt;strong&gt;5.2.2&lt;/strong&gt; 第三方站点/服务：如果您的 app 会使用、访问第三方服务、通过访问第三方服务盈利或是显示第三方服务的内容，请确保您获得在该服务的使用条款下进行此类操作的特别许可。如有相应要求，则必须提供相关授权。&lt;/li&gt;
                                    &lt;li id=&quot;5.2.3&quot;&gt;&lt;strong&gt;5.2.3&lt;/strong&gt; 音频/视频下载：app 不得促进非法文件共享，或在没有获得这些资源的明确授权的情况下，提供从第三方来源 (如 Apple Music、YouTube、SoundCloud、Vimeo) 保存、转换或下载媒体资源的能力。视频/音频内容流也有可能触犯使用条款，所以请务必在 app 访问这些服务前，进行检查。如有相应要求，则必须提供相关文稿。&lt;/li&gt;
                                    &lt;li id=&quot;5.2.4&quot;&gt;&lt;strong&gt;5.2.4&lt;/strong&gt; Apple 认可：不得误导或暗示 Apple 是 app 的来源或提供商，或者 Apple 以任何形式表示认可其质量或功能。如果您的 app 被选为“编辑选荐”，Apple 将自动显示相应徽章。&lt;/li&gt;
                                    &lt;li id=&quot;5.2.5&quot;&gt;&lt;strong&gt;5.2.5&lt;/strong&gt; Apple 产品：不得创建与现有 Apple 产品、界面 (如访达)、app (如 &lt;span class=&quot;nowrap&quot;&gt;App Store、&lt;/span&gt;&lt;span class=&quot;nowrap&quot;&gt;iTunes Store&lt;/span&gt; 或“信息”) 或广告主题外观相似或容易混淆的 app。App 和扩展功能 (包括第三方键盘和贴纸包) 不得含有 Apple 表情符号。iTunes 音乐预览内容不得用于其娱乐价值 (如用作照片拼贴画的背景音乐或游戏配音) 或其他未获授权的方式。如果 app 显示健身记录圆环，则不应以类似于“健身记录”控件的方式展示“活动”，“锻炼”或“站立”数据。请参考“&lt;a href=&quot;https://developer.apple.com/design/human-interface-guidelines/watchos/system-capabilities/health-and-fitness/#activity-rings&quot;&gt;Human Interface Guidelines (英文)&lt;/a&gt;”以了解关于如何使用健身记录圆环的更多信息。&lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;5.3 游戏、赌博和彩票&quot; id=&quot;gaming-gambling-and-lotteries&quot;&gt;&lt;span id=&quot;5.3&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.3 游戏、赌博和彩票&lt;/strong&gt;
                                &lt;p&gt;游戏、赌博和彩票的管理难度大，是 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上受到最多管制的应用类别之一。只有全面核实了即将发布您 App 的所有国家/地区的相关法律要求后，才能包含此功能，并且要做好准备此功能的审核流程需要更长的时间。您需要谨记以下事项：&lt;/p&gt;
                                &lt;ul class=&quot;no-bullet margin-top-small&quot;&gt;
                                    &lt;li id=&quot;5.3.1&quot;&gt;&lt;strong&gt;5.3.1&lt;/strong&gt; 抽奖和比赛必须由 app 的开发者赞助。&lt;/li&gt;
                                    &lt;li id=&quot;5.3.2&quot;&gt;&lt;strong&gt;5.3.2&lt;/strong&gt; 抽奖、比赛和抽彩的正式规则必须在 app 中注明，并且必须明确表示 Apple 不是赞助者，也没有以任何形式参与活动。&lt;/li&gt;
                                    &lt;li id=&quot;5.3.3&quot;&gt;&lt;strong&gt;5.3.3&lt;/strong&gt; App 不得通过 App 内购买项目购买点数或货币，以用于任何种类的真实货币游戏；不得向用户出售彩票或抽彩券；不得在 app 内进行资金转账。&lt;/li&gt;
                                    &lt;li id=&quot;5.3.4&quot;&gt;&lt;strong&gt;5.3.4&lt;/strong&gt; 提供真实货币游戏（例如体育下注、扑克、赌场游戏、赛马）或彩票的 App 必须在使用该 App 的地区获得必要的许可和批准，且只能在这些地区发布，此类 App 在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中必须免费提供。不允许在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上发布非法的赌博辅助工具，包括记牌器。彩票 App 必须有报酬、几率及奖品。&lt;/li&gt;
                                &lt;/ul&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;5.4 VPN App&quot; id=&quot;vpn-apps&quot;&gt;&lt;span id=&quot;5.4&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.4 VPN App&lt;/strong&gt;
                                &lt;p&gt;提供 VPN 服务的 app 必须利用 &lt;a href=&quot;https://developer.apple.com/documentation/networkextension/nevpnmanager&quot;&gt;NEVPNManager API (英文)&lt;/a&gt;，并且仅可由登记为企业的开发者提供。在用户进行任何操作来购买或以其他方式使用该服务之前，您必须在 app 屏幕上清楚地声明会收集哪些用户数据，以及将如何使用这些数据。无论出于任何目的，提供 VPN 服务的 App 不得出售、使用或向第三方披露任何数据；并且必须在隐私政策中做出这一承诺。VPN app 不得违反当地法律，如果您选择在需要 VPN 许可证的地区发布，则必须在 App Review 注释栏位中提供您的许可证信息。除此之外，经批准的提供商所提供的家长控制、内容拦截和安全 app 也可以使用 NEVPNManager API。不遵循这项准则的 app 会被从 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中移除，您也可能会被从 &lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 中除名。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;5.5 移动设备管理&quot; id=&quot;mobile-device-management&quot;&gt;&lt;span id=&quot;5.5&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.5 移动设备管理&lt;/strong&gt;
                                &lt;p&gt;提供移动设备管理 (MDM) 服务的 MDM App 必须向 Apple 请求此功能。此类 app 仅可由商业企业 (如商业组织、教育机构或政府机构) 提供；在少数情况下，也可由使用 MDM 提供家长控制服务的公司提供。在用户进行任何操作来购买或以其他方式使用该服务之前，您必须在 app 屏幕上清楚地声明会收集哪些用户数据，以及将如何使用这些数据。MDM app 不得违反当地法律。无论出于任何目的，提供 MDM 服务的 App 不得出售、使用或向第三方披露任何数据；并且必须在隐私政策中做出这一承诺。不遵循这项准则的 app 会被从 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中移除，您也可能会被从 &lt;span class=&quot;nowrap&quot;&gt;Apple Developer&lt;/span&gt; Program 中除名。&lt;/p&gt;
                            &lt;/li&gt;
                            &lt;li data-sidenav=&quot;5.6 开发者行为准则&quot; id=&quot;code-of-conduct&quot;&gt;&lt;span id=&quot;5.6&quot;&gt;&lt;/span&gt;&lt;strong&gt;5.6 开发者行为准则&lt;/strong&gt;
                                &lt;p&gt;请尊重每一个人，无论是在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 中回复用户评论、回应客户支持请求时，还是与 Apple 沟通时 (包括您在解决方案中心的回复)，都应做到这一点。请勿涉及任何形式的骚扰、歧视、恐吓或霸凌行为，也不要鼓励他人实施任何上述行为。&lt;/p&gt;
                                &lt;p&gt;客户的信任是 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 获得成功的基石。App 不得存在以下行为：掠夺用户或试图勒索用户；诱导用户进行非自愿的购买；强迫用户共享不必要的数据；以欺骗的方式抬高价格；针对未交付的功能或内容收取费用；或者在 app 内部或外部实施任何其他操纵行为。&lt;/p&gt;
                            &lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;h3 data-sidenav=&quot;&quot; id=&quot;after-you-submit&quot;&gt;提交之后&lt;/h3&gt;
                        &lt;p&gt;在 &lt;span class=&quot;nowrap&quot;&gt;App Store Connect&lt;/span&gt; 中提交 app 和元数据之后，您随即就会进入审核流程。请谨记以下几点：&lt;/p&gt;
                        &lt;ul class=&quot;disc top-level&quot;&gt;
                            &lt;li&gt;&lt;strong&gt;时间&lt;/strong&gt;：App Review 团队会尽快检查您的 app。不过，如果 app 比较复杂或者存在新的问题，则可能需要更深入的审查和考量。也请记住，如果 app 因为违反同一准则而一再被拒绝，或者您曾经试图操纵 App Review 流程，您的 app 将需要更长时间才能完成审核。进一步了解 &lt;a href=&quot;https://developer.apple.com/cn/app-store/review/&quot;&gt;App Review&lt;/a&gt;。&lt;/li&gt;
                            &lt;li&gt;&lt;strong&gt;状态更新&lt;/strong&gt;：App 的当前状态会反映在 &lt;span class=&quot;nowrap&quot;&gt;App Store Connect&lt;/span&gt; 中，所以请多留意此处。&lt;/li&gt;
                            &lt;li&gt;&lt;strong&gt;加急请求&lt;/strong&gt;：如果您遇到了严重的时间问题，可以&lt;a href=&quot;https://developer.apple.com/contact/app-store/?topic=expedite&quot;&gt;申请加急审核 (英文)&lt;/a&gt;。请仅在您真的需要加快审核时才提出申请，以便其他开发者的加急请求不受影响。如果我们发现您滥用此系统，从此以后我们可能都会拒绝您的申请。&lt;/li&gt;
                            &lt;li&gt;&lt;strong&gt;发布日期&lt;/strong&gt;：如果您设定了未来的发布日期，在此日到来之前，即使已经获得了 App Review 团队的批准，App 也不会显示在 &lt;span class=&quot;nowrap&quot;&gt;App Store&lt;/span&gt; 上。请注意，最多可能需要 24 小时时间，您的 App 才能显示在所有选定的商店中。&lt;/li&gt;
                            &lt;li&gt;&lt;strong&gt;拒绝&lt;/strong&gt;：我们的目标是公平、持续地遵循这些准则，但是人无完人。如果您的 app 被拒绝，但您存在疑问，或希望提供其他信息，请使用解决方案中心，以与 App Review 团队直接沟通。这样可以帮助您的 app 出现在商店中，也可帮助我们改进 App Review 流程，并在我们的政策中发现需要阐明的部分。如果您仍对结果不满意，请&lt;a href=&quot;https://developer.apple.com/contact/app-store/?topic=appeal&quot;&gt;提交申诉 (英文)&lt;/a&gt;。&lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;p class=&quot;margin-top typography-body-reduced&quot;&gt;最后更新日期：2019 年 9 月 12 日&lt;/p&gt;
                    &amp;lt;/div&amp;gt;
                &amp;lt;/div&amp;gt;
            &amp;lt;/div&amp;gt;
        &amp;lt;/section&amp;gt;
    &amp;lt;/main&amp;gt;
&amp;lt;/body&amp;gt;
&lt;script&gt;
    var scrollHeight=document.getElementById(&quot;navbar&quot;).scrollHeight;
         window.onhashchange=function(){
             var target = $(location.hash);
             if(target.length==1){
                 var top = target.offset().top-scrollHeight;
                 if(top &gt; 0){
                     $('html,body').animate({scrollTop: top}, 300);
                 }
             }
         };
&lt;/script&gt;
&amp;lt;/html&amp;gt;




&lt;style type=&quot;text/css&quot;&gt;

.SidenavItem_children{
	margin-left: 2em;
}
&lt;/style&gt;
&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/section&gt;&lt;/main&gt;&lt;/body&gt;&lt;/html&gt;
</description>
      </item>
    
      <item>
        <title>锚点跳转距离顶部指定距离</title>
        <link>https://gorpeln.com//article/15700906142</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15700906142</guid>
        <pubDate>Thu, 03 Oct 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;html&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;a href=&quot;#maodian&quot;&amp;gt;点这里跳&amp;lt;/a&amp;gt;
&amp;lt;div id=&quot;maodian&quot;&amp;gt;跳到这里&amp;lt;/div&amp;gt; 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;js+jquery&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;window.onhashchange=function(){
    var target = $(location.hash);
    if(target.length==1){
        var top = target.offset().top-120;// 距离顶部120像素
        if(top &amp;gt; 0){
            $('html,body').animate({scrollTop: top}, 1000);//带jq动画的跳转
           //$('html,body').css({scrollTop: top}) //不带jq动画的跳转
        }
    }
};
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

</description>
      </item>
    
      <item>
        <title>Jekyll 简单加密 (pwd=123456)</title>
        <link>https://gorpeln.com//article/15692409843</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15692409843</guid>
        <pubDate>Mon, 23 Sep 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;加密文章&lt;/p&gt;
&lt;html&gt;
&lt;body&gt;
    &lt;div&gt;
        &lt;ul&gt;
            &lt;li&gt;
            &lt;/li&gt;
            &lt;li&gt;
            &lt;/li&gt;
            &lt;li&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
        &lt;ul&gt;
            &lt;li&gt;
            &lt;/li&gt;
            &lt;li&gt;
            &lt;/li&gt;
            &lt;li&gt;
            &lt;/li&gt;
        &lt;/ul&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;

&lt;p&gt;这个加密安全性太低，不过可以封掉一部分读者。只需要查看一下NetWork，就可以看到对应页面的全部URL，之后有时间我再看看文本内容加密。&lt;/p&gt;

&lt;p&gt;其实很简单, 从post的header里面进行参数设置&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;layout: post
title: Jekyll 简单加密 (pwd=123456)
category: 个人博客
tags: [个人博客,Jekyll,加密]
password: 123456
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后，添加script&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;script&amp;gt;
    (function(){
        if('123456'){
            if (prompt('请输入密码') !== '123456'){
                alert('密码错误');
                window.close();
            }
        }
    })();  
&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;script&gt;
    (function(){
        if('123456'){
            if (prompt('请输入密码') !== '123456'){
                alert('密码错误');
                window.close();
            }
        }
    })();  
&lt;/script&gt;

</description>
      </item>
    
      <item>
        <title>文章置顶功能的实现 - Jekyll x Liquid</title>
        <link>https://gorpeln.com//article/15632033519</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15632033519</guid>
        <pubDate>Mon, 15 Jul 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;其实很简单, 从post的header里面进行参数设置&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;layout: post
title: Jekyll x Liquid: 文章置顶功能的实现
category: 个人博客
tags: [个人博客,Jekyll,文章置顶,gorpeln]
description: 
stickie: true
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后liquid进行判断&lt;code class=&quot;highlighter-rouge&quot;&gt;(*号换成%)&lt;/code&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{* for post in site.posts *}
    {* if post.stickie != true *}
        {* continue *}
    {* endif *}
    &amp;lt;div&amp;gt;置顶文章细节&amp;lt;/div&amp;gt;
{* endfor *}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{* for post in site.posts *}
    {* if post.stickie == true *}
        {* continue *}
    {* endif *}
    &amp;lt;div&amp;gt;普通文章细节&amp;lt;/div&amp;gt;
{* endfor *}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;当然这个可以进行多种扩展, 比如只输出特定类别的文章等等，这里就是个只输出带有gorpeln这个tag的post&lt;/p&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{* for post in site.posts *}

    {* assign isGorpeln = 0 *}

    {* for tag in post.tags *}
        {* if tag == gorpeln *}
           {* assign isGorpeln = 1 *}
        {* endif *}
    {* endfor *}

    {* if isGorpeln == 0 *}
      {* continue *}
    {* endif *}

{* endfor *}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
</description>
      </item>
    
      <item>
        <title>扩展篇 ：开发框架及前景</title>
        <link>https://gorpeln.com//article/15623480718</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15623480718</guid>
        <pubDate>Sat, 06 Jul 2019 00:00:00 +0800</pubDate>
        <description>&lt;h2 id=&quot;一小程序开源开发框架介绍&quot;&gt;一、小程序开源开发框架介绍&lt;/h2&gt;

&lt;h3 id=&quot;1wepy&quot;&gt;1、WePY&lt;/h3&gt;

&lt;p&gt;微信小程序问世没多久，大家发现用原生小程序语法开发，开发体验和效率真的不尽如人意。WePY 此时横空出世，彼时 WePY 的目的，是让小程序开发更贴近传统 H5 框架开发，支持引入 npm 包，支持组件化开发和 ES Next 新特性。&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;开发模式：更符合现有 MVVM 框架的开发模式，类 Vue，节省上手成本&lt;/li&gt;
  &lt;li&gt;组件化开发：支持组件嵌套、循环、组建通信等&lt;/li&gt;
  &lt;li&gt;npm 包管理：处理了 npm 包依赖问题&lt;/li&gt;
  &lt;li&gt;ES Next：语法更现代，提升开发体验&lt;/li&gt;
  &lt;li&gt;细节优化：setData 性能优化（脏检测）、事件传参、编译器支持、Mixin&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;正是由于 WePY 解决了原生微信小程序的开发痛点，到目前为止，WePY 也是小程序上层框架中使用方最多的。很多开发者都是基于 WePY 开发微信小程序的，微信官方后续的一些性能优化和特性支持也有 WePY 的影子。&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.npmjs.com/package/wepy-cli&quot;&gt;wepy-cli&lt;/a&gt; 的周下载量月度平均都维持在 1000 以上，远远领先于同类 cli 工具，star 数 12k+，也正如官网所说，是最受欢迎的小程序框架。使用 WePY 框架的接入，更是达到了上千家。&lt;/p&gt;

&lt;h3 id=&quot;2mpvue&quot;&gt;2、mpvue&lt;/h3&gt;

&lt;p&gt;随着小程序接入量的猛增，业界也在不断地对小程序开发体验进行尝试。2018 年 3 月，美团点评发布了一个名叫 mpvue 的小程序框架。mpvue 是一套定位于开发小程序的前端开发框架，其核心目标是提高开发效率，增强开发体验。&lt;/p&gt;

&lt;p&gt;mpvue 是基于 Vue 的 Runtime（Vue Runtime 除了我们知道的 Web 平台之外，还有 Weex），相比 WePY，mpvue 的语法更接近 Vue 语法，对于有 Vue 基础的童鞋，可以无缝切换到小程序的开发，省下了学习小程序语法的时间。&lt;/p&gt;

&lt;h3 id=&quot;3taro&quot;&gt;3、Taro&lt;/h3&gt;

&lt;p&gt;Taro 是 2018 年 6 月，由京东凹凸实验室出品的一款号称多端统一的框架。这里的端，指的是 Web、App（React Native、Weex）、小程序。Taro 主打「一次编写，多端运行」，是继 WePY 和 mpvue 之后，在多平台上做到了更彻底的一款框架。&lt;/p&gt;

&lt;h3 id=&quot;4小程序开发框架总结&quot;&gt;4、小程序开发框架总结&lt;/h3&gt;

&lt;p&gt;微信小程序诞生之初，定位是简单的逻辑视图层框架，所以不带有数据流管理。经常看到一些小程序开发者，通过手工引入 Redux，去做数据流管理。上面的三款框架，都是支持数据流管理的。它们总体的特性与不同，可以参见下面的表格。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;特性&lt;/th&gt;
      &lt;th&gt;语法规范&lt;/th&gt;
      &lt;th&gt;模板系统&lt;/th&gt;
      &lt;th&gt;组件化&lt;/th&gt;
      &lt;th&gt;样式规范&lt;/th&gt;
      &lt;th&gt;多端复用&lt;/th&gt;
      &lt;th&gt;自动构建&lt;/th&gt;
      &lt;th&gt;上手成本&lt;/th&gt;
      &lt;th&gt;数据流管理&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;微信小程序&lt;/td&gt;
      &lt;td&gt;小程序规范&lt;/td&gt;
      &lt;td&gt;字符串模板&lt;/td&gt;
      &lt;td&gt;不太 OK 的小程序组件化&lt;/td&gt;
      &lt;td&gt;WXSS&lt;/td&gt;
      &lt;td&gt;无&lt;/td&gt;
      &lt;td&gt;无&lt;/td&gt;
      &lt;td&gt;全新学习&lt;/td&gt;
      &lt;td&gt;不支持&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;mpvue&lt;/td&gt;
      &lt;td&gt;Vue.js 规范&lt;/td&gt;
      &lt;td&gt;字符串模板&lt;/td&gt;
      &lt;td&gt;Vue.js 组件化规范&lt;/td&gt;
      &lt;td&gt;Sass、Less、PostCSS&lt;/td&gt;
      &lt;td&gt;复用 H5&lt;/td&gt;
      &lt;td&gt;webpack 构建&lt;/td&gt;
      &lt;td&gt;熟悉 Vue.js&lt;/td&gt;
      &lt;td&gt;Vuex&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;WePY&lt;/td&gt;
      &lt;td&gt;类 Vue.js 规范&lt;/td&gt;
      &lt;td&gt;字符串模板&lt;/td&gt;
      &lt;td&gt;自定义组件化规范&lt;/td&gt;
      &lt;td&gt;Sass、Less、Stylus&lt;/td&gt;
      &lt;td&gt;复用 H5&lt;/td&gt;
      &lt;td&gt;内建构建系统&lt;/td&gt;
      &lt;td&gt;熟悉 Vue.js&lt;/td&gt;
      &lt;td&gt;Redux&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;Taro&lt;/td&gt;
      &lt;td&gt;React 规范&lt;/td&gt;
      &lt;td&gt;JSX&lt;/td&gt;
      &lt;td&gt;React 组件化规范&lt;/td&gt;
      &lt;td&gt;Sass、Less、PostCSS&lt;/td&gt;
      &lt;td&gt;复用 H5 &amp;amp; 通过 RN 支持移动端&lt;/td&gt;
      &lt;td&gt;内建构建系统 + webpack&lt;/td&gt;
      &lt;td&gt;熟悉 React&lt;/td&gt;
      &lt;td&gt;Redux&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;最后补充一句：任何解决方案都是在其特定使用场景下诞生的，并没有「放之四海而皆准」的方案。虽然引入新方案有时是为了解决语法、开发成本之类的问题，但可能同时又产生新的坑，因此如果是新手要做复杂的小程序项目，建议使用小程序自带的解决方案；如果是某个解决方案的熟手，可以考虑在大型小程序项目中选择自己顺手的解决方案。&lt;/p&gt;

&lt;h2 id=&quot;二小程序前景分析&quot;&gt;二、小程序前景分析&lt;/h2&gt;

&lt;p&gt;微信小程序其实已经抓住了一个用户痛点：我们安装的 N 多 App，其实一周甚至一个月都不会打开一次，这类 App 适合做成小程序，做到真正的「用完即走」。当然微信本身不可能只是这么「肤浅」，小程序实际是微信生态的重要一环，商家服务在小程序内可以完成闭环体验，小程序为其提供更好的用户体验。另外，现在制作 App 的成本越来越低，而 App 中的内容又更加封闭，不好做索引，微信这类超级 App 会变成导流工具，大家看重的是微信的入口，而最终目的是脱离微信，将用户导流到自己的 App 内。微信小程序也可以打破这个局面，将用户留在微信。&lt;/p&gt;

&lt;p&gt;下面说下微信的技术前景。微信小程序是一套近乎完美的 Hybrid 解决方案，从开发流程到生态建设，小程序开发者都做了设计和布局，但是小程序只是微信的小程序（某些 App 自己的小程序，比如百度智能小程序、支付宝小程序），这些解决方案是围绕一个 App 而设计的，相对于 PWA（渐进式 Web 应用）这类标准的推进，封闭的解决方案必然会受到挑战。笔者认为，随着标准的成熟、浏览器的跟进、硬件和网络的提升，行业标准的解决方案才是未来方向。而且小程序这个封闭的解决方案，运行在更大的封闭系统内，本身就具有争议性，小程序发展肯定会受限于苹果公司 iOS 审核规定，未来小程序和苹果 iOS 审核之间会有不小的冲突，比如苹果公司会严格限制小程序和小游戏的分发，不允许微信内给小程序和小游戏开放更大的入口；微信的虚拟支付也是苹果公司的重点打击对象。&lt;/p&gt;

</description>
      </item>
    
      <item>
        <title>实战篇 ：电商小程序云开发实战</title>
        <link>https://gorpeln.com//article/15618778699</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15618778699</guid>
        <pubDate>Sun, 30 Jun 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;小程序名称：gorpeln（已上线）
提示：因个人开发账户限制，部分功能无法通过审核，所以隐藏了，全部功能体验请留言。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/blog_wxmini_qrcode.jpg&quot; alt=&quot;blog_wxmini_qrcode&quot; /&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;小程序端主要包括：（开发中…）&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;首页&lt;/li&gt;
  &lt;li&gt;分类&lt;/li&gt;
  &lt;li&gt;购物车（收藏）&lt;/li&gt;
  &lt;li&gt;我的&lt;/li&gt;
  &lt;li&gt;商品详情页&lt;/li&gt;
  &lt;li&gt;活动详情页&lt;/li&gt;
  &lt;li&gt;订单详情页&lt;/li&gt;
  &lt;li&gt;订单列表&lt;/li&gt;
  &lt;li&gt;地址列表&lt;/li&gt;
  &lt;li&gt;添加地址&lt;/li&gt;
  &lt;li&gt;修改地址&lt;/li&gt;
  &lt;li&gt;购买&lt;/li&gt;
  &lt;li&gt;支付&lt;/li&gt;
  &lt;li&gt;优惠券专区&lt;/li&gt;
  &lt;li&gt;邀请有礼&lt;/li&gt;
  &lt;li&gt;海报&lt;/li&gt;
  &lt;li&gt;排序&lt;/li&gt;
  &lt;li&gt;客服&lt;/li&gt;
&lt;/ul&gt;

&lt;hr /&gt;

&lt;p&gt;后端：（开发中…）&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;轮播图上传、下线&lt;/li&gt;
&lt;/ul&gt;

</description>
      </item>
    
      <item>
        <title>基础篇 3：小程序架构及其实现机制</title>
        <link>https://gorpeln.com//article/15612663893</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15612663893</guid>
        <pubDate>Sun, 23 Jun 2019 00:00:00 +0800</pubDate>
        <description>&lt;h2 id=&quot;一小程序-vs-html5&quot;&gt;一、小程序 VS HTML5&lt;/h2&gt;

&lt;p&gt;小程序并不是 HTML5 应用，而是更偏向于传统的 CS 架构，它是基于&lt;strong&gt;数据驱动&lt;/strong&gt;的模式，一切皆组件（视图组件）。下面是小程序与普通 Web App 的对比。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;普通 HTML5 都是执行在浏览器的宿主环境，浏览器提供 &lt;code class=&quot;highlighter-rouge&quot;&gt;window&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;document&lt;/code&gt; 等 BOM 对象，但小程序没有 &lt;code class=&quot;highlighter-rouge&quot;&gt;window&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;document&lt;/code&gt;，它更像是一个类似 Node.js 的宿主环境；因此在小程序内不能使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;document.querySelector&lt;/code&gt; 这类 DOM 选择器，也不支持 &lt;code class=&quot;highlighter-rouge&quot;&gt;XMLHttpRequest&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;location&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;localStorage&lt;/code&gt; 等这些浏览器提供的 API，只能使用小程序自己实现的 API&lt;/li&gt;
  &lt;li&gt;小程序并非是直接通过 URL 访问的，而是通过信道服务进行通信和会话管理，所以它不支持 Cookie 存储，同时访问资源使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx.request&lt;/code&gt; 则不存在跨域的问题&lt;/li&gt;
  &lt;li&gt;小程序在 JavaScript 的模块化上支持 CommonJS，通过 require 加载，跟 Node.js 类似&lt;/li&gt;
  &lt;li&gt;小程序的页面样式完全继承了 CSS 的语法，但是在选择器上面会少一些，布局支持 flex 布局&lt;/li&gt;
  &lt;li&gt;小程序的整体框架采用面向状态编程方式，状态管理从 API 来看采用类似 Redux 的设计方式；单向数据绑定方式，当 View 在 Action 操作后，只能通过 Action 的业务处理来更新 View&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;页面组件模块上，WXML 提供了一整套的「自定义 UI 组件标签」，有些组件实际是 HTML5 实现的，有些组件为了解决权限、性能和适配等问题实际是 Native 实现的（如 map、input、canvas、video）。&lt;/p&gt;

&lt;h2 id=&quot;二小程序架构解密&quot;&gt;二、小程序架构解密&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_001.jpg&quot; alt=&quot;blog_wxmini_3_001&quot; /&gt;&lt;/p&gt;

&lt;p&gt;小程序架构如上图所示，分为视图层和逻辑层，视图层是在 WebView 内渲染，逻辑层则有 JavaScriptCore 来渲染；其中视图层可以多个（考虑到整体性能，最多可以 5 个），逻辑层则全局只有一个（实际通过开启 X5 内核另起一个 JavascriptCore 线程）。&lt;/p&gt;

&lt;p&gt;在小程序内，视图层负责页面渲染，逻辑层负责逻辑处理、全局状态管理、请求和接口调用。逻辑层在小程序中称为 &lt;code class=&quot;highlighter-rouge&quot;&gt;APP Service&lt;/code&gt;，视图层称为 &lt;code class=&quot;highlighter-rouge&quot;&gt;View&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;逻辑层和视图层通过微信的 &lt;code class=&quot;highlighter-rouge&quot;&gt;JSBridge&lt;/code&gt; 来实现通信的，逻辑层数据变化通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;JSBridge&lt;/code&gt; 通知视图层，触发视图层更新；当视图层触发事件，则继续通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;JSBridge&lt;/code&gt; 将事件通知到逻辑层做处理，如此交互进行。&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;JSBridge&lt;/code&gt; 在三个环境（开发者工具、iOS 和 Android）中实现机制不同，在调用 Native 能力时主要使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;invokeHandler&lt;/code&gt;：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;开发者工具：通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;window.postMessage&lt;/code&gt; 来封装&lt;/li&gt;
  &lt;li&gt;iOS：通过 WKWebview 的 &lt;code class=&quot;highlighter-rouge&quot;&gt;window.webkit.messageHandlers.invokeHandler.postMessage&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Android：通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;WeixinJSCore.invokeHandler&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;在消息分发的时候，则使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;publishHandler&lt;/code&gt;：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;开发者工具：通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;addEventListener('message')&lt;/code&gt; 来监听消息，然后处理分发&lt;/li&gt;
  &lt;li&gt;iOS：使用 WKWebview 的 &lt;code class=&quot;highlighter-rouge&quot;&gt;window.webkit.messageHandlers.publishHandler.postMessage&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Android：通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;WeixinJSCore.publishHandler&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;其中，Android 的 &lt;code class=&quot;highlighter-rouge&quot;&gt;WeixinJSCore&lt;/code&gt; 是 X5 内核暴露出来的对象，其作为 &lt;code class=&quot;highlighter-rouge&quot;&gt;window&lt;/code&gt; 对象的一个属性，提供一些供 JavaScript 调用的能力。&lt;/p&gt;

&lt;p&gt;这部分可以在开发者工具或者 X5 内核 debug 模式下，找到 &lt;code class=&quot;highlighter-rouge&quot;&gt;WAService.js&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;WeixinJSBridge 提供的方法有 &lt;code class=&quot;highlighter-rouge&quot;&gt;invoke&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;publish&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;subscribe&lt;/code&gt; 等，&lt;code class=&quot;highlighter-rouge&quot;&gt;invoke&lt;/code&gt; 就是关键的调用 Native 端能力的方法，&lt;code class=&quot;highlighter-rouge&quot;&gt;publish&lt;/code&gt; 是消息分发的方法。注意下图的 &lt;code class=&quot;highlighter-rouge&quot;&gt;invoke&lt;/code&gt; 实际是来自&lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt;，&lt;code class=&quot;highlighter-rouge&quot;&gt;publish&lt;/code&gt; 来自 &lt;code class=&quot;highlighter-rouge&quot;&gt;w&lt;/code&gt;，&lt;code class=&quot;highlighter-rouge&quot;&gt;e&lt;/code&gt; 为 &lt;code class=&quot;highlighter-rouge&quot;&gt;window&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_002.jpg&quot; alt=&quot;blog_wxmini_3_002&quot; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;y&lt;/code&gt; 的实现最后调用了&lt;code class=&quot;highlighter-rouge&quot;&gt;g&lt;/code&gt;，&lt;code class=&quot;highlighter-rouge&quot;&gt;w&lt;/code&gt; 的实现最后调用了&lt;code class=&quot;highlighter-rouge&quot;&gt;_&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_003.jpg&quot; alt=&quot;blog_wxmini_3_003&quot; /&gt;&lt;/p&gt;

&lt;p&gt;继续查找&lt;code class=&quot;highlighter-rouge&quot;&gt;g&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;_&lt;/code&gt; 的实现，发现 &lt;code class=&quot;highlighter-rouge&quot;&gt;g&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;_&lt;/code&gt; 最后都调用了 &lt;code class=&quot;highlighter-rouge&quot;&gt;d&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;f&lt;/code&gt; 的方法（显现了关键字&lt;code class=&quot;highlighter-rouge&quot;&gt;invokeHandler&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;publishHandler&lt;/code&gt;）。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_004.jpg&quot; alt=&quot;blog_wxmini_3_004&quot; /&gt;&lt;/p&gt;

&lt;p&gt;继续查找，发现 &lt;code class=&quot;highlighter-rouge&quot;&gt;d&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;f&lt;/code&gt; 分别是来自 &lt;code class=&quot;highlighter-rouge&quot;&gt;window.webkit&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;window.WeixinJSCore&lt;/code&gt;。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_005.jpg&quot; alt=&quot;blog_wxmini_3_005&quot; /&gt;&lt;/p&gt;

&lt;p&gt;因为在一个小程序中可以打开多个视图层（webview），要保证发送的消息准确送到每个具体的 webview 中，需要通过每个 webview 唯一标识 &lt;code class=&quot;highlighter-rouge&quot;&gt;webviewId&lt;/code&gt; 来实现。发送消息时，携带 &lt;code class=&quot;highlighter-rouge&quot;&gt;webviewId&lt;/code&gt;，然后逻辑层处理完对应的逻辑，如果需要通知或者执行对应 webview 的代码，则可以通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;webviewId&lt;/code&gt; 找到对应的 webview，下发通知。&lt;/p&gt;

&lt;h2 id=&quot;三小程序生命周期&quot;&gt;三、小程序生命周期&lt;/h2&gt;

&lt;p&gt;小程序生命周期包括应用的生命周期（逻辑层 App Service）和页面的生命周期（视图层 View），两者支持的事件不同，详见官方文档中的这张配图。&lt;/p&gt;

&lt;p&gt;!&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_006.jpg&quot; alt=&quot;blog_wxmini_3_006&quot; /&gt;&lt;/p&gt;

&lt;p&gt;掌握了上面小程序实现原理的内容，再来看小程序的生命周期就很好理解了。&lt;/p&gt;

&lt;p&gt;小程序启动时，会同时启动两个线程，一个负责页面渲染的 WebView（实际不止一个，后面讲解），一个负责逻辑的 JavaScriptCore。逻辑层初始化后会将初始化数据（app.js 中的 global data）通过 JSBridge 传递给渲染层进行渲染，渲染层 WebView 页面渲染完之后又会跟逻辑层通信。&lt;/p&gt;

&lt;p&gt;理解了小程序架构和启动流程，小程序整个生命周期的流程只需要对着上面的流程图就可以很容易理解。&lt;/p&gt;

&lt;h2 id=&quot;四小程序为什么感觉快&quot;&gt;四、小程序为什么感觉快&lt;/h2&gt;

&lt;p&gt;小程序在体验上不仅仅页面流畅，而且点击之后，页面跳转也会比普通的 HTML5 要快很多，这是因为小程序的视图层做了预加载处理。下图是通过 X5 内核开启 inspect 版本之后，在 Chrome 中看到的手机 WebView 的页面情况。小程序选择今日头条，打开了两个页面（热点新闻列表和某条新闻详情），但实际在 Chrome 中看到的 WebView 页面总是比真实打开的页面要多一个，这个多出来的隐藏 WebView 就是提前初始化预热的，方便打开下一个小程序页面来使用，这样就节省了 WebView 初始化的时间，从而大幅提升了跳页效率。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_007.jpg&quot; alt=&quot;blog_wxmini_3_007&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;五小程序-wxml-是怎么转成-html-的&quot;&gt;五、小程序 WXML 是怎么转成 HTML 的&lt;/h2&gt;

&lt;p&gt;小程序的视图层最终是渲染在一个 webview 中的，通过下图就可以看到我们在 WXML 中写的 &lt;code class=&quot;highlighter-rouge&quot;&gt;view&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;icon&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;text&lt;/code&gt; 等标签最终会转换成 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx-*&lt;/code&gt; 等标签。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_008.jpg&quot; alt=&quot;blog_wxmini_3_008&quot; /&gt;&lt;/p&gt;

&lt;p&gt;那么 WXML 到 HTML 的过程发生了什么呢？&lt;/p&gt;

&lt;p&gt;首先，WXML 写完之后经过编译工具 &lt;code class=&quot;highlighter-rouge&quot;&gt;wcc&lt;/code&gt; 转成可执行的 JS，下面的命令可以将某个页面转为 JS：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wcc -d index.wxml -o index.js

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;TIPS：&lt;/strong&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;wcc&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;wcsc&lt;/code&gt; 是小程序的 WXML 和 WXSS 的编译工具，是二进制文件，在 macOS 中可以在&lt;code class=&quot;highlighter-rouge&quot;&gt;/Applications/wechatwebdevtools.app/Contents/Resources/package.nw/js/vendor/&lt;/code&gt; 路径中找到（应用 → 右键微信开发者工具 → 查看包文件）&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_009.jpg&quot; alt=&quot;blog_wxmini_3_009&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这个 JS 里面有个重要的函数是 &lt;code class=&quot;highlighter-rouge&quot;&gt;$gwx&lt;/code&gt;：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_010.jpg&quot; alt=&quot;blog_wxmini_3_010&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这个 JS 主要接收一个 &lt;code class=&quot;highlighter-rouge&quot;&gt;path&lt;/code&gt; 将 &lt;code class=&quot;highlighter-rouge&quot;&gt;path&lt;/code&gt; 的页面转换成一个 Virtual DOM：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_011.jpg&quot; alt=&quot;blog_wxmini_3_011&quot; /&gt;&lt;/p&gt;

&lt;p&gt;在这个 VDOM 结构里面就会找到以&lt;code class=&quot;highlighter-rouge&quot;&gt;wx-*&lt;/code&gt; 开头的 tag，有了这个 VDOM 结构，就可以使用对应的 tag 创建 HTML 片段了。&lt;/p&gt;

&lt;p&gt;整个流程梳理如下：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_3_012.jpg&quot; alt=&quot;blog_wxmini_3_012&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;六小结&quot;&gt;六、小结&lt;/h2&gt;

&lt;p&gt;本节重点介绍了小程序和普通的 HTML5 有什么区别，从小程序底层机制上来说明小程序是如何最终展现在 WebView 界面上的。本节涉及较多的源码和反编译技巧，对于初学者来说只需要了解微信小程序由逻辑层和视图层两个不同的线程进行交互而形成，而视图层是通过将 WXML 转换成 JS，最终由 JS 生成 HTML 片段放在 WebView 中显示的。&lt;/p&gt;
</description>
      </item>
    
      <item>
        <title>基础篇 2：小程序·云开发基础知识</title>
        <link>https://gorpeln.com//article/15611722666</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15611722666</guid>
        <pubDate>Sat, 22 Jun 2019 00:00:00 +0800</pubDate>
        <description>&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/wxcloud/basis/getting-started.html&quot;&gt;小程序·云开发&lt;/a&gt;&lt;/strong&gt; 是微信团队联合腾讯云团队推出的一套小程序开发解决方案。小程序·云开发为开发者提供完整的云端流程，弱化后端和运维概念，开发者无需购买和管理底层计算资源，包括服务器、数据库、静态存储，只需使用平台提供的简易 API 进行核心业务等开发，实现快速上线和迭代，把握业务发展的黄金时期。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;简单来说，小程序开发中用到的服务器、数据库和静态资源管理，都可以托管到「小程序·云开发」上，小程序开发者只需要关注业务功能实现，而不需要关心服务器运维等带来的问题。小程序开发主要用到的是前端技术，后端开发和服务运维对于前端开发者来说有一定的门槛，而小程序·云开发的出现就是解决这个问题的。&lt;/p&gt;

&lt;h2 id=&quot;一小程序云开发特点&quot;&gt;一、小程序·云开发特点&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;提供完整后端服务解决方案，包括数据库、静态资源管理和云函数（功能服务）&lt;/li&gt;
  &lt;li&gt;背靠腾讯云大平台，腾讯云丰富的 API 和功能都可以简单调用&lt;/li&gt;
  &lt;li&gt;对于普通开发者，&lt;strong&gt;完全免费&lt;/strong&gt;&lt;/li&gt;
  &lt;li&gt;对于高级服务型小程序，提供更强服务支持、计费弹性、不使用不计费的特点&lt;/li&gt;
  &lt;li&gt;无服务器搭建，无域名配置，直接调用 API 使用&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;对于我们普通开发者来说，小程序·云开发是个不错的练手平台。下面详细介绍下小程序·云开发提供的功能。&lt;/p&gt;

&lt;p&gt;小程序·云开发提供数据库、云函数和静态存储三大功能，还有小程序的用户管理功能，在用户管理界面可以轻松掌握小程序的授权用户情况。目前云开发的这些功能已经深度整合到「微信开发者工具」中，可以在顶部点击「云开发」进入。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_2_003.png&quot; alt=&quot;blog_wxmini_2_003&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;二申请小程序云开发&quot;&gt;二、申请小程序·云开发&lt;/h2&gt;

&lt;h3 id=&quot;1小程序云开发的开通&quot;&gt;1.小程序·云开发的开通&lt;/h3&gt;

&lt;p&gt;如果还没有开通小程序·云开发账号，首次点击「云开发」会出现下面的界面，该界面主要是云开发的介绍和申请入口。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_2_001.jpg&quot; alt=&quot;blog_wxmini_2_001&quot; /&gt;&lt;/p&gt;

&lt;p&gt;点击蓝色的「创建资源环境」按钮进入新建环境界面。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_2_002.jpg&quot; alt=&quot;blog_wxmini_2_002&quot; /&gt;&lt;/p&gt;

&lt;p&gt;第二步出现选择套餐信息，现在公测阶段只有一个免费套餐选项，将来应该会有更多套餐选择。填写上「环境名称」点击确认之后，会使用小程序开发账号在腾讯云开通一个 &lt;code class=&quot;highlighter-rouge&quot;&gt;fake account&lt;/code&gt;。到此小程序·云开发就开通了！&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;TIPS&lt;/strong&gt;：目前一个小程序账号可以免费开通两个云开发账号，免费版本的限制应该也要注意：&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;数据库存储空间：2GB&lt;/li&gt;
    &lt;li&gt;文件存储空间：5GB&lt;/li&gt;
    &lt;li&gt;文件存储外网下行流量：5GB/月&lt;/li&gt;
    &lt;li&gt;云函数数量：20&lt;/li&gt;
    &lt;li&gt;云函数资源使用量：10万GBs/月&lt;/li&gt;
    &lt;li&gt;API调用次数：3万次/天&lt;/li&gt;
  &lt;/ul&gt;

  &lt;p&gt;&lt;strong&gt;这些对于我们做普通的小程序开发练习已经足够了！&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;2小程序云开发在小程序中的调用&quot;&gt;2.小程序·云开发在小程序中的调用&lt;/h3&gt;

&lt;p&gt;小程序·云开发可以在小程序中直接通过调用 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx.cloud.*&lt;/code&gt; 的方式进行调用，在调用云开发 API 之前，需要先调用 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx.cloud.init&lt;/code&gt; 对云开发进行初始化：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wx.cloud.init({
  env: 'tianqi-xxx'
})

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;初始化时，需要传入 &lt;code class=&quot;highlighter-rouge&quot;&gt;env&lt;/code&gt; 参数，该参数为创建小程序·云开发时的&lt;code class=&quot;highlighter-rouge&quot;&gt;环境 ID&lt;/code&gt;，可以在「云开发」页面右上角「当前环境」下拉菜单中找到：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_2_004.jpg&quot; alt=&quot;blog_wxmini_2_004&quot; /&gt;&lt;/p&gt;

&lt;p&gt;下面详细介绍下小程序·云开发的三大功能。&lt;/p&gt;

&lt;h2 id=&quot;三数据库&quot;&gt;三、数据库&lt;/h2&gt;

&lt;p&gt;小程序·云开发的数据库是一种 NoSQL 云端数据库，数据以 JSON 格式存储，在底层支持弹性可扩展、自动容灾、监控管理，所以开发者不需要关注数据库的运维。从提供的文档和接口来看，云开发的数据库应该是由 MongoDB 实现的。&lt;/p&gt;

&lt;p&gt;每个数据库是由多个集合（collection，类比关系型数据库中表的概念）组成，集合有多个 JSON 文档（行）组成，NoSQL 的特点是没有固定的字段，所以整个集合可以看成一个大的 JSON 数组，一个集合在数据库中的存储格式如下：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;[
  {
    &quot;_id&quot;: 1,
    &quot;_openid&quot;: &quot;ax123CVadb&quot;,
    &quot;name&quot;: &quot;Alice&quot;,
    &quot;city&quot;: &quot;Guangzhou&quot;
  },
  {
    &quot;_id&quot;: 2,
    &quot;_openid&quot;: &quot;xj372nJdfa&quot;,
    &quot;name&quot;: &quot;Bob&quot;,
    &quot;city&quot;: &quot;Shenzhen&quot;
  }
]

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;需要说明的是，文档中的 &lt;code class=&quot;highlighter-rouge&quot;&gt;_id&lt;/code&gt; 是唯一的，开发者可以插入数据的时候自定义，另外 &lt;code class=&quot;highlighter-rouge&quot;&gt;_openid&lt;/code&gt; 是增加文档默认创建的，代表当前小程序用户的唯一标示，后面实战部分笔者会重点介绍小程序的用户授权相关的内容。&lt;/p&gt;

&lt;h3 id=&quot;1快速入门&quot;&gt;1.快速入门&lt;/h3&gt;

&lt;p&gt;详细介绍可以见小程序·云开发的使用文档，这里笔者整理出常用的 API 使用方法：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 初始化
wx.cloud.init({
  env: 'tianqi-xxx'
})
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 获取数据库实例
const db = wx.cloud.database()
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 增
db.collection('集合名称').add({
  data: {} // 插入的数据
}).then(res =&amp;gt; {
  // 可以通过 res._id 获取创建的记录的 id
  console.log(res._id)
})
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 删
db.collection('集合名称').doc('文档 ID').remove().then(res =&amp;gt; {
  console.log('removed')
})
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 改
db.collection('集合名称').doc('文档 ID').update({
  data: {
    title: '我的第 1 篇文章', // 只更新 title 字段，其他不更新
  }
}).then(res =&amp;gt; {
  // 可以通过 res._id 获取创建的记录的 id
  console.log(res._id)
})
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 查
db.collection('集合名称').doc('文档 ID').get().then(res =&amp;gt; {
  // 打印结果，res.data 即为记录的数据
  console.log(res)
})
const _ = db.command // 取指令
db.collection('集合名称').where({
  // 查找条件
  category: 'computer',
  properties: {
    memory: _.gt(8), // 表示大于 8
  }
})
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;小程序·云开发的数据库查询命令是可以使用查询筛选指令的，使用查询筛选指令可以缩小查询范围，找到查询条件的文档。&lt;/p&gt;

&lt;p&gt;以下指令挂载在 &lt;code class=&quot;highlighter-rouge&quot;&gt;db.command&lt;/code&gt; 下&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;类型&lt;/th&gt;
      &lt;th&gt;接口&lt;/th&gt;
      &lt;th&gt;说明&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;比较运算&lt;/td&gt;
      &lt;td&gt;eq&lt;/td&gt;
      &lt;td&gt;字段 ==&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt;neq&lt;/td&gt;
      &lt;td&gt;字段 !=&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt;gt&lt;/td&gt;
      &lt;td&gt;字段 &amp;gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt;gte&lt;/td&gt;
      &lt;td&gt;字段 &amp;gt;=&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt;lt&lt;/td&gt;
      &lt;td&gt;字段 &amp;lt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt;lte&lt;/td&gt;
      &lt;td&gt;字段 &amp;lt;=&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt;in&lt;/td&gt;
      &lt;td&gt;字段值在数组里&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt;nin&lt;/td&gt;
      &lt;td&gt;字段值不在数组里&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;逻辑运算&lt;/td&gt;
      &lt;td&gt;and&lt;/td&gt;
      &lt;td&gt;表示需同时满足指定的所有条件&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt;or&lt;/td&gt;
      &lt;td&gt;表示需同时满足指定条件中的至少一个&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;blockquote&gt;
  &lt;p&gt;举例说明：在 &lt;code class=&quot;highlighter-rouge&quot;&gt;diary&lt;/code&gt; 集合中找出 &lt;code class=&quot;highlighter-rouge&quot;&gt;openid&lt;/code&gt; 某个值并且创建时间（&lt;code class=&quot;highlighter-rouge&quot;&gt;tsModified&lt;/code&gt;）在 &lt;code class=&quot;highlighter-rouge&quot;&gt;start&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;end&lt;/code&gt; 之间的文档。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;db
  .collection('diary')
  .where({
    openid,
    tsModified: _.gte(start).and(_.lt(end))
  })
  .get()

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;2数据库的索引&quot;&gt;2.数据库的索引&lt;/h3&gt;

&lt;p&gt;增加合适的索引可以提升文档的查找效率，比如根据时间、用户 ID 查找，可以将时间和用户 ID 字段设置为索引项，笔者在使用的时候发现：&lt;strong&gt;在小程序·云开发管理后台并不能对某个字段增加唯一索引。&lt;/strong&gt;&lt;/p&gt;

&lt;h3 id=&quot;3自带权限管理&quot;&gt;3.自带权限管理&lt;/h3&gt;

&lt;p&gt;在研发中，经常会针对不同的用户设置不同的数据库权限，例如：某条记录是用户 A 创建的，则只有用户 A 可以删除或者更新，其他用户只有查看的权限，这样的需求很常见，实际开发起来却非常费劲，往往要写不少权限判断的代码，小程序·云开发的数据库支持「权限管理」功能，可以针对这类需求对不同的集合进行统一处理，大大降低开发的门槛！&lt;/p&gt;

&lt;p&gt;集合的操作权限包括以下四种：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;所有用户可读，仅创建者及管理员可写&lt;/li&gt;
  &lt;li&gt;仅创建者及管理员可读写&lt;/li&gt;
  &lt;li&gt;所有用户可读，仅管理员可写&lt;/li&gt;
  &lt;li&gt;仅管理员可读写&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;可以在「云开发 -&amp;gt; 数据库 -&amp;gt; 选择某个集合 -&amp;gt; 权限设置」页面进行设置。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_2_005.jpg&quot; alt=&quot;blog_wxmini_2_005&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;四文件存储&quot;&gt;四、文件存储&lt;/h2&gt;

&lt;p&gt;小程序·云开发的文件存储功能是专为存储和提供用户生成的内容（如图片或视频）的开发者打造的。开发者可使用腾讯云的 SDK 来存储图片、音频、视频或其他由用户生成的内容。在小程序内，则可以通过云开发的 API 直接上传、下载和管理存储。&lt;/p&gt;

&lt;p&gt;公共使用的静态资源，可以通过「云开发 -&amp;gt; 存储」界面直接上传和管理，上传之后，就可以在界面内找到资源的 CDN 地址。&lt;/p&gt;

&lt;p&gt;而对于小程序内需要上传和管理的则通过下面几个 API 来实现：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 上传，上传后会返回资源的 ID
wx.cloud.uploadFile
// 下载
wx.cloud.downloadFile
// 根据资源 ID 获取资源访问地址
wx.cloud.getTempFileURL
// 根据资源 ID 列表删除某资源
wx.cloud.removeFile

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;跟数据库权限管理一样，如果需要用户自己上传的内容自己可以管理，那么需要设置存储的操作权限，在「云开发 -&amp;gt; 存储」下可以设置全局的存储操作权限。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_2_006.jpg&quot; alt=&quot;blog_wxmini_2_006&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;五云函数&quot;&gt;五、云函数&lt;/h2&gt;

&lt;p&gt;云函数是腾讯云提供的一套函数计算解决方案，我们可以将每个功能 API 做成单个可执行的函数，然后放到腾讯云上去托管，每个云函数是相互独立可执行的。代码编写完成后放到云端，不执行不调用不收费，执行调用按照调用次数和 CPU 等计算资源的占用情况收费。有了云函数，开发者无须搭建和购买服务器，只需要将写好的云函数代码上传部署到腾讯云，即可以在小程序内通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx.cloud.callFunction&lt;/code&gt; 的方法进行调用。&lt;/p&gt;

&lt;h3 id=&quot;1创建云函数&quot;&gt;1.创建云函数&lt;/h3&gt;

&lt;p&gt;创建云函数有两种方式，一种是直接在小程序开发者工具中进行操作：&lt;/p&gt;

&lt;p&gt;进入「云开发 -&amp;gt; 云函数 -&amp;gt; 添加」创建：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_2_008.jpg&quot; alt=&quot;blog_wxmini_2_008&quot; /&gt;&lt;/p&gt;

&lt;p&gt;另外一种是直接在小程序开发者工具中上传，在上传之前需要配置小程序的 &lt;code class=&quot;highlighter-rouge&quot;&gt;project.config.json&lt;/code&gt;，指明哪个路径为云函数目录：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;{
  &quot;cloudfunctionRoot&quot;: &quot;./cloud-functions/&quot;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;配置完成后，在小程序开发者工具的编辑器中展开 &lt;code class=&quot;highlighter-rouge&quot;&gt;cloud-functions&lt;/code&gt; 文件夹，选择对应的云函数文件夹，右键选择「上传并部署」即可：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_2_007.png&quot; alt=&quot;blog_wxmini_2_007&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;2写个简单云函数&quot;&gt;2.写个简单云函数&lt;/h3&gt;

&lt;p&gt;小程序·云开发的云函数是执行在 Node.js 8.9.0 版本下的，云函数必须在 index.js 有 &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt; 方法为入口，例如下面的代码：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 命名为 test 的函数内容 index.js
exports.main = async (event, context) =&amp;gt; {
  let {a, b} = event
  return new Promise((resolve, reject) =&amp;gt; {
    resolve({result: parseInt(a) + parseInt(b)})
  })
}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;除了上面 Promise 的写法，还可以用回调的方式：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 命名为 test 的函数内容 index.js
// 回调方式 callback
exports.main = async (event, context, callback) =&amp;gt; {
  let {a, b} = event
  callback(null, {result: parseInt(a) + parseInt(b)})
}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;TIPS:&lt;/p&gt;

  &lt;ol&gt;
    &lt;li&gt;云函数如果不存在 &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt; 的方法，上传部署的时候会报错！&lt;/li&gt;
    &lt;li&gt;云函数回调方式写法遵循「错误优先」原则（Error-First Callback）。&lt;/li&gt;
  &lt;/ol&gt;
&lt;/blockquote&gt;

&lt;p&gt;云函数接受两个 JSON 格式的参数 &lt;code class=&quot;highlighter-rouge&quot;&gt;event&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;context&lt;/code&gt;，两者分别代表：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;event&lt;/code&gt;：平台将 &lt;code class=&quot;highlighter-rouge&quot;&gt;event&lt;/code&gt; 入参传递给执行方法，通过此 &lt;code class=&quot;highlighter-rouge&quot;&gt;event&lt;/code&gt; 入参对象，代码将与触发函数的事件（event）交互，&lt;code class=&quot;highlighter-rouge&quot;&gt;event&lt;/code&gt; 可以获取 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx.cloud.callFunction&lt;/code&gt; 调用的参数 &lt;code class=&quot;highlighter-rouge&quot;&gt;data&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;context&lt;/code&gt;：平台将 &lt;code class=&quot;highlighter-rouge&quot;&gt;context&lt;/code&gt; 入参传递给执行方法，通过此 &lt;code class=&quot;highlighter-rouge&quot;&gt;context&lt;/code&gt; 入参对象，代码将能了解到运行环境及当前请求的相关内容&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;TIPS： 开发者可以在云函数内获取到每次调用的上下文（appId、openId 等），无需维护复杂的鉴权机制，即可获取天然可信任的用户登录态（openId），这俩值可以从&lt;code class=&quot;highlighter-rouge&quot;&gt;event.userInfo&lt;/code&gt;中读取。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;上面 &lt;code class=&quot;highlighter-rouge&quot;&gt;test&lt;/code&gt; 的函数上传到腾讯云之后，我们在小程序的 JS 代码中可以使用下面的方法进行调用：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wx.cloud.callFunction({
  name: 'test',
  data: {
    a: 1,
    b: 2
  }
}).then(r=&amp;gt;{
  // 因为 main 的方法实际是个 promisify 的返回，所以可以直接使用 then/catch
  console.log(r)
}).catch(e=&amp;gt;{
  console.log(e)
})

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;3云函数的依赖管理&quot;&gt;3.云函数的依赖管理&lt;/h3&gt;

&lt;p&gt;在云函数中，可以像正常的 Node.js 一样，使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;package.json&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;node_modules&lt;/code&gt; 来对依赖进行管理，在开发完代码之后，需要将 &lt;code class=&quot;highlighter-rouge&quot;&gt;node_modules&lt;/code&gt; 文件夹一起上传到云端去。下面笔者将带着大家做一个什么值得买的简单抓取的云函数，讲解函数编写、npm 模块使用、云函数本地测试整个流程。&lt;/p&gt;

&lt;p&gt;先说下，笔者要实现的功能：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;根据传入的分类参数，获取什么值得买对应分类的最新文章内容&lt;/li&gt;
  &lt;li&gt;提取出文章列表的 title、image、mall，即文章名称、文章的配图和优惠所属的网站&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;首先在 cloud-functions 文件夹（该文件夹是我们创建的云函数文件夹），创建一个 &lt;code class=&quot;highlighter-rouge&quot;&gt;smzdm&lt;/code&gt; 的云函数，目录结构如下：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cloud-functions
├── smzdm
│   ├── index.js

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后进入 &lt;code class=&quot;highlighter-rouge&quot;&gt;smzdm&lt;/code&gt; 目录，执行 &lt;code class=&quot;highlighter-rouge&quot;&gt;npm init&lt;/code&gt;，按照提示填写内容以后，会在该目录下生成 &lt;code class=&quot;highlighter-rouge&quot;&gt;package.json&lt;/code&gt; 文件，接下来需要安装抓取「什么值得买」手机站点的两个 npm 模块：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.npmjs.com/package/request&quot;&gt;request&lt;/a&gt;：用于做数据请求，抓取站点的 HTML 内容&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.npmjs.com/package/cheerio&quot;&gt;cheerio&lt;/a&gt;：用于将 HTML 结构数据转为类似 jQuery 的对象，可以通过 CSS 选择器对 HTML 的内容进行提取&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;安装命令如下：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 进入 smzdm 目录，执行
npm install --save request cheerio

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;安装之后的目录结构如下：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;cloud-functions
├── smzdm
│   ├── node_modules
│   ├── index.js
│   └── package.json

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后我们开始编写 index.js 内容，第一步引入模块，编写 &lt;code class=&quot;highlighter-rouge&quot;&gt;main&lt;/code&gt; 方法：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// 引入 requst 和 cheerio
const request = require('request')
const cheerio = require('cheerio')
exports.main = async (event = {}) =&amp;gt; {
  // 获取具体什么值得买网站分类
  let category = event.category || 'diannaoshuma'
  return new Promise((resolve, reject) =&amp;gt; {

  })
}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;第二步，开始编写具体的逻辑，即使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;request.get&lt;/code&gt; 先获取 HTML 内容，然后使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;cheerio&lt;/code&gt; 将 HTML 内容进行结构化，经过使用 Chrome 查看器查看，发现最新文章都包含在一个 &lt;code class=&quot;highlighter-rouge&quot;&gt;class&lt;/code&gt; 为 &lt;code class=&quot;highlighter-rouge&quot;&gt;card-group-list&lt;/code&gt; 的 div 下，然后找到 &lt;code class=&quot;highlighter-rouge&quot;&gt;zm-card-title&lt;/code&gt; 等每个文章的标题、图片和商城信息，将结果放到一个数组，最后 &lt;code class=&quot;highlighter-rouge&quot;&gt;resolve&lt;/code&gt; 输出：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const request = require('request')
const cheerio = require('cheerio')
exports.main = async (event = {}) =&amp;gt; {
  let category = event.category || 'diannaoshuma'
  return new Promise((resolve, reject) =&amp;gt; {
    request.get(`https://m.smzdm.com/fenlei/${category}/`, (e, req, body) =&amp;gt; {
      if (!e &amp;amp;&amp;amp; req.statusCode === 200) {
        const $ = cheerio.load(body)
        const result = []
        $('.card-group-list').each((i, v) =&amp;gt; {
          let $v = $(v)
          let title = $v.find('.zm-card-title').text().trim()
          let image = $v.find('.zm-card-media img').attr('src')
          let mall = $v.find('.card-mall').text().trim()
          result.push({
            title,
            image,
            mall
          })
        })
        resolve(result)
      }
    })
  })
}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这样就完成了一个带有依赖模块的云函数编写，上传到腾讯云部署之后，在小程序中使用：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;wx.cloud.callFunction({
  name: 'smzdm',
  data: {
    category: 'diannaoshuma'
  }
}).then(r=&amp;gt;{console.log(r)})

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;4云函数的调试&quot;&gt;4.云函数的调试&lt;/h3&gt;

&lt;p&gt;云函数有一个很不方便的地方，就是测试起来相对来说比较麻烦，我们不能每次都上传到云端，通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx.cloud.callFunction&lt;/code&gt; 的方式进行调用，下面介绍几种测试的方法。&lt;/p&gt;

&lt;h4 id=&quot;1线下函数自己使用-node-来测试&quot;&gt;(1)线下：函数自己使用 Node 来测试&lt;/h4&gt;

&lt;p&gt;这种方法就是在 index.js 的最后，增加一个测试方法，比如：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const request = require('request')
const cheerio = require('cheerio')
const main = (exports.main = async (event = {}) =&amp;gt; {
  let category = event.category || 'diannaoshuma'
  return new Promise((resolve, reject) =&amp;gt; {
    request.get(`https://m.smzdm.com/fenlei/${category}/`, (e, req, body) =&amp;gt; {
      if (!e &amp;amp;&amp;amp; req.statusCode === 200) {
        const $ = cheerio.load(body)
        const result = []
        $('.card-group-list').each((i, v) =&amp;gt; {
          let $v = $(v)
          let title = $v.find('.zm-card-title').text().trim()
          let image = $v.find('.zm-card-media img').attr('src')
          let label = $v.find('.card-label').text().trim()
          let mall = $v.find('.card-mall').text().trim()
          result.push({
            title,
            image,
            label,
            mall
          })
        })
        resolve(result)
      }
    })
  })
})
main({category: 'diannaoshuma'}).then(r=&amp;gt;{console.log(r)})

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;然后使用 Node.js 直接运行该文件：&lt;code class=&quot;highlighter-rouge&quot;&gt;node index.js&lt;/code&gt;&lt;/p&gt;

&lt;h4 id=&quot;2线上使用开发者工具&quot;&gt;(2)线上：使用开发者工具&lt;/h4&gt;

&lt;p&gt;在小程序开发者工具的云开发控制台内有测试的工具，进入路径为：「云开发 -&amp;gt; 云函数列表 -&amp;gt; 点击具体云函数 -&amp;gt; 右上角测试」。&lt;/p&gt;

&lt;p&gt;对于测试的参数，还可以保存下来模板，方便以后使用。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-24-blog_wxmini_2_009.jpg&quot; alt=&quot;blog_wxmini_2_009&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;5云函数的-mock-server&quot;&gt;5.云函数的 mock server&lt;/h3&gt;

&lt;p&gt;上文提到的测试方法，都是将小程序的研发流程完全割裂开来，不能完整地测试小程序的代码，只能要么测试云函数要么测试小程序，那么测试小程序的代码就需要上线云函数，实际还是一种效率不高的做法。这里笔者介绍一种本地 mock server 的方式来开启云函数的测试，这种方式可以打通小程序开发的整个流程。具体做法分两步：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;将云函数作为一个接受请求参数的 server 来访问&lt;/li&gt;
  &lt;li&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx.request&lt;/code&gt; 构造请求拿到云函数的处理结果，然后跑通整个研发流程&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;笔者在 mock server 选型上，选择使用 &lt;a href=&quot;https://www.expressjs.com/&quot;&gt;Express&lt;/a&gt; 自建 mock server 的方式。&lt;/p&gt;

&lt;p&gt;首先，启动一个 Express server：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const express = require('express')
const app = express()

app.listen(3000, () =&amp;gt; {
  console.log(`开发服务器启动成功：http://127.0.0.1:3000`)
})

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;nodemon index.js&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;然后将云函数引入进程序中来，作为一个路由 handler 来接受http url 的参数，处理请求之后，将返回的处理结果通过 Express 的 &lt;code class=&quot;highlighter-rouge&quot;&gt;res.json&lt;/code&gt;输出。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const test = require('./cloud-functions/test/').main

app.get('/api/test', (req, res, next) =&amp;gt; {
  // 将 req.query 传入
  test(req.query).then(res.json.bind(res)).catch((e) =&amp;gt; {
    console.error(e)
    next(e)
  })
  // next()
})

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;这样访问 &lt;code class=&quot;highlighter-rouge&quot;&gt;http://127.0.0.1:3000/api/test?a=1&amp;amp;b=2&lt;/code&gt; 就会输出结果了。到这里笔者就将 mock server 搭建完毕了。&lt;/p&gt;

&lt;h2 id=&quot;六小结&quot;&gt;六、小结&lt;/h2&gt;

&lt;p&gt;本节重点介绍了腾讯新推出的小程序云开发的基础知识，云开发由 NoSQL 数据库、文件存储和云函数三个云产品组成，其中数据库和文件存储都可以单独设置用户权限，这样极大地降低了 UGC（用户产生内容）类小程序的开发门槛。&lt;/p&gt;

&lt;p&gt;云函数是小程序·云开发中一个很重要的产品，本节介绍了云函数的基本用法和注意事项，同时针对小程序云函数的开发测试比较困难的情况，提出了 mock server 的解决方式。&lt;/p&gt;

</description>
      </item>
    
      <item>
        <title>基础篇 1：小程序开发基础知识</title>
        <link>https://gorpeln.com//article/15605697133</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15605697133</guid>
        <pubDate>Sat, 15 Jun 2019 00:00:00 +0800</pubDate>
        <description>&lt;h2 id=&quot;一准备工作&quot;&gt;一、准备工作&lt;/h2&gt;

&lt;p&gt;小程序开发要先注册小程序账号，有了小程序账号才可以使用开发者工具。小程序是一种特殊的开发形式，里面的 API 和组件都是自己定制的，因此在普通的浏览器中不能预览，要预览功能和页面就需要使用开发者工具。&lt;/p&gt;

&lt;h3 id=&quot;1注册小程序账号&quot;&gt;1.注册小程序账号&lt;/h3&gt;

&lt;p&gt;先准备一个没有注册过公众号的邮箱，然后访问&lt;a href=&quot;https://mp.weixin.qq.com/cgi-bin/wx?token=&amp;amp;lang=zh_CN&quot;&gt;小程序介绍页面&lt;/a&gt;并点击底部的「前往注册」按钮，再按照提示填写个人信息，最后进入邮箱激活账号即可。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-17-blog_wxmini_001.png&quot; alt=&quot;blog_wxmini_001&quot; /&gt;&lt;/p&gt;

&lt;h3 id=&quot;2安装开发者工具&quot;&gt;2.安装开发者工具&lt;/h3&gt;

&lt;p&gt;小程序有自己的开发者工具，可以编写代码，实时查看页面和功能效果，还能在开发者工具中进行 debug。小程序开发者工具是使用 NW.js 编写的。&lt;/p&gt;

&lt;p&gt;开发者工具下载地址：&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html&quot;&gt;微信开发者工具&lt;/a&gt;&lt;/p&gt;

&lt;h3 id=&quot;3使用开发者工具演示-weui&quot;&gt;3.使用开发者工具演示 WeUI&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;WeUI 是一套同微信原生视觉体验一致的基础样式库，由微信官方设计团队为微信内网页和微信小程序量身设计，令用户的使用感知更加统一。包含 button、cell、dialog、 progress、 toast、article、actionsheet、icon 等各式组件。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;WeUI 有两个版本，一个是&lt;a href=&quot;https://github.com/Tencent/weui&quot;&gt;普通的 HTML5 版本&lt;/a&gt;，另外是&lt;a href=&quot;https://github.com/Tencent/weui-wxss&quot;&gt;小程序版本&lt;/a&gt;。本节我们通过 WeUI 来简单学习开发者工具的使用。&lt;/p&gt;

&lt;p&gt;首先下载 WeUI 源码：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# https 方式（推荐）
git clone https://github.com/Tencent/weui-wxss.git
# 或者 ssh 方式
git clone git@github.com:Tencent/weui-wxss.git

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;打开开发者工具，使用注册时绑定的微信账号扫码登录，这时在进入的界面中选择「小程序项目」，如果是初次使用小程序开发者工具，没有创建过小程序项目，就会进入下面的页面：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-17-blog_wxmini_002.jpg&quot; alt=&quot;blog_wxmini_002&quot; /&gt;&lt;/p&gt;

&lt;p&gt;在这个页面，先选择我们 clone 下来的 WeUI 项目的 dist 文件夹。对于 AppID 选项，如果已经有了小程序账号，可以在账号后台找到 AppID 并填写上；若还没有注册小程序账号，可以直接在「或使用测试号：」后面单击「小程序」，就会自动填好。然后给项目起个名字，比如「WeUI 演示」，点击确定后就打开了 WeUI 项目。这时候看到的是开发者工具的开发界面，如下图所示，开发界面主要由三部分组成：模拟器、编辑器和调试器。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-17-blog_wxmini_003.png&quot; alt=&quot;blog_wxmini_003&quot; /&gt;&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;模拟器：提供小程序的运行环境，模拟小程序在手机上的界面效果&lt;/li&gt;
  &lt;li&gt;编辑器：简单 IDE 功能，点击左侧树形菜单可以打开多个文件直接编写保存，做到实时预览效果，但是开发者工具的编辑器做得比较简单，而且使用体验并不好，建议选择自己顺手的 IDE 增加 WXML 和 WXSS 的语法高亮插件等来编辑代码&lt;/li&gt;
  &lt;li&gt;调试器：订制版的 Chrome 开发者工具，提供从页面结构到网络请求等多个面板支持，会用 Chrome DevTools 就很容易上手该工具&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;Tips：&lt;/strong&gt; 常用 IDE 推荐&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;VS Code + &lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=qiu8310.minapp-vscode&quot;&gt;minapp 插件&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;Sublime Text 3 + &lt;a href=&quot;https://github.com/springlong/Sublime-wxapp/blob/master/docs/README.zh-ch.md&quot;&gt;Sublime wxapp 插件&lt;/a&gt;&lt;/li&gt;
    &lt;li&gt;Vim + &lt;a href=&quot;https://github.com/chemzqm/wxapp.vim&quot;&gt;wxapp&lt;/a&gt;&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;除了三个重要组成部分之外，在开发者工具的顶部还有各种操作按钮。左侧主要是模拟器、编辑器、调试器和小程序云开发控制台的视图开关，可以控制对应视图的开启关闭。&lt;/p&gt;

&lt;p&gt;中间部分是跟开发、编译、测试和上线相关的各种按钮，我们在开发和测试小程序中会经常使用，最常用的有：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;预览、远程调试：是可以在手机上直接预览效果，开启远程 debug 功能的&lt;/li&gt;
  &lt;li&gt;清缓存：对于一些授权登录、缓存、数据之类的操作，我们需要清理状态和数据，可以通过这个按钮操作&lt;/li&gt;
  &lt;li&gt;上传：如果是创建项目的时候填写了 AppID，那么会出现这个按钮，小程序开发完毕后可以通过这个来上传，上传之后可以在小程序后台申请测试版和审核，审核通过后就可以正式上线了&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;最后介绍的是开发者工具右上角的「详情」。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-17-blog_wxmini_004.jpeg&quot; alt=&quot;blog_wxmini_004&quot; /&gt;&lt;/p&gt;

&lt;p&gt;详情下面主要有三个 Tab：项目设置、域名信息和腾讯云状态。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;项目设置：这个是用得比较多的，可以指定上传代码时候的编译情况，比如支持 ES6 语法、支持 css autoprefixer、代码压缩等&lt;/li&gt;
  &lt;li&gt;域名信息：小程序的&lt;code class=&quot;highlighter-rouge&quot;&gt;request&lt;/code&gt;等访问的域名采用了白名单形式，在这里可以看到小程序管理后台设置的域名白名单&lt;/li&gt;
  &lt;li&gt;腾讯云状态：可以看到小程序账号和腾讯云的绑定情况&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;二小程序开发语言&quot;&gt;二、小程序开发语言&lt;/h2&gt;

&lt;p&gt;小程序的开发语言跟前端开发者比较熟悉的 HTML5 非常相似（甚至相同），小程序的视图层由 &lt;code class=&quot;highlighter-rouge&quot;&gt;WXML&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;WXSS&lt;/code&gt; 组成，分别对应 HTML 和 CSS，逻辑层则跟 HTML5 一样，也是 JavaScript 语言实现。&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;WXML：小程序自己发明的 XML 语法描述，用来构造小程序的页面结构&lt;/li&gt;
  &lt;li&gt;WXSS：小程序的页面的样式表语言，描述 WXML 的样式&lt;/li&gt;
  &lt;li&gt;JavaScript：小程序 JS 的执行环境并不是普通的 WebView 浏览器，也不是 Node.js 环境，它执行在微信 App 内上下文， 跟 Node.js 一样，也不能像在浏览器内一样对页面 DOM 进行操作&lt;/li&gt;
&lt;/ul&gt;

&lt;blockquote&gt;
  &lt;p&gt;微信小程序运行在三端：iOS、Android 和用于调试的开发者工具&lt;/p&gt;

  &lt;ul&gt;
    &lt;li&gt;在 iOS 上，小程序的 JavaScript 代码运行在 JavaScriptCore 中&lt;/li&gt;
    &lt;li&gt;在 Android 上，小程序的 JavaScript 代码通过 X5 内核来解析&lt;/li&gt;
    &lt;li&gt;在 开发工具上， 小程序的 JavaScript 代码运行在 NW.js（Chromium 内核） 中&lt;/li&gt;
  &lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;除了普通的 JavaScript，小程序还支持一种类似 JS 的 &lt;strong&gt;WXS&lt;/strong&gt; 语言，WXS 对于小程序开发不是必需的，它的主要目的是为了增强 WXML 的数据处理能力而新引入一种技术实现，其实际解析的语言规范还是 JS，并没有引入新的语法，仅仅对 JS 做了上层的封装和限制，所以学习上基本没什么成本，大致了解下开发文档马上就能上手。本小册实战部分也会涉及简单的 WXS 编写。&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;对于 WXS 和 JavaScript 的性能比较，官方给出的数据是：&lt;strong&gt;由于运行环境的差异，在 iOS 设备上小程序内的 WXS 会比 JavaScript 代码快 2 ~ 20 倍。在 Android 设备上二者运行效率无差异。&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h2 id=&quot;三小程序项目相关知识&quot;&gt;三、小程序项目相关知识&lt;/h2&gt;

&lt;h3 id=&quot;1小程序目录结构&quot;&gt;1.小程序目录结构&lt;/h3&gt;

&lt;p&gt;小程序项目由配置文件、页面文件、静态资源和其他相关（比如组件、小程序云函数等）内容组成，一般小程序会由四类文件组成：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.json&lt;/code&gt; 后缀的 JSON 配置文件&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.wxml&lt;/code&gt; 后缀的 WXML 模板文件&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.wxss&lt;/code&gt; 后缀的 WXSS 样式文件&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;.js&lt;/code&gt; 后缀的 JS 脚本逻辑文件&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;小程序项目的目录结构组成没有严格的要求，按照前端项目的经验，一般会分为：配置、页面、静态资源、基础库、组件等多个目录，例如下面的目录结构：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;├── app.js            小程序全局app相关js
├── app.json          小程序配置文件
├── app.wxss          小程序全局app样式
├── cloud-functions   云函数目录
│   ├── decrypt
│   ├── geocoder
│   ├── he-air
│   ├── he-weather
│   ├── jscode2session
│   └── weather
├── components        组件库
│   └── icon
├── images            图片等静态资源
│   └── cloud.jpg
├── pages             页面目录
│   ├── diary
│   └── weather
└── project.config.json  工具项目配置文件

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;当然根据不同的项目，可能目录结构不同，但是小程序必需的 &lt;code class=&quot;highlighter-rouge&quot;&gt;app.json&lt;/code&gt; 和页面组成是必不可少的。另外，在开发复杂的项目时，我们会用到开发框架或者编译工具，这时候目录结构只需要保证编译之后的目录结构符合规范即可。&lt;/p&gt;

&lt;h3 id=&quot;2小程序的配置&quot;&gt;2.小程序的配置&lt;/h3&gt;

&lt;p&gt;小程序有三个重要的配置，分别放在三个 JSON 文件内：&lt;code class=&quot;highlighter-rouge&quot;&gt;project.config.json&lt;/code&gt;（工具项目配置）、&lt;code class=&quot;highlighter-rouge&quot;&gt;app.json&lt;/code&gt;（小程序配置）、&lt;code class=&quot;highlighter-rouge&quot;&gt;page.json&lt;/code&gt;（单页面配置）&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;project.config.json&lt;/code&gt;：这个是配置项目工具相关的，比如开发者工具的编译设置（是否使用 ES6 语法等）、界面设置，以及云函数相关的 &lt;code class=&quot;highlighter-rouge&quot;&gt;cloudfunctionRoot&lt;/code&gt;，详细可以参考&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/devtools/projectconfig.html&quot;&gt;项目配置文件&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;app.json&lt;/code&gt;：小程序的全局配置，包括了所有页面路径、界面表现、网络超时时间、底部 tab、插件等，常用的两个配置是 &lt;code class=&quot;highlighter-rouge&quot;&gt;window&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;pages&lt;/code&gt;，详细配置参考&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/framework/config.html&quot;&gt;全局配置&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;page.json&lt;/code&gt;：是相对于 &lt;code class=&quot;highlighter-rouge&quot;&gt;app.json&lt;/code&gt; 更细粒度的单页面配置，详细参考&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/framework/config.html#%E9%A1%B5%E9%9D%A2%E9%85%8D%E7%BD%AE&quot;&gt;页面配置&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;四组件和插件&quot;&gt;四、组件和插件&lt;/h2&gt;

&lt;p&gt;小程序页面是由各种组件组成的，组件可以类比成原生 HTML5 的标签。&lt;/p&gt;

&lt;h3 id=&quot;1组件&quot;&gt;1.组件&lt;/h3&gt;

&lt;p&gt;小程序内部定义了很多组件，可以对应 HTML5 的标签和基础能力来理解，小程序的组件根据实现不同，可以分为 Web 组件和 Native 组件，Web 组件是由 HTML5 原生 Web 组件封装的组件，比如 &lt;code class=&quot;highlighter-rouge&quot;&gt;view&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;image&lt;/code&gt; 等；Native 组件是为了增强小程序的体验，用客户端技术实现的组件，包括一些交互复杂、原生 Web 组件性能不高的组件，例如 &lt;code class=&quot;highlighter-rouge&quot;&gt;input&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;map&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;canvas&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;video&lt;/code&gt; 等。&lt;/p&gt;

&lt;p&gt;小程序一共提供 8 大类 30 多个组件：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;视图容器：主要是实现页面布局的，对常见的布局形式进行了封装，比如滚动 sroll-view 等&lt;/li&gt;
  &lt;li&gt;基本内容：类似 HTML5 中内容相关的 p、em 等&lt;/li&gt;
  &lt;li&gt;表单相关：要比 HTML5 的 form 表单丰富一些&lt;/li&gt;
  &lt;li&gt;导航：类似 a 标签&lt;/li&gt;
  &lt;li&gt;媒体：类比 HTML5 中的 video、audio 和 img 等，但是提供更标准的界面和更丰富的 API 支持&lt;/li&gt;
  &lt;li&gt;画布：Native 实现的 Canvas&lt;/li&gt;
  &lt;li&gt;地图：结合腾讯地图数据 Native 实现的组件&lt;/li&gt;
  &lt;li&gt;开放能力：这部分组件偏通用和小程序业务&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;2自定义组件&quot;&gt;2.自定义组件&lt;/h3&gt;

&lt;p&gt;小程序本身支持很多组件，比如地图、按钮等，开发者也可以自己做项目内公共组件，比如我们后面实战部分会介绍做一个 icon 组件，放在 &lt;code class=&quot;highlighter-rouge&quot;&gt;components&lt;/code&gt; 目录下面，这样此小程序的任何页面如果要使用这个 icon 公共组件，只需在自己的 &lt;code class=&quot;highlighter-rouge&quot;&gt;page.json&lt;/code&gt; 中添加如下字段：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&quot;usingComponents&quot;: {
  &quot;icon&quot;: &quot;../../components/icon/index&quot;
}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;添加完成之后，在页面代码中就可以直接使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;icon&amp;gt;&lt;/code&gt; 的 tag 了。&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/framework/custom-component/&quot;&gt;官方文档&lt;/a&gt;有更加详细的介绍。&lt;/p&gt;

&lt;h3 id=&quot;3插件&quot;&gt;3.插件&lt;/h3&gt;

&lt;p&gt;插件是对一组 JS 接口、自定义组件或页面的封装，用于提供给第三方小程序调用。简单来说，插件是组件的升级版本，组件只能在自己项目中使用，插件则更独立，是可以发布到全网，供其他开发者使用的。例如实战中，笔者使用了一款日历插件，则需要在 &lt;code class=&quot;highlighter-rouge&quot;&gt;app.json&lt;/code&gt; 中增加 &lt;code class=&quot;highlighter-rouge&quot;&gt;plugins&lt;/code&gt; 字段：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&quot;plugins&quot;: {
  &quot;calendar&quot;: {
    &quot;version&quot;: &quot;1.1.3&quot;,
    &quot;provider&quot;: &quot;wx92c68dae5a8bb046&quot;
  }
}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果想开发一个插件，则可以参考&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/framework/plugin/development.html&quot;&gt;官方文档&lt;/a&gt;。&lt;/p&gt;

&lt;h2 id=&quot;五小程序开发基础&quot;&gt;五、小程序开发基础&lt;/h2&gt;

&lt;p&gt;微信小程序是由数据驱动的开发框架，本小节主要介绍小程序开发中的基础概念和知识。&lt;/p&gt;

&lt;h3 id=&quot;1数据驱动&quot;&gt;1.数据驱动&lt;/h3&gt;

&lt;p&gt;微信小程序是数据驱动模型，在 WXML 中可以对页面的数据进行绑定，小程序的 WXML 内使用的是 Mustache 语法，在 &lt;code class=&quot;highlighter-rouge&quot;&gt;{/{}/}&lt;/code&gt;(去掉双括号中间的&lt;code class=&quot;highlighter-rouge&quot;&gt;/&lt;/code&gt;) 内可以将变量名包裹起来。 例如：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//(去掉双括号中间的`/`)
&amp;lt;view&amp;gt;{/{ message }/}&amp;lt;/view&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Page({
  data: {
    message: 'Hello MINA!'
  }
})
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;但是小程序不支持复杂的表达式，目前支持简单的三元、加减和逻辑判断，如果要使用形如 &lt;code class=&quot;highlighter-rouge&quot;&gt;{/{parseInt(num)}/}&lt;/code&gt;(去掉双括号中间的&lt;code class=&quot;highlighter-rouge&quot;&gt;/&lt;/code&gt;) 的函数调用语法，需要 &lt;code class=&quot;highlighter-rouge&quot;&gt;WXS&lt;/code&gt; 支持：&lt;/p&gt;

&lt;p&gt;WXML 内容：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//(去掉双括号中间的`/`)
&amp;lt;wxs src=&quot;./demo.wxs&quot; module=&quot;tools&quot; /&amp;gt;
&amp;lt;view&amp;gt;{/{ tools.toNumber(num) }/}&amp;lt;/view&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;WXS 内容：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// demo.wxs
function toNumber(n){
  return parseInt(n)
}
module.exports.toNumber = toNumber

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;小程序内对页面的数据修改只能通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;setData&lt;/code&gt; 方法，不能使用直接赋值的方式 &lt;code class=&quot;highlighter-rouge&quot;&gt;this.data.key = value&lt;/code&gt;：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Page({
  data: {
    message: 'Hello MINA!'
  },
  onLoad(){
    this.setData({
      message: 'hello world~'
    })
  }
})
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;记住：修改页面数据，只能使用 this.setData 修改！&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;2事件绑定和处理&quot;&gt;2.事件绑定和处理&lt;/h3&gt;

&lt;p&gt;在小程序内，除了标准 HTML5 中遇见的 &lt;code class=&quot;highlighter-rouge&quot;&gt;touchstart&lt;/code&gt; 等事件外，增加了 &lt;code class=&quot;highlighter-rouge&quot;&gt;tap&lt;/code&gt; 类的事件，主要包括以下几种：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;事件名称&lt;/th&gt;
      &lt;th&gt;说明&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;tap&lt;/td&gt;
      &lt;td&gt;手指触摸后马上离开&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;longpress&lt;/td&gt;
      &lt;td&gt;手指触摸后，超过 350ms 再离开，如果指定了事件回调函数并触发了这个事件，tap 事件将不被触发&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;longtap&lt;/td&gt;
      &lt;td&gt;手指触摸后，超过 350ms 再离开（推荐使用 longpress 事件代替）&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;小程序内，事件的绑定是通过在 WXML 标签增加 &lt;code class=&quot;highlighter-rouge&quot;&gt;bind*&lt;/code&gt; 属性来实现的，当用户点击之后，会响应对应页面 JS 的函数：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;view class=&quot;life-style&quot;&amp;gt;
    &amp;lt;view class=&quot;item&quot; wx:for=&quot;&quot; data-name=&quot;&quot; data-detail=&quot;&quot; bindtap=&quot;indexDetail&quot;&amp;gt;
      &amp;lt;view class=&quot;title&quot;&amp;gt;
        &amp;lt;icon type=&quot;&quot;&amp;gt;&amp;lt;/icon&amp;gt;
        
      &amp;lt;/view&amp;gt;
      &amp;lt;view class=&quot;content&quot;&amp;gt;&amp;lt;/view&amp;gt;
    &amp;lt;/view&amp;gt;
&amp;lt;/view&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;上面的代码绑定了 &lt;code class=&quot;highlighter-rouge&quot;&gt;tap&lt;/code&gt; 事件，事件处理函数为 &lt;code class=&quot;highlighter-rouge&quot;&gt;indexDetail&lt;/code&gt;。&lt;/p&gt;

&lt;h4 id=&quot;1事件冒泡&quot;&gt;（1）事件冒泡&lt;/h4&gt;

&lt;p&gt;&lt;strong&gt;小程序内的事件分为可冒泡和不可冒泡的事件，除了 submit、input 之类的事件，多数是可冒泡的事件&lt;/strong&gt;，对于事件的绑定，除了 &lt;code class=&quot;highlighter-rouge&quot;&gt;bind*&lt;/code&gt; 的方式，还可以通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;catch*&lt;/code&gt; 的方式来绑定，两者的区别在于：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;bind&lt;/code&gt; 不会阻止冒泡，变形写法为 &lt;code class=&quot;highlighter-rouge&quot;&gt;bind:*&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;catch&lt;/code&gt; 会阻止事件继续冒泡，变形写法为 &lt;code class=&quot;highlighter-rouge&quot;&gt;catch:*&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;2事件捕获&quot;&gt;（2）事件捕获&lt;/h4&gt;

&lt;p&gt;小程序内，触摸类事件支持捕获阶段，捕获是先于冒泡的触发，绑定捕获事件，可以使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;capture-bind&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;capture-catch&lt;/code&gt;，后者将中断捕获阶段和取消冒泡阶段，下面是官方的示例：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;在下面的代码中，点击 inner view 会先后调用 handleTap2、handleTap4、handleTap3、handleTap1。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;view id=&quot;outer&quot; bind:touchstart=&quot;handleTap1&quot; capture-bind:touchstart=&quot;handleTap2&quot;&amp;gt;
  outer view
  &amp;lt;view id=&quot;inner&quot; bind:touchstart=&quot;handleTap3&quot; capture-bind:touchstart=&quot;handleTap4&quot;&amp;gt;
    inner view
  &amp;lt;/view&amp;gt;
&amp;lt;/view&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;如果将上面代码中的第一个 capture-bind 改为 capture-catch，将只触发 handleTap2。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;view id=&quot;outer&quot; bind:touchstart=&quot;handleTap1&quot; capture-catch:touchstart=&quot;handleTap2&quot;&amp;gt;
  outer view
  &amp;lt;view id=&quot;inner&quot; bind:touchstart=&quot;handleTap3&quot; capture-bind:touchstart=&quot;handleTap4&quot;&amp;gt;
    inner view
  &amp;lt;/view&amp;gt;
&amp;lt;/view&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;关于事件的详细说明，建议阅读&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html&quot;&gt;官方的文档&lt;/a&gt;，以获取更大的帮助。&lt;/p&gt;

&lt;h4 id=&quot;3事件对象&quot;&gt;（3）事件对象&lt;/h4&gt;

&lt;p&gt;当事件触发时，处理函数会响应，传入 &lt;code class=&quot;highlighter-rouge&quot;&gt;event&lt;/code&gt; 对象，通过 &lt;code class=&quot;highlighter-rouge&quot;&gt;event&lt;/code&gt; 对象可以获取事件触发时候的一些信息，包括时间戳、&lt;code class=&quot;highlighter-rouge&quot;&gt;detail&lt;/code&gt; 等。&lt;/p&gt;

&lt;p&gt;因为小程序内的事件绑定都是在 WXML 中实现的，所以传递参数只能通过 WXML 上面的属性值来传递，例如下面的代码中，&lt;code class=&quot;highlighter-rouge&quot;&gt;indexDetail&lt;/code&gt; 处理函数需要接收生活指数的名称和详情，来弹出弹层提示，这时候需要在标签上增加 &lt;code class=&quot;highlighter-rouge&quot;&gt;data-xx&lt;/code&gt; 这样的属性，&lt;code class=&quot;highlighter-rouge&quot;&gt;data-name&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;data-detail&lt;/code&gt; 就是两个属性，通过这两个值，可以在 &lt;code class=&quot;highlighter-rouge&quot;&gt;indexDetail&lt;/code&gt; 内 &lt;code class=&quot;highlighter-rouge&quot;&gt;event&lt;/code&gt; 对象的 &lt;code class=&quot;highlighter-rouge&quot;&gt;target/currentTarget&lt;/code&gt; 的 &lt;code class=&quot;highlighter-rouge&quot;&gt;dataset&lt;/code&gt; 获取参数。&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;view class=&quot;life-style&quot;&amp;gt;
    &amp;lt;view class=&quot;item&quot; wx:for=&quot;&quot; data-name=&quot;&quot; data-detail=&quot;&quot; bindtap=&quot;indexDetail&quot;&amp;gt;
      &amp;lt;view class=&quot;title&quot;&amp;gt;
        &amp;lt;icon type=&quot;&quot;&amp;gt;&amp;lt;/icon&amp;gt;
        
      &amp;lt;/view&amp;gt;
      &amp;lt;view class=&quot;content&quot;&amp;gt;&amp;lt;/view&amp;gt;
    &amp;lt;/view&amp;gt;
&amp;lt;/view&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// weather/index.js
// 响应事件的处理函数
indexDetail(e) {
  const {name, detail} = e.currentTarget.dataset
  wx.showModal({
    title: name,
    content: detail,
    showCancel: false
  })
}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;按照官方文档，&lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;currentTarget&lt;/code&gt; 都有个 &lt;code class=&quot;highlighter-rouge&quot;&gt;dataset&lt;/code&gt;，&lt;strong&gt;正确获取 &lt;code class=&quot;highlighter-rouge&quot;&gt;dataset&lt;/code&gt; 的姿势是使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;currentTarget&lt;/code&gt; 的&lt;/strong&gt;，但是有时候 &lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt; 和 &lt;code class=&quot;highlighter-rouge&quot;&gt;currentTarget&lt;/code&gt; 的数据又是完全一样的，如果这里使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt; 的话，那么有时候点击会弹出弹窗，有时候不会弹出，这两者究竟是怎样的关系呢？官方的解释有点模棱两可：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt;：触发事件的源组件&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;currentTarget&lt;/code&gt;：事件绑定的当前组件&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;这里笔者做下详细解释：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt;：触发事件的源组件，上面的代码中，&lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt; 可能是 &lt;code class=&quot;highlighter-rouge&quot;&gt;view.title&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;view.content&lt;/code&gt;、&lt;code class=&quot;highlighter-rouge&quot;&gt;view.item&lt;/code&gt; 任意触发事件的组件&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;currentTarget&lt;/code&gt;：事件绑定的当前组件，上面的代码中，只能是真正绑定了 &lt;code class=&quot;highlighter-rouge&quot;&gt;bindtap&lt;/code&gt; 的 &lt;code class=&quot;highlighter-rouge&quot;&gt;view.item&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;下面再来看下例子：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;view id=&quot;outer&quot; bindtap=&quot;handleTap1&quot;&amp;gt;
  outer view
  &amp;lt;view id=&quot;middle&quot; catchtap=&quot;handleTap2&quot;&amp;gt;
    middle view
    &amp;lt;view id=&quot;inner&quot; bindtap=&quot;handleTap3&quot;&amp;gt;
      inner view
    &amp;lt;/view&amp;gt;
  &amp;lt;/view&amp;gt;
&amp;lt;/view&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;blockquote&gt;
  &lt;p&gt;点击 inner view 时，handleTap3 收到的事件对象 target 和 currentTarget 都是 inner，而 handleTap2 收到的事件对象 target 就是 inner，currentTarget 就是 middle。&lt;/p&gt;

  &lt;p&gt;由此一看，可以简单总结出来：&lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt; 是事件触发源头的地方，即事件开始的地方，可以冒泡到父节点触发父节点的绑定事件；而 &lt;code class=&quot;highlighter-rouge&quot;&gt;currentTarget&lt;/code&gt; 是开发者自己绑定事件的地方，即实际的绑定事件的节点。&lt;strong&gt;所以，如果绑定的事件有子节点，那么 &lt;code class=&quot;highlighter-rouge&quot;&gt;target&lt;/code&gt; 不会等于 &lt;code class=&quot;highlighter-rouge&quot;&gt;currentTarget&lt;/code&gt;，有可能是冒泡触发的，由此可见，获取 &lt;code class=&quot;highlighter-rouge&quot;&gt;dataset&lt;/code&gt; 的时候使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;currentTarget&lt;/code&gt; 是靠谱的。&lt;/strong&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;3小程序的事件驱动和数据绑定模型&quot;&gt;3.小程序的事件驱动和数据绑定模型&lt;/h3&gt;

&lt;p&gt;由上面数据驱动和事件监听的处理方式可见，小程序是一套数据和事件驱动的模型，即下面的形式：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-06-17-blog_wxmini_005.jpg&quot; alt=&quot;blog_wxmini_005&quot; /&gt;&lt;/p&gt;

&lt;p&gt;关于小程序的运行机制，在&lt;a href=&quot;/article/15606901443&quot;&gt;第 4 节&lt;/a&gt;中会有更加详细的介绍。&lt;/p&gt;

&lt;h3 id=&quot;4路由&quot;&gt;4.路由&lt;/h3&gt;

&lt;p&gt;在小程序内，不能像 HTML5 中 a 标签那样，随便跳转，也不能像 &lt;code class=&quot;highlighter-rouge&quot;&gt;location&lt;/code&gt; 对象中对应的属性那样随意跳转，小程序提供了对应 a 标签和 &lt;code class=&quot;highlighter-rouge&quot;&gt;location&lt;/code&gt; 对象的方法：&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/component/navigator.html&quot;&gt;navigator 组件&lt;/a&gt;。&lt;/p&gt;

&lt;p&gt;在小程序中，路由是由路由栈来维护的，小程序的路由栈中最多维护 5 个页面，这样在 5 个页面内，小程序维护其渲染页面，可以实现快速的切换。&lt;/p&gt;

&lt;p&gt;小程序中跳转页面可以通过下面两种方式：&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;使用 navigator 组件：&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;navigator url=&quot;跳转页面URL&quot; &amp;gt;跳转到新页面&amp;lt;/navigator&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;ol&gt;
  &lt;li&gt;使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx&lt;/code&gt; 中的导航相关函数：&lt;/li&gt;
&lt;/ol&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;view bindtap=&quot;gotoUrl&quot;&amp;gt;跳转页面&amp;lt;/view&amp;gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Page({
  gotoUrl(){
    let url = 'pages/another/url'
    wx.navigateTo({
      url
    })
  }
})

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;5javascript-的限制和增强&quot;&gt;5.JavaScript 的限制和增强&lt;/h3&gt;

&lt;p&gt;微信内的 JavaScript 相对于浏览器中的有限制也有增强，增强的部分是基于小程序 Native 端能力做的增强，比如增强的文件操作类（相册、录音等）；除了增强，跟 HTML5 浏览器环境最大的不同是限制部分。&lt;/p&gt;

&lt;p&gt;小程序的执行环境是没有浏览器了，所以浏览器环境特有的 &lt;code class=&quot;highlighter-rouge&quot;&gt;window&lt;/code&gt; 对象、BOM 和 DOM 等相关 API 都存在缺失（有对应的补充 API），小程序的执行环境是类似于 Node.js 的一种执行环境。因为没有浏览器环境，所以跟浏览器相关的操作如 cookie、Ajax 请求（&lt;code class=&quot;highlighter-rouge&quot;&gt;XMLHttpRequest&lt;/code&gt;）、DOM 选择器、DOM 事件、路由 history、缓存、设备信息、位置等都不存在，与之相对应的是小程序的私有 API，比如我们在小程序中不能使用 &lt;code class=&quot;highlighter-rouge&quot;&gt;XMLHttpRequest&lt;/code&gt;，但是可以使用功能更加强大的 &lt;code class=&quot;highlighter-rouge&quot;&gt;wx.request&lt;/code&gt; 方法。&lt;/p&gt;

&lt;h2 id=&quot;六小程序布局相关知识&quot;&gt;六、小程序布局相关知识&lt;/h2&gt;

&lt;p&gt;本小节介绍小程序布局相关的知识。&lt;/p&gt;

&lt;h3 id=&quot;1rpx&quot;&gt;1.rpx&lt;/h3&gt;

&lt;p&gt;小程序 WXSS 中使用了 rpx 这个长度单位，可以用于表示元素的宽高和边距、字体的大小等。对于习惯使用 px 或者 rem 来做页面的前端来说，这可能让人有点迷糊。rpx 是以小程序容器宽度（等于设备宽度）恒等于 &lt;code class=&quot;highlighter-rouge&quot;&gt;750rpx&lt;/code&gt; 来做定义的。对于 iPhone 6 来说，因为 dpr 为 2，所以 iPhone 的宽度为 375px，这样在 iPhone 6 上使用 rpx 的话，换算关系为 &lt;code class=&quot;highlighter-rouge&quot;&gt;2rpx=1px&lt;/code&gt;。根据这样的关系类推，得到官方给的表格：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;设备&lt;/th&gt;
      &lt;th&gt;rpx换算 px (屏幕宽度/750)&lt;/th&gt;
      &lt;th&gt;px 换算 rpx (750/屏幕宽度)&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;iPhone 5&lt;/td&gt;
      &lt;td&gt;1rpx = 0.42px&lt;/td&gt;
      &lt;td&gt;1px = 2.34rpx&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;iPhone 6&lt;/td&gt;
      &lt;td&gt;1rpx = 0.5px&lt;/td&gt;
      &lt;td&gt;1px = 2rpx&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;iPhone 6 Plus&lt;/td&gt;
      &lt;td&gt;1rpx = 0.552px&lt;/td&gt;
      &lt;td&gt;1px = 1.81rpx&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;看起来很麻烦，但是只需要&lt;strong&gt;按照官方建议，让设计师按照 iPhone 6 的视觉稿标准出图即可，即宽度为 750px&lt;/strong&gt;，按照 750px 出图，那么我们写页面时直接使用测量的尺寸来设置 rpx 就行了。&lt;/p&gt;

&lt;h3 id=&quot;2flex-布局&quot;&gt;2.flex 布局&lt;/h3&gt;

&lt;p&gt;在 HTML5 标准中，flex 布局可以简便、完整、响应式地实现各种页面布局，小程序作为晚于 flex 标准创建的 Hybrid 解决方案，自然在布局设计上采用了先进的 flex 布局。&lt;/p&gt;

&lt;p&gt;关于 flex 布局相关知识，可以参考阮一峰的 &lt;a href=&quot;http://www.ruanyifeng.com/blog/2015/07/flex-grammar.html&quot;&gt;flex 布局教程：语法篇&lt;/a&gt;和&lt;a href=&quot;http://www.ruanyifeng.com/blog/2015/07/flex-examples.html&quot;&gt;实例篇&lt;/a&gt;。&lt;/p&gt;

&lt;h2 id=&quot;七小结&quot;&gt;七、小结&lt;/h2&gt;

&lt;p&gt;本节从小程序账号注册说起，依次介绍了小程序开发者工具、小程序开发语言、小程序项目、开发和布局相关的基础知识，内容由浅到深，全面地帮助大家入门小程序开发。&lt;/p&gt;

&lt;p&gt;更多微信小程序的基础知识可以参考官方文档：&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/index.html&quot;&gt;简易教程&lt;/a&gt;、&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/framework/MINA.html&quot;&gt;框架&lt;/a&gt;、&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/component/&quot;&gt;组件&lt;/a&gt;、&lt;a href=&quot;https://developers.weixin.qq.com/miniprogram/dev/api/&quot;&gt;API&lt;/a&gt;。&lt;/p&gt;
</description>
      </item>
    
      <item>
        <title>概述 ：微信小程序概述</title>
        <link>https://gorpeln.com//article/15599710733</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15599710733</guid>
        <pubDate>Sat, 08 Jun 2019 00:00:00 +0800</pubDate>
        <description>&lt;h2 id=&quot;一什么是微信小程序&quot;&gt;一、什么是微信小程序&lt;/h2&gt;

&lt;p&gt;小程序是有别于传统 Web App、HTML5、原生 App 以及微信公众号的一种新的应用形式，由微信团队于 2017 年 1 月对外发布的，经过近两年的发展，小程序越来越成熟，小程序研发也越来越受到重视。什么是小程序？用张小龙自己的话来说：&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;小程序是一种不需要下载安装即可使用的应用，它实现了应用“触手可及”的梦想，用户扫一扫或者搜一下即可打开应用。也体现了“用完即走”的理念，用户不用关心是否安装太多应用的问题。应用将无处不在，随时可用，但又无须安装卸载。&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;　　微信公开数据显示，当前已上线小程序总数超过100万，开发者超过150万，而用户方面，小程序日活已达2.8亿，人均使用20个小程序，人均使用时长超过10分钟，作为对比淘宝和抖音的使用时长分别是：25分钟，26分钟，可见在微信巨大的流量扶持下，小程序一开始反哺微信生态。&lt;/p&gt;

&lt;p&gt;　　随着微信小程序搞得风风火火，阿里巴巴和百度也开始提出自己的小程序。2017 年 8 月，阿里巴巴旗下的支付宝小程序开始对外公测；2018 年 7 月在百度的 AI 大会上，依托百度 App 的百度智能小程序宣布开始内测。至此，BAT 三家都有了自己的小程序。除了 BAT 之外，小米联合众多手机开发厂商也在 2018 年年初发布了「快应用」，而谷歌也发布了「Instant Apps」。&lt;/p&gt;

&lt;p&gt;有人对比了 BAT 小程序和快应用的优缺点：&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;APP&lt;/th&gt;
      &lt;th&gt;特点&lt;/th&gt;
      &lt;th&gt;优势&lt;/th&gt;
      &lt;th&gt;优势&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;微信&lt;/td&gt;
      &lt;td&gt;社交平台&lt;/td&gt;
      &lt;td&gt;庞大流量与独一无二的社交资源&lt;/td&gt;
      &lt;td&gt;过分封闭，损害用户社交体验&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;百度&lt;/td&gt;
      &lt;td&gt;强调智能&lt;/td&gt;
      &lt;td&gt;搜索资本和开放体系&lt;/td&gt;
      &lt;td&gt;支付弱，开发者变现难，社交短缺&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;支付宝&lt;/td&gt;
      &lt;td&gt;工具属性强&lt;/td&gt;
      &lt;td&gt;线上与线下资源&lt;/td&gt;
      &lt;td&gt;社交短缺，流量转化率低&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;快应用&lt;/td&gt;
      &lt;td&gt;手机商入口&lt;/td&gt;
      &lt;td&gt;厂商提供用户基础&lt;/td&gt;
      &lt;td&gt;没有流量，不可转移&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;二微信小程序入口和限制&quot;&gt;二、微信小程序入口和限制&lt;/h2&gt;

&lt;p&gt;　　出乎意料的是小程序排名第一的场景入口居然是聊天分享，主页下拉则屈居第二，而发现栏小程序固定回访入口则排在模板消息卡片之后，位居第四，可见小程序背靠微信大树，社交裂变依然是最重要的流量来源和获客渠道。&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;微信小程序能做什么&lt;/th&gt;
      &lt;th&gt;微信小程序不能做什么&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;可以快速扫码进入，可以找到用过的小程序&lt;/td&gt;
      &lt;td&gt;没有统一入口，不能做推荐和分发&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;可以跟公众号关联并相互跳转&lt;/td&gt;
      &lt;td&gt;不能订阅，没有粉丝数&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;可向用过小程序的用户发送模板和客服消息&lt;/td&gt;
      &lt;td&gt;不能主动推送信息&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;可以分享给好友或微信群&lt;/td&gt;
      &lt;td&gt;不能分享朋友圈&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;可以切换小程序，可以做小游戏&lt;/td&gt;
      &lt;td&gt;无 Cookie，用户体系需要基于微信账号&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;可以搜索查找附近的小程序&lt;/td&gt;
      &lt;td&gt;检索具有局限性，不能模糊搜索&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;三微信小程序和-h5-对比&quot;&gt;三、微信小程序和 H5 对比&lt;/h2&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;项目&lt;/th&gt;
      &lt;th&gt;运行环境&lt;/th&gt;
      &lt;th&gt;入口&lt;/th&gt;
      &lt;th&gt;分享&lt;/th&gt;
      &lt;th&gt;系统权限&lt;/th&gt;
      &lt;th&gt;客户端能力&lt;/th&gt;
      &lt;th&gt;流畅度&lt;/th&gt;
      &lt;th&gt;开发成本&lt;/th&gt;
      &lt;th&gt;上线&lt;/th&gt;
      &lt;th&gt;通用性和迁移性&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;微信小程序&lt;/td&gt;
      &lt;td&gt;微信内&lt;/td&gt;
      &lt;td&gt;扫码、分享&lt;/td&gt;
      &lt;td&gt;不能分享到朋友圈&lt;/td&gt;
      &lt;td&gt;较强&lt;/td&gt;
      &lt;td&gt;较强&lt;/td&gt;
      &lt;td&gt;流畅&lt;/td&gt;
      &lt;td&gt;相对 H5 高，相对 App 低&lt;/td&gt;
      &lt;td&gt;依赖审核&lt;/td&gt;
      &lt;td&gt;私有 API 和组件实现，通用性较差&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;H5&lt;/td&gt;
      &lt;td&gt;各种浏览器和 APP 内部 WebView&lt;/td&gt;
      &lt;td&gt;通过 URL 访问，微信内部可通过链接、分享、扫描&lt;/td&gt;
      &lt;td&gt;好友、群、朋友圈、非微信 App 都可以&lt;/td&gt;
      &lt;td&gt;较弱&lt;/td&gt;
      &lt;td&gt;较弱&lt;/td&gt;
      &lt;td&gt;较差&lt;/td&gt;
      &lt;td&gt;较低&lt;/td&gt;
      &lt;td&gt;完全自主&lt;/td&gt;
      &lt;td&gt;好&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h2 id=&quot;四小程序的未来去向何方&quot;&gt;四、小程序的未来去向何方？&lt;/h2&gt;
&lt;h4 id=&quot;1细分市场找准用户&quot;&gt;（1）细分市场，找准用户&lt;/h4&gt;

&lt;p&gt;　　背靠微信的10亿流量，通过社交裂变获客可以说从没有如此简单，然而基于社交流量盲目裂变的最大问题在于用户留存度不高，因此在利用社交裂变之余，细分市场，做好精准人群才能切实提高用户留存和转化率。&lt;/p&gt;

&lt;h4 id=&quot;2新零售借势起步&quot;&gt;（2）新零售借势起步&lt;/h4&gt;

&lt;p&gt;　　新零售不是什么新概念，然后喊了很多年，直到小程序上线后社交电商的崛起才打响了新零售的第一枪，拿今年大火的社区团购举例，基于社群+O2O的商业模式，成功的将线下资源和线上零售融合在一起，显然借助大数据和精准营销后，小程序和新零售的想象空间还很大。&lt;/p&gt;

&lt;h4 id=&quot;3创业起步风投融资&quot;&gt;（3）创业起步，风投融资&lt;/h4&gt;

&lt;p&gt;　　历经十多次版本迭代和功能升级后，小程序已可满足大量线下线上使用场景，可以说已能做到真正取代80%的APP。而微信10亿的用户量级几乎囊括了国内全部网络用户，相比花费高额成本开发APP，然后从0开始获客拉新，还要时刻警惕“马太效应”。&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
而小程序不仅可以轻易获取用户，只需做好商业模式和用户体验即可，再加上微信小程序规范、去中心化的生态，小程序可以说是创业者的天堂。&lt;/p&gt;

&lt;p&gt;另一方面，对于投资者来说，小程序可变现和快速增长的特性也十分符合资本期待，因此资本未来必将会更加关注小程序生态内的创业者，因此小程序生态的成熟对于创业者和投资人来说都将是一件好事。&lt;/p&gt;

&lt;h2 id=&quot;五如何进行微信小程序开发&quot;&gt;五、如何进行微信小程序开发&lt;/h2&gt;

&lt;p&gt;　　微信小程序本质上是一套 Hybrid 解决方案，掌握基础 HTML5 知识的前端开发者就可以参与小程序的开发。微信小程序提供完善的开发工具链，熟悉客户端的开发者也可以快速上手小程序开发。如何快速开始小程序开发呢？分为下面几个步骤：&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;注册一个小程序开发账号&lt;/li&gt;
  &lt;li&gt;下载微信开发者工具&lt;/li&gt;
  &lt;li&gt;学习开发语言基础知识和小程序框架原理&lt;/li&gt;
  &lt;li&gt;学习小程序 API 的使用&lt;/li&gt;
  &lt;li&gt;学习小程序调试和上线操作&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;后续将会详细讲解。&lt;/p&gt;
</description>
      </item>
    
      <item>
        <title>编程到底难在哪里？</title>
        <link>https://gorpeln.com//article/15589479418</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15589479418</guid>
        <pubDate>Mon, 27 May 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;这篇回答并不是讲述在生活中程序员如何买苹果，而是以买苹果为例说明程序员如何解决问题。程序员需要对问题进行透彻的分析，理清其涉及的所有细节，预测可能发生的所有意外与非意外的情况，列出解决方案的所有步骤，以及对解决方案进行尽量全面的测试。而这些正是编程难的地方。任何一点遗漏都会成为bug，轻则导致挨骂，重则导致经济损失甚至危害安全&lt;/p&gt;

&lt;h4 id=&quot;普通人&quot;&gt;普通人：&lt;/h4&gt;
&lt;p&gt;我今天要买一斤苹果。&lt;/p&gt;

&lt;h4 id=&quot;程序员&quot;&gt;程序员：&lt;/h4&gt;
&lt;p&gt;我今天要买一斤苹果。&lt;/p&gt;

&lt;p&gt;因为我只喜欢红富士苹果，所以我只买红富士苹果。&lt;br /&gt;
我能接受的最高价格是 10 元 / 斤。&lt;br /&gt;
正常情况下一斤苹果用一个袋子能装下，但是为防万一，我会带两个袋子。&lt;br /&gt;
我知道附近的 3 家水果店，所以我会依次访问这 3 家水果店。&lt;br /&gt;
根据上述条件，我设计出以下的买苹果的流程：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-05-29-blog_coding_hard_001.jpg&quot; alt=&quot;blog_coding_hard_001&quot; /&gt;&lt;/p&gt;

&lt;p&gt;这个流程怎么样？我来设计一些测试样例，测试一下这个流程。&lt;/p&gt;

&lt;p&gt;测试发现一个问题：如果水果店 0 和水果店 1 都有红富士苹果并且价格都低于 10 元 / 斤，而且水果店 1 的价格比水果店 0 更低，那么我希望买水果店 1 的苹果，但我设计的流程会让我买水果店 0 的苹果。&lt;/p&gt;

&lt;p&gt;为了解决这个问题，我应该先询问所有水果店的价格，然后去价格最低的那一家买苹果。&lt;br /&gt;
经过修改，我重新设计出以下的买苹果的流程：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/2019-05-29-blog_coding_hard_002.jpg&quot; alt=&quot;blog_coding_hard_002&quot; /&gt;&lt;/p&gt;

&lt;p&gt;现在这个流程是不是完美了呢？不是，我还能发现很多问题。&lt;/p&gt;

&lt;p&gt;如果 3 家水果店都有红富士苹果但都不到一斤，但是三家店加起来能达到一斤，那么我不应该结束流程回家，而是应该把三家店的红富士苹果都买下来。&lt;/p&gt;

&lt;p&gt;如果我向水果店询问价格的时候这家店还有红富士苹果，但我询问完所有水果店的价格后这家店的红富士苹果卖完了，那么我的流程会让我试图处理不存在的红富士苹果。&lt;/p&gt;

&lt;p&gt;我走路的过程中可能会遇到突发事件，比如发现了新的水果店，比如袋子破掉了苹果掉一地，对于这些情况我的流程都无法进行处理。&lt;/p&gt;

&lt;p&gt;啊问题太多了我懒得再改流程了。我还是去 X 宝买吧。那么接下来我要设计一个在 X 宝买红富士苹果的流程……&lt;/p&gt;

</description>
      </item>
    
      <item>
        <title>好玩的H5小游戏·圈小猫~</title>
        <link>https://gorpeln.com//article/15583474979</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15583474979</guid>
        <pubDate>Mon, 20 May 2019 00:00:00 +0800</pubDate>
        <description>&lt;h3 id=&quot;玩法&quot;&gt;玩法&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;点击小圆点，围住小猫。&lt;/li&gt;
  &lt;li&gt;你点击一次，小猫走一次。&lt;/li&gt;
  &lt;li&gt;直到你把小猫围住（赢），或者小猫走到边界并逃跑（输）。&lt;/li&gt;
&lt;/ul&gt;

&lt;div&gt;

    &lt;script src=&quot;/assets/js/catch-the-cat/phaser.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;/assets/js/catch-the-cat/catch-the-cat.js&quot;&gt;&lt;/script&gt;
    &lt;div id=&quot;catch-the-cat&quot; style=&quot;border:1px #37374c solid;width: 100%;text-align: center;&quot;&gt;&lt;/div&gt;
    &lt;script&gt;
      window.game = new CatchTheCatGame({
        w: 11,
        h: 11,
        r: 20,
        backgroundColor: 0xffffff,
        parent: 'catch-the-cat',
        statusBarAlign: 'center',
        credit: 'github.com/gorpeln'
      });
    &lt;/script&gt;
    
&lt;/div&gt;

&lt;h3 id=&quot;赢游戏小技巧&quot;&gt;赢游戏小技巧&lt;/h3&gt;
&lt;p&gt;　　刚开始玩的时候觉得很难赢，静下心来仔细想想，算法肯定是按照离边界的最短距离路线来移动小猫，这么一来甚至可以给小猫挖坑，游戏难度瞬间就下来了~。 &lt;br /&gt;
　　一开始算法应该是随机选一个方向，为了更容易赢，我们可以落子在 四边中最少子的，最边缘的那部分。接着看小猫移动方向，然后在小猫前进方向的最边缘，能有多远离离多远落子，注意别把它的活路堵死，留一个出个在哪里，小猫会根据算法傻傻的来到距离最短的位置，我们守株待猫就很容易赢了。&lt;/p&gt;

</description>
      </item>
    
      <item>
        <title>微信红包算法</title>
        <link>https://gorpeln.com//article/15575387722</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15575387722</guid>
        <pubDate>Sat, 11 May 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;微信是采用什么样的算法做到的？简单百度了下，目前尚未有官方的说明。&lt;/p&gt;

&lt;p&gt;我按照自己的逻辑尝试了下，这个算法需要满足以下几点要求：&lt;/p&gt;

&lt;p&gt;1、每个人都要能够领取到红包；&lt;br /&gt;
2、每个人领取到的红包金额总和=总金额；&lt;br /&gt;
3、每个人领取到的红包金额不等，但也不能差的太离谱，不然就没趣味；&lt;br /&gt;
4、算法一定要简单，不然对不起腾讯这个招牌；&lt;/p&gt;

&lt;p&gt;正式编码之前，先搭建一个递进的模型来分析规律&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;设定总金额为10元，有N个人随机领取：  
  
N=1 
则红包金额=X元； 
  
N=2 
为保证第二个红包可以正常发出，第一个红包金额=0.01至9.99之间的某个随机数 
第二个红包=10-第一个红包金额； 
  
N=3 
红包1=0.01至0.98之间的某个随机数 
红包2=0.01至(10-红包1-0.01)的某个随机数 
红包3=10-红包1-红包2 
  
……
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;至此，规律出现啦！开始编码！&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;header(&quot;Content-Type: text/html;charset=utf-8&quot;);//输出不乱码，你懂的
$total=10;//红包总额
$num=8;// 分成8个红包，支持8人随机领取
$min=0.01;//每个人最少能收到0.01元

for ($i=1;$i&amp;lt;$num;$i++)
{
    $safe_total=$total-($num-$i)*$min;//随机安全上限
    $money=mt_rand($min*100,$safe_total*100)/100;
    $total=$total-$money;
    echo '第'.$i.'个红包：'.$money.' 元，余额：'.$total.' 元 &amp;lt;br/&amp;gt;';
}
echo '第'.$num.'个红包：'.$total.' 元，余额：0 元';
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;输出一看，波动太大，这数据太无趣了！&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;第1个红包：7.48 元，余额：2.52 元 
第2个红包：1.90 元，余额：0.62 元 
第3个红包：0.49 元，余额：0.13 元 
第4个红包：0.04 元，余额：0.09 元 
第5个红包：0.03 元，余额：0.06 元 
第6个红包：0.03 元，余额：0.03 元 
第7个红包：0.01 元，余额：0.02 元 
第8个红包：0.02 元，余额：0 元

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;改良一下，将平均值作为随机安全上限来控制波动差&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;header(&quot;Content-Type: text/html;charset=utf-8&quot;);//输出不乱码，你懂的
$total=10;//红包总额
$num=8;// 分成8个红包，支持8人随机领取
$min=0.01;//每个人最少能收到0.01元

for ($i=1;$i&amp;lt;$num;$i++)
{
    $safe_total=($total-($num-$i)*$min)/($num-$i);//随机安全上限
    $money=mt_rand($min*100,$safe_total*100)/100;
    $total=$total-$money;
    echo '第'.$i.'个红包：'.$money.' 元，余额：'.$total.' 元 &amp;lt;br/&amp;gt;';
}
echo '第'.$num.'个红包：'.$total.' 元，余额：0 元';
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;输出结果：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;第1个红包：0.06 元，余额：9.94 元 
第2个红包：1.55 元，余额：8.39 元 
第3个红包：0.25 元，余额：8.14 元 
第4个红包：0.98 元，余额：7.16 元 
第5个红包：1.88 元，余额：5.28 元 
第6个红包：1.92 元，余额：3.36 元 
第7个红包：2.98 元，余额：0.38 元 
第8个红包：0.38 元，余额：0 元
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;﹣﹣﹣﹣﹣ java version ﹣﹣﹣﹣﹣&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/**
 * 微信红包分配算法
 * 
 * @author Michael282694
 * */
public class wechat_money {

	public static void main(String[] args) {
		// TODO Auto-generated method stub

		double total_money; // 红包总金额
		int total_people; // 抢红包总人数
		double min_money; // 每个人最少能收到0.01元

		total_money = 10.0;
		total_people = 8;
		min_money = 0.01;

		for (int i = 0; i &amp;lt; total_people - 1; i++) {
			int j = i + 1;
			double safe_money = (total_money - (total_people - j) * min_money)
					/ (total_people - j);
			double tmp_money = (Math.random()
					* (safe_money * 100 - min_money * 100) + min_money * 100) / 100;
			total_money = total_money - tmp_money;
			System.out.format(&quot;第 %d 个红包： %.2f 元，剩下： %.2f 元\n&quot;, j, tmp_money,
					total_money);
		}
		System.out.format(&quot;第 %d 个红包： %.2f 元，剩下： 0 元\n&quot;, total_people,
				total_money);
	}
}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;某一次的結果：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;第 1 个红包： 0.54 元，剩下： 9.46 元
第 2 个红包： 1.04 元，剩下： 8.42 元
第 3 个红包： 0.60 元，剩下： 7.83 元
第 4 个红包： 0.17 元，剩下： 7.66 元
第 5 个红包： 1.54 元，剩下： 6.11 元
第 6 个红包： 0.58 元，剩下： 5.53 元
第 7 个红包： 3.60 元，剩下： 1.93 元
第 8 个红包： 1.93 元，剩下： 0 元
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;因为保留两位小数时存在四舍五入，有时候所有金额相加会存在0.01元的误差（实际并不存在）。&lt;/p&gt;

</description>
      </item>
    
      <item>
        <title>抽奖 - 算法</title>
        <link>https://gorpeln.com//article/15573877312</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15573877312</guid>
        <pubDate>Thu, 09 May 2019 00:00:00 +0800</pubDate>
        <description>&lt;h3 id=&quot;目标&quot;&gt;目标&lt;/h3&gt;
&lt;ul&gt;
  &lt;li&gt;奖品尽量在活动期间被平均分布（不要在活动一开始就被抽完）&lt;/li&gt;
  &lt;li&gt;大奖尽量在后面才被抽中&lt;/li&gt;
  &lt;li&gt;奖品尽量不要有剩余&lt;/li&gt;
  &lt;li&gt;每个奖品可以设置抽中概率&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;对于最后一点，因为活动前并不知道参加活动人数，所以设置的概率反而影响了前面几点。如果概率大了可能活动一开始就被抽完，如果太小参与人数不多可能到活动结束之后奖品还余了一半。&lt;/p&gt;

&lt;p&gt;其实平均分布才是最关键的。满足了这个条件之后可以根据奖品的数量或概率让奖品在活动时间内靠前或者靠后被抽中。我们来分析一下如何满足这点&lt;/p&gt;

&lt;h3 id=&quot;分析&quot;&gt;分析&lt;/h3&gt;
&lt;p&gt;要让奖品平均分布在活动时间段内，可以把时间段分成n（奖品总数）段，每一小段时间抽走一个奖品即可
n = (endTime-startTime)/amount&lt;/p&gt;

&lt;p&gt;活动结束时间-开始时间 然后除奖品总数就得到时间分片&lt;/p&gt;

&lt;p&gt;在每一个时间片段里随机选一个点让用户中奖，随机是为了避免暴露精确的时间点&lt;/p&gt;

&lt;p&gt;time(x)=startTime + (x-1)*n + random(n)&lt;/p&gt;

&lt;p&gt;第x次抽奖中奖时间点：开始时间+此次抽奖之前的时间片总和+此次抽奖片段内的随机点&lt;/p&gt;

&lt;h3 id=&quot;实现&quot;&gt;实现&lt;/h3&gt;
&lt;p&gt;实现分成两步&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;随机抽取一个奖品（可以根据奖品数量，概率，奖品重要程度等）&lt;/li&gt;
  &lt;li&gt;判断当前时间片的中奖时间和当前时间的大小，如果大于当前时间则中奖&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;具体实现看代码：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//随机抽取一个奖品
public static AwardTo randomGetAward(List&amp;lt;AwardTo&amp;gt; awardToList) {
        if (awardToList == null || awardToList.isEmpty()) {
            return null;
        }

        double weight = 0;
        for (AwardTo awardTo : awardToList) {
            //此处用了奖品的概率，实际结果并不好
            weight += awardTo.getAwardBalance() * awardTo.getPossible();
        }

        if (weight == 0) {
            return null;
        }
        //每次的种子数都是奖品的总量，所以只要奖品没被抽中，当前时间片的中奖时间点始终是固定的
        Random random = new Random((long) weight);
        int num = random.nextInt((int) weight);

        for (AwardTo awardTo : awardToList) {
            //数量少的奖品在一开始被抽走的概率很小，数量越多越容易被抽中
            num -= awardTo.getAwardBalance() * awardTo.getPossible();
            if (num &amp;lt; 0) {
                return awardTo;
            }
        }
        return null;
    }
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;//判断是否中奖
//LotteryVO为抽奖活动实体对象，包含活动开始，结束时间等
public AwardVO lottery(LotteryVO lottery) {
    List&amp;lt;AwardVO&amp;gt; awards = lottery.getAwardList();
    long now = System.currentTimeMillis();
    long startTime = lottery.getStartTime().getTime();
    long endTime = lottery.getEndTime().getTime();

    int amount = 0;
    int abalance = 0;
    for (AwardVO award : awards) {
        amount += award.getAwardAmount();
        abalance += award.getAwardBalance();
    }

    AwardVO award = randomGetAward(awards);

    //如果当前奖品没被抽走，出奖时间点要求不变，所以需要一个种子。我们在奖品类上保存该奖品上一次被抽中时间
    long lastUpdateTime = award.getLastUpdateTime().getTime();
    int amount = award.getAwardAmount();
    //时间片数
    long deltaTime = (endTime - startTime) / amount;
    // 使用lastUpdateTime做为随机因子，保证下一个奖品的随机时间对每个抽奖者都一样
    Random random = new Random(lastUpdateTime);
    // 计算下一个奖品释放时间
    long releaseTime = startTime + (amount - abalance)*deltaTime + Math.abs(random.nextLong()) % deltaTime;

    // 未达到下一奖品发放时间
    if (now &amp;lt; releaseTime) {
        return null;
    }
    return award;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;如果每次抽奖必中，省略第二步即可。另外可通过调整第一步中的算法实现不同的需求。&lt;/p&gt;

</description>
      </item>
    
      <item>
        <title>WOW.js – 有趣的页面滚动效果</title>
        <link>https://gorpeln.com//article/15549830140</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15549830140</guid>
        <pubDate>Thu, 11 Apr 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;WOW.js支持多种动画效果，让你的页面滚动效果更加有趣。&lt;/p&gt;

&lt;p&gt;WOW.js 依赖 &lt;code class=&quot;highlighter-rouge&quot;&gt;animate.css&lt;/code&gt;，所以它支持 animate.css 多达 60 多种的动画效果，能满足你的各种需求。&lt;/p&gt;

&lt;p&gt;WOW.js 使用了 querySelectorAll 方法，IE 低版本会报错，支持IE10+。为了达到更好的兼容，最好加一个浏览器及版本判断。&lt;/p&gt;

&lt;h3 id=&quot;使用方法&quot;&gt;使用方法&lt;/h3&gt;
&lt;h4 id=&quot;1引入文件&quot;&gt;1、引入文件&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;link rel=&quot;stylesheet&quot; href=&quot;css/animate.min.css&quot;&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;2html&quot;&gt;2、HTML&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;div class=&quot;wow slideInLeft&quot;&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;div class=&quot;wow slideInRight&quot;&amp;gt;&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;可以加入 data-wow-duration（动画持续时间）和 data-wow-delay（动画延迟时间）属性，如：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&amp;lt;div class=&quot;wow slideInLeft&quot; data-wow-duration=&quot;2s&quot; data-wow-delay=&quot;5s&quot;&amp;gt;&amp;lt;/div&amp;gt;
&amp;lt;div class=&quot;wow slideInRight&quot; data-wow-offset=&quot;10&quot;  data-wow-iteration=&quot;10&quot;&amp;gt;&amp;lt;/div&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;data-wow-duration&lt;/code&gt;：更改动画持续时间&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;data-wow-delay&lt;/code&gt;：动画开始前的延迟&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;data-wow-offset&lt;/code&gt;：开始动画的距离（与浏览器底部相关）&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;data-wow-iteration&lt;/code&gt;：动画的次数重复（无限次：infinite）&lt;/p&gt;

&lt;h4 id=&quot;3javascript&quot;&gt;3、JavaScript&lt;/h4&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;new WOW().init();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;如果需要自定义配置，可如下使用：&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;var wow = new WOW({
    boxClass: 'wow',
    animateClass: 'animated',
    offset: 0,
    mobile: true,
    live: true
});
wow.init();
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;h4 id=&quot;选项配置&quot;&gt;选项配置&lt;/h4&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;属性/方法&lt;/th&gt;
      &lt;th&gt;说明&lt;/th&gt;
      &lt;th&gt;默认值&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;boxClass&lt;/td&gt;
      &lt;td&gt;需要执行动画的元素的class，字符串&lt;/td&gt;
      &lt;td&gt;‘wow’&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;animateClass&lt;/td&gt;
      &lt;td&gt;animation.css 动画的class，字符串&lt;/td&gt;
      &lt;td&gt;‘animated’&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;offset&lt;/td&gt;
      &lt;td&gt;距离可视区域多少开始执行动画,整数&lt;/td&gt;
      &lt;td&gt;0&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;mobile&lt;/td&gt;
      &lt;td&gt;是否在移动设备上执行动画，布尔值&lt;/td&gt;
      &lt;td&gt;true&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;live&lt;/td&gt;
      &lt;td&gt;异步加载的内容是否有效，布尔值&lt;/td&gt;
      &lt;td&gt;true&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;h3 id=&quot;动画效果&quot;&gt;【动画效果】&lt;/h3&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;参数&lt;/th&gt;
      &lt;th&gt;说明&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;rollIn&lt;/td&gt;
      &lt;td&gt;从左到右、顺时针滚动、透明度从100%变化至设定值&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;bounceIn&lt;/td&gt;
      &lt;td&gt;从原位置出现，由小变大超出设定值，再变小小于设定值，再回归设定值、透明度从100%变化至设定值&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;bounceInUp&lt;/td&gt;
      &lt;td&gt;从下往上、窜上来以后会向上超出一部分然后弹回去、透明度为设定值不变&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;bounceInDown&lt;/td&gt;
      &lt;td&gt;从上往下、掉下来以后会向下超出一部分然后弹跳一下、透明度为设定值不变&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;bounceInLeft&lt;/td&gt;
      &lt;td&gt;从左往右、移过来以后会向右超出一部分然后往左弹一下、透明度为设定值不变&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;bounceInRight&lt;/td&gt;
      &lt;td&gt;从右往左、移过来以后会向左超出一部分然后往右弹一下、透明度为设定值不变&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;slideInUp&lt;/td&gt;
      &lt;td&gt;从下往上、上来后固定到设定位置、透明度为设定值不变（up是从下往上）（如果元素在最下面，会撑开盒子高度）&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;slideInDown&lt;/td&gt;
      &lt;td&gt;从上往下、上来后固定到设定位置、透明度为设定值不变&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;slideInLeft&lt;/td&gt;
      &lt;td&gt;从左往右、上来后固定到设定位置、透明度为设定值不变（left却是从左往右）&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;slideInRight&lt;/td&gt;
      &lt;td&gt;从右往左、上来后固定到设定位置、透明度为设定值不变&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt; &lt;/td&gt;
      &lt;td&gt; &lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;lightSpeedIn&lt;/td&gt;
      &lt;td&gt;从右往左、头部先向右倾斜，又向左倾斜，最后变为原来的形状、透明度从100%变化至设定值&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;pulse&lt;/td&gt;
      &lt;td&gt;原位置放大一点点在缩小至原本大小、透明度为设定值不变（配合动画执行次数属性效果更佳）&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;flipInX&lt;/td&gt;
      &lt;td&gt;原位置后仰前栽、透明度从100%变化至设定值&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;flipInY&lt;/td&gt;
      &lt;td&gt;原位置左右旋动、透明度从100%变化至设定值&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;bounce&lt;/td&gt;
      &lt;td&gt;上下抖动、透明度为设定值不变（配合动画执行次数和动画持续时间属性可以实现剧烈抖动亦或是慢慢抖）&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;shake&lt;/td&gt;
      &lt;td&gt;左右抖动、透明度为设定值不变（配合动画执行次数和动画持续时间属性可以实现剧烈抖动亦或是慢慢抖）&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;swing&lt;/td&gt;
      &lt;td&gt;从右往左、头部先向右倾斜，又向左倾斜，最后变为原来的形状、透明度为设定值不变&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;bounceInU&lt;/td&gt;
      &lt;td&gt;原位置不变、直接从不显示到显示（无过过渡效果）&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;wobble&lt;/td&gt;
      &lt;td&gt;原位置不变、类似于一个人站在那左右晃头、透明度为设定值不变&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
</description>
      </item>
    
      <item>
        <title>批量修改文件后缀名</title>
        <link>https://gorpeln.com//article/15547100706</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15547100706</guid>
        <pubDate>Mon, 08 Apr 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;新建一个FormatConver.sh文件，写入下面代码，打开终端，把脚本文件拖进来，然后空格在后面写上参数，即可。&lt;/p&gt;
&lt;blockquote&gt;
  &lt;p&gt;参数说明：&lt;/p&gt;

  &lt;p&gt;用法:FormatConvert.sh arg0 arg1 arg2&lt;br /&gt;
arg0:指定路径。arg1:需要查找并且替换的文件名后缀不要有点。arg2:替换成的后缀&lt;/p&gt;

  &lt;p&gt;用法示例：将桌面gorpeln文件夹中的txt文件后缀统一修改为bat&lt;br /&gt;
终端输入：/Users/gorpeln/Desktop/FormatConver.sh /Users/gorpeln/Desktop/gorpeln txt bat&lt;/p&gt;

  &lt;p&gt;注意：添加权限：chmod 777 FormatConver.sh&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c&quot;&gt;#!/bin/bash&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#Programm:&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#此程序用于批量修改文件后缀名&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#用法:FormatConver.sh arg0,arg1,arg2&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#	arg0:指定路径。&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#	arg1:需要查找并且替换的文件名后缀不要有点。&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#	arg2:替换成的后缀		&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#PATH&lt;/span&gt;

&lt;span class=&quot;nv&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;old&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;.&lt;span class=&quot;nv&quot;&gt;$2&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;.&lt;span class=&quot;nv&quot;&gt;$3&lt;/span&gt;
find &lt;span class=&quot;nv&quot;&gt;$path&lt;/span&gt;|grep &lt;span class=&quot;nv&quot;&gt;$old&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt;/tmp/MidTempResult.txt&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#cat MidTempResult.txt&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#从文件中取出每一行的数据&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /tmp/MidTempResult.txt|while &lt;span class=&quot;nb&quot;&gt;read &lt;/span&gt;line
&lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
&lt;span class=&quot;c&quot;&gt;#变量的删除，取得文件名并添加新后缀&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;convertTemp&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;${&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;line&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;%.*&lt;/span&gt;&lt;span class=&quot;k&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$new&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$convertTemp&lt;/span&gt;
&lt;span class=&quot;nv&quot;&gt;str&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;mv&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$line&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;nv&quot;&gt;$convertTemp&lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;sb&quot;&gt;`&lt;/span&gt;
&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;nv&quot;&gt;$str&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;done
&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;echo&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;convert finished&quot;&lt;/span&gt;


&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://drive.gorpeln.com/?/FormatConver.sh&quot;&gt;文件下载&lt;/a&gt;&lt;/p&gt;
</description>
      </item>
    
      <item>
        <title>iOS App 签名的原理</title>
        <link>https://gorpeln.com//article/15526269575</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15526269575</guid>
        <pubDate>Fri, 15 Mar 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;iOS 签名机制挺复杂，各种证书，Provisioning Profile，entitlements，CertificateSigningRequest，p12，AppID，概念一堆，也很容易出错，本文尝试从原理出发，一步步推出为什么会有这么多概念，希望能有助于理解 iOS App 签名的原理和流程。&lt;/p&gt;

&lt;h3 id=&quot;目的&quot;&gt;目的&lt;/h3&gt;
&lt;p&gt;先来看看苹果的签名机制是为了做什么。在 iOS 出来之前，在主流操作系统(Mac/Windows/Linux)上开发和运行软件是不需要签名的，软件随便从哪里下载都能运行，导致平台对第三方软件难以控制，盗版流行。苹果希望解决这样的问题，在 iOS 平台对第三方 APP 有绝对的控制权，一定要保证每一个安装到 iOS 上的 APP 都是经过苹果官方允许的，怎样保证呢？就是通过签名机制。&lt;/p&gt;

&lt;h3 id=&quot;非对称加密&quot;&gt;非对称加密&lt;/h3&gt;
&lt;p&gt;通常我们说的签名就是数字签名，它是基于非对称加密算法实现的。对称加密是通过同一份密钥加密和解密数据，而非对称加密则有两份密钥，分别是公钥和私钥，用公钥加密的数据，要用私钥才能解密，用私钥加密的数据，要用公钥才能解密。&lt;/p&gt;

&lt;p&gt;简单说一下常用的非对称加密算法 RSA 的数学原理，理解简单的数学原理，就可以理解非对称加密是怎么做到的，为什么会是安全的：&lt;/p&gt;

&lt;p&gt;　　1、选两个质数 p 和 q，相乘得出一个大整数n，例如 p = 61，q = 53，n = pq = 3233  &lt;br /&gt;
　　2、选 1-n 间的随便一个质数e，例如 e = 17 &lt;br /&gt;
　　3、经过一系列数学公式，算出一个数字 d，满足：&lt;br /&gt;
　　　　a.通过 n 和 e 这两个数据一组数据进行数学运算后，可以通过 n 和 d 去反解运算，反过来也可以。&lt;br /&gt;
　　　　b.如果只知道 n 和 e，要推导出 d，需要知道 p 和 q，也就是要需要把 n 因数分解。&lt;/p&gt;

&lt;p&gt;上述的 (n,e) 这两个数据在一起就是公钥，(n,d) 这两个数据就是私钥，满足用私钥加密，公钥解密，或反过来公钥加密，私钥解密，也满足在只暴露公钥 (只知道 n 和 e)的情况下，要推导出私钥 (n,d)，需要把大整数 n 因数分解。目前因数分解只能靠暴力穷举，而 n 数字越大，越难以用穷举计算出因数 p 和 q，也就越安全，当 n 大到二进制 1024 位或 2048 位时，以目前技术要破解几乎不可能，所以非常安全。&lt;/p&gt;

&lt;h3 id=&quot;数字签名&quot;&gt;数字签名&lt;/h3&gt;
&lt;p&gt;现在知道了有非对称加密这东西，那数字签名是怎么回事呢？&lt;/p&gt;

&lt;p&gt;数字签名的作用是我对某一份数据打个标记，表示我认可了这份数据（签了个名），然后我发送给其他人，其他人可以知道这份数据是经过我认证的，数据没有被篡改过。&lt;/p&gt;

&lt;p&gt;有了上述非对称加密算法，就可以实现这个需求：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/blog_certificate_001.png&quot; alt=&quot;blog_certificate_001&quot; /&gt;&lt;/p&gt;

&lt;p&gt;　　1、首先用一种算法，算出原始数据的摘要。需满足 &lt;br /&gt;
　　　　a.若原始数据有任何变化，计算出来的摘要值都会变化。 &lt;br /&gt;
　　　　b.摘要要够短。这里最常用的算法是MD5。  &lt;br /&gt;
　　2、生成一份非对称加密的公钥和私钥，私钥我自己拿着，公钥公布出去。&lt;br /&gt;
　　3、对一份数据，算出摘要后，用私钥加密这个摘要，得到一份加密后的数据，称为原始数据的签名。把它跟原始数据一起发送给用户。&lt;br /&gt;
　　4、用户收到数据和签名后，用公钥解密得到摘要。同时用户用同样的算法计算原始数据的摘要，对比这里计算出来的摘要和用公钥解密签名得到的摘要是否相等，若相等则表示这份数据中途没有被篡改过，因为如果篡改过，摘要会变化。&lt;/p&gt;

&lt;p&gt;之所以要有第一步计算摘要，是因为非对称加密的原理限制可加密的内容不能太大（不能大于上述 n 的位数，也就是一般不能大于 1024 位 / 2048 位），于是若要对任意大的数据签名，就需要改成对它的特征值签名，效果是一样的。&lt;/p&gt;

&lt;p&gt;好了，有了非对称加密的基础，知道了数字签名是什么，怎样可以保证一份数据是经过某个地方认证的，来看看怎样通过数字签名的机制保证每一个安装到 iOS 上的 APP 都是经过苹果认证允许的。&lt;/p&gt;

&lt;h3 id=&quot;最简单的签名&quot;&gt;最简单的签名&lt;/h3&gt;
&lt;p&gt;要实现这个需求很简单，最直接的方式，苹果官方生成一对公私钥，在 iOS 里内置一个公钥，私钥由苹果后台保存，我们传 App 上 AppStore 时，苹果后台用私钥对 APP 数据进行签名，iOS 系统下载这个 APP 后，用公钥验证这个签名，若签名正确，这个 APP 肯定是由苹果后台认证的，并且没有被修改过，也就达到了苹果的需求：保证安装的每一个 APP 都是经过苹果官方允许的。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/blog_certificate_002.png&quot; alt=&quot;blog_certificate_002&quot; /&gt;&lt;/p&gt;

&lt;p&gt;如果我们 iOS 设备安装 APP 只有从 AppStore 下载这一种方式的话，这件事就结束了，没有任何复杂的东西，只有一个数字签名，非常简单地解决问题。&lt;/p&gt;

&lt;p&gt;但实际上因为除了从 AppStore 下载，我们还可以有三种方式安装一个 App：&lt;/p&gt;

&lt;p&gt;　　1、开发 App 时可以直接把开发中的应用安装进手机进行调试。&lt;br /&gt;
　　2、In-House 企业内部分发，可以直接安装企业证书签名后的   APP。&lt;br /&gt;
　　3、AD-Hoc 相当于企业分发的限制版，限制安装设备数量，较少用。&lt;/p&gt;

&lt;p&gt;苹果要对用这三种方式安装的 App 进行控制，就有了新的需求，无法像上面这样简单了。&lt;/p&gt;

&lt;h3 id=&quot;新的需求&quot;&gt;新的需求&lt;/h3&gt;
&lt;p&gt;我们先来看第一个，开发时安装APP，它有两个需求：&lt;/p&gt;

&lt;p&gt;　　1、安装包不需要传到苹果服务器，可以直接安装到手机上。如果你编译一个 APP 到手机前要先传到苹果服务器签名，这显然是不能接受的。&lt;br /&gt;
　　2、苹果必须对这里的安装有控制权，包括&lt;br /&gt;
　　　　a. 经过苹果允许才可以这样安装。&lt;br /&gt;
　　　　b. 不能被滥用导致非开发app也能被安装。&lt;/p&gt;

&lt;p&gt;为了实现这些需求，iOS 签名的复杂度也就开始增加了。&lt;/p&gt;

&lt;p&gt;苹果这里给出的方案是使用了双层签名，会比较绕，流程大概是这样的：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/blog_certificate_003.png&quot; alt=&quot;blog_certificate_003&quot; /&gt;&lt;/p&gt;

&lt;p&gt;　　1、在你的 Mac 开发机器生成一对公私钥，这里称为公钥L，私钥L。L:Local&lt;br /&gt;
　　2、苹果自己有固定的一对公私钥，跟上面 AppStore 例子一样，私钥在苹果后台，公钥在每个 iOS 设备上。这里称为公钥A，私钥A。A:Apple&lt;br /&gt;
　　3、私把公钥 L 传到苹果后台，用苹果后台里的私钥 A 去签名公钥 L。得到一份数据包含了公钥 L 以及其签名，把这份数据称为证书。&lt;br /&gt;
  　　4、在开发时，编译完一个 APP 后，用本地的私钥 L 对这个 APP 进行签名，同时把第三步得到的证书一起打包进 APP 里，安装到手机上。&lt;br /&gt;
　　5、在安装时，iOS 系统取得证书，通过系统内置的公钥 A，去验证证书的数字签名是否正确。&lt;br /&gt;
　　6、验证证书后确保了公钥 L 是苹果认证过的，再用公钥 L 去验证 APP 的签名，这里就间接验证了这个 APP 安装行为是否经过苹果官方允许。（这里只验证安装行为，不验证APP 是否被改动，因为开发阶段 APP 内容总是不断变化的，苹果不需要管。）&lt;/p&gt;

&lt;h3 id=&quot;加点东西&quot;&gt;加点东西&lt;/h3&gt;
&lt;p&gt;上述流程只解决了上面第一个需求，也就是需要经过苹果允许才可以安装，还未解决第二个避免被滥用的问题。怎么解决呢？苹果再加了两个限制，一是限制在苹果后台注册过的设备才可以安装，二是限制签名只能针对某一个具体的 APP。&lt;/p&gt;

&lt;p&gt;怎么加的？在上述第三步，苹果用私钥 A 签名我们本地公钥 L 时，实际上除了签名公钥 L，还可以加上无限多数据，这些数据都可以保证是经过苹果官方认证的，不会有被篡改的可能。&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/blog_certificate_004.png&quot; alt=&quot;blog_certificate_004&quot; /&gt;&lt;/p&gt;

&lt;p&gt;可以想到把 允许安装的设备 ID 列表 和 App对应的 AppID 等数据，都在第三步这里跟公钥L一起组成证书，再用苹果私钥 A 对这个证书签名。在最后第 5 步验证时就可以拿到设备 ID 列表，判断当前设备是否符合要求。根据数字签名的原理，只要数字签名通过验证，第 5 步这里的设备 IDs / AppID / 公钥 L 就都是经过苹果认证的，无法被修改，苹果就可以限制可安装的设备和 APP，避免滥用。&lt;/p&gt;

&lt;h3 id=&quot;最终流程&quot;&gt;最终流程&lt;/h3&gt;
&lt;p&gt;到这里这个证书已经变得很复杂了，有很多额外信息，实际上除了 设备 ID / AppID，还有其他信息也需要在这里用苹果签名，像这个 APP 里 iCloud / push / 后台运行 等权限苹果都想控制，苹果把这些权限开关统一称为 Entitlements，它也需要通过签名去授权。&lt;/p&gt;

&lt;p&gt;实际上一个“证书”本来就有规定的格式规范，上面我们把各种额外信息塞入证书里是不合适的，于是苹果另外搞了个东西，叫 Provisioning Profile，一个 Provisioning Profile 里就包含了证书以及上述提到的所有额外信息，以及所有信息的签名。&lt;/p&gt;

&lt;p&gt;所以整个流程稍微变一下，就变成这样了：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/blog_certificate_005.png&quot; alt=&quot;blog_certificate_005&quot; /&gt;&lt;/p&gt;

&lt;p&gt;因为步骤有小变动，这里我们不辞啰嗦重新再列一遍整个流程：&lt;/p&gt;

&lt;p&gt;　　1、在你的 Mac 开发机器生成一对公私钥，这里称为公钥L，私钥L。L:Local&lt;br /&gt;
　　2、苹果自己有固定的一对公私钥，跟上面 AppStore 例子一样，私钥在苹果后台，公钥在每个 iOS 设备上。这里称为公钥A，私钥A。A:Apple  &lt;br /&gt;
　　3、把公钥 L 传到苹果后台，用苹果后台里的私钥 A 去签名公钥 L。得到一份数据包含了公钥 L 以及其签名，把这份数据称为证书。&lt;br /&gt;
　　4、在苹果后台申请 AppID，配置好设备 ID 列表和 APP 可使用的权限，再加上第③步的证书，组成的数据用私钥 A 签名，把数据和签名一起组成一个 Provisioning Profile 文件，下载到本地 Mac 开发机。&lt;br /&gt;
　　5、在开发时，编译完一个 APP 后，用本地的私钥 L 对这个 APP 进行签名，同时把第④步得到的 Provisioning Profile 文件打包进 APP 里，文件名为 embedded.mobileprovision，把 APP 安装到手机上。&lt;br /&gt;
　　6、在安装时，iOS 系统取得证书，通过系统内置的公钥 A，去验证 embedded.mobileprovision 的数字签名是否正确，里面的证书签名也会再验一遍。&lt;br /&gt;
　　7、确保了 embedded.mobileprovision 里的数据都是苹果授权以后，就可以取出里面的数据，做各种验证，包括用公钥 L 验证APP签名，验证设备 ID 是否在 ID 列表上，AppID 是否对应得上，权限开关是否跟 APP 里的 Entitlements 对应等。 　　&lt;/p&gt;

&lt;p&gt;开发者证书从签名到认证最终苹果采用的流程大致是这样，还有一些细节像证书有效期/证书类型等就不细说了。&lt;/p&gt;

&lt;h3 id=&quot;概念和操作&quot;&gt;概念和操作&lt;/h3&gt;
&lt;p&gt;上面的步骤对应到我们平常具体的操作和概念是这样的：&lt;/p&gt;

&lt;p&gt;　　1、第 1 步对应的是 keychain 里的 “从证书颁发机构请求证书”，这里就本地生成了一对公私钥，保存的 CertificateSigningRequest 就是公钥，私钥保存在本地电脑里。&lt;br /&gt;
　　2、第 2 步苹果处理，不用管。&lt;br /&gt;
　　3、第 3 步对应把 CertificateSigningRequest 传到苹果后台生成证书，并下载到本地。这时本地有两个证书，一个是第 1 步生成的，一个是这里下载回来的，keychain 会把这两个证书关联起来，因为他们公私钥是对应的，在XCode选择下载回来的证书时，实际上会找到 keychain 里对应的私钥去签名。这里私钥只有生成它的这台 Mac 有，如果别的 Mac 也要编译签名这个 App 怎么办？答案是把私钥导出给其他 Mac 用，在 keychain 里导出私钥，就会存成 .p12 文件，其他 Mac 打开后就导入了这个私钥。&lt;br /&gt;
　　4、第 4 步都是在苹果网站上操作，配置 AppID / 权限 / 设备等，最后下载 Provisioning Profile 文件。 &lt;br /&gt;
　　5、第 5 步 XCode 会通过第 3 步下载回来的证书（存着公钥），在本地找到对应的私钥（第一步生成的），用本地私钥去签名 App，并把 Provisioning Profile 文件命名为 embedded.mobileprovision 一起打包进去。这里对 App 的签名数据保存分两部分，Mach-O 可执行文件会把签名直接写入这个文件里，其他资源文件则会保存在 _CodeSignature 目录下。&lt;br /&gt;
第 6 – 7 步的打包和验证都是 Xcode 和 iOS 系统自动做的事。&lt;/p&gt;

&lt;p&gt;这里再总结一下这些概念：&lt;/p&gt;

&lt;p&gt;　　1、&lt;strong&gt;证书&lt;/strong&gt;：内容是公钥或私钥，由其他机构对其签名组成的数据包。&lt;br /&gt;
　　2、&lt;strong&gt;Entitlements&lt;/strong&gt;：包含了 App 权限开关列表。&lt;br /&gt;
　　3、&lt;strong&gt;CertificateSigningRequest&lt;/strong&gt;：本地公钥。&lt;br /&gt;
　　4、&lt;strong&gt;p12&lt;/strong&gt;：本地私钥，可以导入到其他电脑。&lt;br /&gt;
　　5、&lt;strong&gt;Provisioning Profile&lt;/strong&gt;：包含了 证书 / Entitlements 等数据，并由苹果后台私钥签名的数据包。&lt;br /&gt;
　　&lt;/p&gt;
&lt;h3 id=&quot;其他发布方式&quot;&gt;其他发布方式&lt;/h3&gt;
&lt;p&gt;前面以开发包为例子说了签名和验证的流程，另外两种方式 In-House 企业签名和 AD-Hoc 流程也是差不多的，只是企业签名不限制安装的设备数，另外需要用户在 iOS 系统设置上手动点击信任这个企业才能通过验证。&lt;/p&gt;

&lt;p&gt;而 AppStore 的签名验证方式有些不一样，前面我们说到最简单的签名方式，苹果在后台直接用私钥签名 App 就可以了，实际上苹果确实是这样做的，如果去下载一个 AppStore 的安装包，会发现它里面是没有 embedded.mobileprovision 文件的，也就是它安装和启动的流程是不依赖这个文件，验证流程也就跟上述几种类型不一样了。&lt;/p&gt;

&lt;p&gt;据猜测，因为上传到 AppStore 的包苹果会重新对内容加密，原来的本地私钥签名就没有用了，需要重新签名，从 AppStore 下载的包苹果也并不打算控制它的有效期，不需要内置一个 embedded.mobileprovision 去做校验，直接在苹果用后台的私钥重新签名，iOS 安装时用本地公钥验证 App 签名就可以了。&lt;/p&gt;

&lt;p&gt;那为什么发布 AppStore 的包还是要跟开发版一样搞各种证书和 Provisioning Profile？猜测因为苹果想做统一管理，Provisioning Profile 里包含一些权限控制，AppID 的检验等，苹果不想在上传 AppStore 包时重新用另一种协议做一遍这些验证，就不如统一把这部分放在 Provisioning Profile 里，上传 AppStore 时只要用同样的流程验证这个 Provisioning Profile 是否合法就可以了。&lt;/p&gt;

&lt;p&gt;所以 App 上传到 AppStore 后，就跟你的 证书 / Provisioning Profile 都没有关系了，无论他们是否过期或被废除，都不会影响 AppStore 上的安装包。&lt;/p&gt;

&lt;p&gt;到这里 iOS 签名机制的原理和主流程大致说完了，希望能对理解苹果签名和排查日常签名问题有所帮助。&lt;/p&gt;

&lt;h3 id=&quot;ps一些疑问&quot;&gt;P.S.一些疑问&lt;/h3&gt;
&lt;p&gt;最后这里再提一下我关于签名流程的一些的疑问。&lt;/p&gt;

&lt;h3 id=&quot;企业证书&quot;&gt;企业证书&lt;/h3&gt;
&lt;p&gt;企业证书签名因为限制少，在国内被广泛用于测试和盗版，fir.im / 蒲公英等测试平台都是通过企业证书分发，国内一些市场像 PP 助手，爱思助手，一部分安装手段也是通过企业证书重签名。通过企业证书签名安装的 App，启动时都会验证证书的有效期，并且不定期请求苹果服务器看证书是否被吊销，若已过期或被吊销，就会无法启动 App。对于这种助手的盗版安装手段，苹果想打击只能一个个吊销企业证书，并没有太好的办法。&lt;/p&gt;

&lt;p&gt;这里我的疑问是，苹果做了那么多签名和验证机制去限制在 iOS 安装 App，为什么又要出这样一个限制很少的方式让盗版钻空子呢？若真的是企业用途不适合上 AppStore，也完全可以在 AppStore 开辟一个小的私密版块，还是通过 AppStore 去安装，就不会有这个问题了。&lt;/p&gt;

&lt;h3 id=&quot;appstore-加密&quot;&gt;AppStore 加密&lt;/h3&gt;
&lt;p&gt;另一个问题是我们把 App 传上 AppStore 后，苹果会对 App 进行加密，导致 App 体积增大不少，这个加密实际上是没卵用的，只是让破解的人要多做一个步骤，运行 App 去内存 dump 出可执行文件而已，无论怎样加密，都可以用这种方式拿出加密前的可执行文件。所以为什么要做这样的加密呢？想不到有什么好处。&lt;/p&gt;

&lt;h3 id=&quot;本地私钥&quot;&gt;本地私钥&lt;/h3&gt;
&lt;p&gt;我们看到前面说的签名流程很绕很复杂，经常出现各种问题，像有 Provisioning Profile 文件但证书又不对，本地有公钥证书没对应私钥等情况，不理解原理的情况下会被绕晕，我的疑问是，这里为什么不能简化呢？还是以开发证书为例，为什么一定要用本地 Mac 生成的私钥去签名？苹果要的只是本地签名，私钥不一定是要本地生成的，苹果也可以自己生成一对公私钥给我们，放在 Provisioning Profile 里，我们用里面的私钥去加密就行了，这样就不会有 CertificateSigningRequest 和 p12 的概念，跟本地 keychain 没有关系，不需要关心证书，只要有 Provisioning Profile 就能签名，流程会减少，易用性会提高很多，同时苹果想要的控制一点都不会少，也没有什么安全问题，为什么不这样设计呢？&lt;/p&gt;

&lt;p&gt;能想到的一个原因是 Provisioning Profile 在非 AppStore 安装时会打包进安装包，第三方拿到这个 Provisioning Profile 文件就能直接用起来给他自己的 App 签名了。但这种问题也挺好解决，只需要打包时去掉文件里的私钥就行了，所以仍不明白为什么这样设计。&lt;/p&gt;
</description>
      </item>
    
      <item>
        <title>移动 APP 网络优化概述</title>
        <link>https://gorpeln.com//article/15524857215</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15524857215</guid>
        <pubDate>Wed, 13 Mar 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;一般开发一个 APP，会直接调用系统提供的网络请求接口去服务端请求数据，再针对返回的数据进行一些处理，或者使用AFNetworking/OKHttp这样的网络库，管理好请求线程和队列，再自动做一些数据解析，就结束了。&lt;/p&gt;

&lt;p&gt;但对于一些大型 APP，还会想针对网络的一些问题进行进一步优化，包括：&lt;/p&gt;

&lt;p&gt;　　1、&lt;strong&gt;速度&lt;/strong&gt;：网络请求的速度怎样能进一步提升？&lt;br /&gt;
　　2、&lt;strong&gt;弱网&lt;/strong&gt;：移动端网络环境随时变化，经常出现网络连接很不稳定可用性差的情况，怎样在这种情况下最大限度最快地成功请求？&lt;br /&gt;
　　3、&lt;strong&gt;安全&lt;/strong&gt;：怎样防止被第三方窃听/篡改或冒充，防止运营商劫持，同时又不影响性能？&lt;/p&gt;

&lt;p&gt;对基于浏览器的前端开发来说，网络这块能做的事情很少，但对于客户端 APP 来说，整个网络请求过程是自由控制的，可以做很多事情，很多大型 APP 都针对这三个问题做了很多网络层的优化，一些新的网络层协议像 HTTP2 / QUIC 也是在这些方面进行了不少优化，在这里边学习边整理，大致列举一下常见的做法。&lt;/p&gt;

&lt;h3 id=&quot;速度&quot;&gt;速度&lt;/h3&gt;
&lt;p&gt;正常一条网络请求需要经过的流程是这样：&lt;br /&gt;
　　1、DNS 解析，请求DNS服务器，获取域名对应的 IP 地址。&lt;br /&gt;
　　2、与服务端建立连接，包括 tcp 三次握手，安全协议同步流程。&lt;br /&gt;
　　3、连接建立完成，发送和接收数据，解码数据。&lt;/p&gt;

&lt;p&gt;这里有明显的三个优化点：&lt;br /&gt;
　　1、直接使用 IP 地址，去除 DNS 解析步骤。&lt;br /&gt;
　　2、不要每次请求都重新建立连接，复用连接或一直使用同一条连接(长连接)。&lt;br /&gt;
　　3、压缩数据，减小传输的数据大小。&lt;/p&gt;

&lt;p&gt;逐条来看能做什么。&lt;/p&gt;

&lt;h4 id=&quot;1dns&quot;&gt;1.DNS&lt;/h4&gt;
&lt;p&gt;DNS 完整的解析流程很长，会先从本地系统缓存取，若没有就到最近的 DNS 服务器取，若没有再到主域名服务器取，每一层都有缓存，但为了域名解析的实时性，每一层缓存都有过期时间，这种 DNS 解析机制有几个缺点：&lt;/p&gt;

&lt;p&gt;　　1、缓存时间设置得长，域名更新不及时，设置得短，大量 DNS 解析请求影响请求速度。&lt;br /&gt;
　　2、域名劫持，容易被中间人攻击，或被运营商劫持，把域名解析到第三方 IP 地址，据统计劫持率会达到7%。&lt;br /&gt;
　　3、DNS 解析过程不受控制，无法保证解析到最快的IP&lt;br /&gt;
　　4、一次请求只能解析一个域名。&lt;/p&gt;

&lt;p&gt;为了解决这些问题，就有了 HTTPDNS，原理很简单，就是自己做域名解析的工作，通过 HTTP 请求后台去拿到域名对应的 IP 地址，直接解决上述所有问题：&lt;/p&gt;

&lt;p&gt;　　1、域名解析与请求分离，所有请求都直接用IP地址，无需 DNS 解析，APP 定时请求 HTTPDNS 服务器更新IP地址即可。&lt;br /&gt;
　　2、通过签名等方式，保证 HTTPDNS 请求的安全，避免被劫持。&lt;br /&gt;
　　3、DNS 解析由自己控制，可以确保根据用户所在地返回就近的 IP 地址，或根据客户端测速结果使用速度最快的 IP。&lt;br /&gt;
　　4、一次请求可以解析多个域名。&lt;/p&gt;

&lt;p&gt;其余细节就不多说了，HTTPDNS 优点这么多，几乎成为中大型 APP 的标配。至此解决了第一个问题 — DNS 解析耗时的问题，顺便把一部分安全问题 — DNS 劫持也解决了。&lt;/p&gt;

&lt;h4 id=&quot;2连接&quot;&gt;2.连接&lt;/h4&gt;
&lt;p&gt;第二个问题，连接建立耗时的问题，这里主要的优化思路是复用连接，不用每次请求都重新建立连接，如何更有效率地复用连接，可以说是网络请求速度优化里最主要的点了，并且这里的优化仍在演进过程中，值得了解下。&lt;/p&gt;

&lt;h5 id=&quot;keep-alive&quot;&gt;keep-alive&lt;/h5&gt;
&lt;p&gt;HTTP 协议里有个 keep-alive，HTTP1.1默认开启，一定程度上缓解了每次请求都要进行TCP三次握手建立连接的耗时。原理是请求完成后不立即释放连接，而是放入连接池中，若这时有另一个请求要发出，请求的域名和端口是一样的，就直接拿出连接池中的连接进行发送和接收数据，少了建立连接的耗时。&lt;/p&gt;

&lt;p&gt;实际上现在无论是客户端还是浏览器都默认开启了keep-alive，对同个域名不会再有每发一个请求就进行一次建连的情况，纯短连接已经不存在了。但有个问题，就是这个 keep-alive 的连接一次只能发送接收一个请求，在上一个请求处理完成之前，无法接受新的请求。若同时发起多个请求，就有两种情况：&lt;/p&gt;

&lt;p&gt;　　1、若串行发送请求，可以一直复用一个连接，但速度很慢，每个请求都要等待上个请求完成再进行发送。&lt;br /&gt;
　　2、若并行发送这些请求，那么首次每个请求都要进行tcp三次握手建立新的连接，虽然第二次可以复用连接池里这堆连接，但若连接池里保持的连接过多，对服务端资源产生较大浪费，若限制了保持的连接数，并行请求里超出的连接仍每次要建连。&lt;/p&gt;

&lt;p&gt;对这个问题，新一代协议 HTTP2 提出了多路复用去解决。&lt;/p&gt;

&lt;h5 id=&quot;多路复用&quot;&gt;多路复用&lt;/h5&gt;
&lt;p&gt;HTTP2 的多路复用机制一样是复用连接，但它复用的这条连接支持同时处理多条请求，所有请求都可以并发在这条连接上进行，也就解决了上面说的并发请求需要建立多条连接带来的问题，网络上有张图可以较形象地表现这个过程：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/blog_network_001.png&quot; alt=&quot;blog_network_001&quot; /&gt;&lt;/p&gt;

&lt;p&gt;HTTP1.1的协议里，在一个连接里传送数据都是串行顺序传送的，必须等上一个请求全部处理完后，下一个请求才能进行处理，导致这些请求期间这条连接并不是满带宽传输的，即使是HTTP1.1的pipelining可以同时发送多个request，但response仍是按请求的顺序串行返回，只要其中一个请求的response稍微大一点或发生错误，就会阻塞住后面的请求。&lt;/p&gt;

&lt;p&gt;HTTP2 这里的多路复用协议解决了这些问题，它把在连接里传输的数据都封装成一个个stream，每个stream都有标识，stream的发送和接收可以是乱序的，不依赖顺序，也就不会有阻塞的问题，接收端可以根据stream的标识去区分属于哪个请求，再进行数据拼接，得到最终数据。&lt;/p&gt;

&lt;p&gt;解释下多路复用这个词，多路可以认为是多个连接，多个操作，复用就是字面上的意思，复用一条连接或一个线程。HTTP2这里是连接的多路复用，网络相关的还有一个I/O的多路复用(select/epoll)，指通过事件驱动的方式让多个网络请求返回的数据在同一条线程里完成读写。&lt;/p&gt;

&lt;p&gt;客户端来说，iOS9 以上 NSURLSession 原生支持 HTTP2，只要服务端也支持就可以直接使用，Android 的 okhttp3 以上也支持了 HTTP2，国内一些大型 APP 会自建网络层，支持 HTTP2 的多路复用，避免系统的限制以及根据自身业务需要增加一些特性，例如微信的开源网络库 mars，做到一条长连接处理微信上的大部分请求，多路复用的特性上基本跟 HTTP2 一致。&lt;/p&gt;

&lt;h5 id=&quot;tcp队头阻塞&quot;&gt;TCP队头阻塞&lt;/h5&gt;
&lt;p&gt;HTTP2 的多路复用看起来是完美的解决方案，但还有个问题，就是队头阻塞，这是受限于 TCP 协议，TCP 协议为了保证数据的可靠性，若传输过程中一个 TCP 包丢失，会等待这个包重传后，才会处理后续的包。HTTP2的多路复用让所有请求都在同一条连接进行，中间有一个包丢失，就会阻塞等待重传，所有请求也就被阻塞了。&lt;/p&gt;

&lt;p&gt;对于这个问题不改变 TCP 协议就无法优化，但 TCP 协议依赖操作系统实现以及部分硬件的定制，改进缓慢，于是 GOOGLE 提出 QUIC 协议，相当于在 UDP 协议之上再定义一套可靠传输协议，解决 TCP 的一些缺陷，包括队头阻塞。具体解决原理网上资料较多，可以看看。&lt;/p&gt;

&lt;p&gt;QUIC 处于起步阶段，少有客户端接入，QUIC 协议相对于 HTTP2 最大的优势是对TCP队头阻塞的解决，其他的像安全握手 0RTT / 证书压缩等优化 TLS1.3 已跟进，可以用于 HTTP2，并不是独有特性。TCP 队头阻塞在 HTTP2 上对性能的影响有多大，在速度上 QUIC 能带来多大提升待研究。&lt;/p&gt;

&lt;h4 id=&quot;3数据&quot;&gt;3.数据&lt;/h4&gt;
&lt;p&gt;第三个问题，传输数据大小的问题。数据对请求速度的影响分两方面，一是压缩率，二是解压序列化反序列化的速度。目前最流行的两种数据格式是 json 和 protobuf，json 是字符串，protobuf 是二进制，即使用各种压缩算法压缩后，protobuf 仍会比 json 小，数据量上 protobuf 有优势，序列化速度 protobuf 也有一些优势，这两者的对比就不细说了。&lt;/p&gt;

&lt;p&gt;压缩算法多种多样，也在不断演进，最新出的 Brotli 和Z-standard实现了更高的压缩率，Z-standard 可以根据业务数据样本训练出适合的字典，进一步提高压缩率，目前压缩率表现最好的算法。&lt;/p&gt;

&lt;p&gt;除了传输的 body 数据，每个请求 HTTP 协议头的数据也是不可忽视，HTTP2 里对 HTTP 协议头也进行了压缩，HTTP 头大多是重复数据，固定的字段如 method 可以用静态字典，不固定但多个请求重复的字段例如 cookie 用动态字典，可以达到非常高的压缩率，&lt;a href=&quot;https://imququ.com/post/header-compression-in-http2.html&quot;&gt;这里&lt;/a&gt;有详细介绍。&lt;/p&gt;

&lt;p&gt;通过 HTTPDNS，连接多路复用，更好的数据压缩算法，可以把网络请求的速度优化到较不错的程度了，接下来再看看弱网和安全上可以做的事情。&lt;/p&gt;

&lt;h3 id=&quot;弱网&quot;&gt;弱网&lt;/h3&gt;
&lt;p&gt;手机无线网络环境不稳定，针对弱网的优化，微信有较多实践和分享，包括：&lt;br /&gt;
　　1、提升连接成功率&lt;br /&gt;
　　复合连接，建立连接时，阶梯式并发连接，其中一条连通后其他连接都关闭。这个方案结合串行和并发的优势，提高弱网下的连接成功率，同时又不会增加服务器资源消耗：&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;https://img.gorpeln.com/blog_network_002.png&quot; alt=&quot;blog_network_002&quot; /&gt;&lt;/p&gt;

&lt;p&gt;　　2、制定最合适的超时时间&lt;br /&gt;
　　对总读写超时(从请求到响应的超时)、首包超时、包包超时(两个数据段之间的超时)时间制定不同的计算方案，加快对超时的判断，减少等待时间，尽早重试。这里的超时时间还可以根据网络状态动态设定。&lt;/p&gt;

&lt;p&gt;　　3、调优TCP参数，使用TCP优化算法。&lt;br /&gt;
　　对服务端的TCP协议参数进行调优，以及开启各种优化算法，使得适合业务特性和移动端网络环境，包括RTO初始值，混合慢启动，TLP，F-RTO等。&lt;/p&gt;

&lt;p&gt;针对弱网的这些细致优化未成为标准，系统网络库没有内置，不过前两个客户端优化微信的开源网络库 mars 有实现，若有需要可以使用。&lt;/p&gt;

&lt;h3 id=&quot;安全&quot;&gt;安全&lt;/h3&gt;
&lt;p&gt;标准协议 TLS 保证了网络传输的安全，前身是 SSL，不断在演进，目前最新是 TLS1.3。常见的 HTTPS 就是 HTTP 协议加上 TLS 安全协议。&lt;/p&gt;

&lt;p&gt;安全协议概括性地说解决两个问题：1.保证安全 2. 降低加密成本&lt;/p&gt;

&lt;p&gt;在保证安全上：&lt;/p&gt;

&lt;p&gt;　　1、使用加密算法组合对传输数据加密，避免被窃听和篡改。&lt;br /&gt;
　　2、认证对方身份，避免被第三方冒充。&lt;br /&gt;
　　3、加密算法保持灵活可更新，防止定死算法被破解后无法更换，禁用已被破解的算法。&lt;/p&gt;

&lt;p&gt;降低加密成本上：&lt;/p&gt;

&lt;p&gt;　　1、用对称加密算法加密传输数据，解决非对称加密算法的性能低以及长度限制问题。&lt;br /&gt;
　　2、缓存安全协议握手后的密钥等数据，加快第二次建连的速度。&lt;br /&gt;
　　3、加快握手过程：2RTT-&amp;gt; 0RTT。加快握手的思路，就是原本客户端和服务端需要协商使 用什么算法后才能加密发送数据，变成通过内置的公钥和默认的算法，在握手的同时就把数据发出去，也就是不需要等待握手就开始发送数据，达到0RTT。&lt;/p&gt;

&lt;p&gt;这些点涉及的细节非常多，对 TLS 的介绍有一篇雄文，说得很详细，在此推荐。&lt;/p&gt;

&lt;p&gt;目前基本主流都支持 TLS1.2，iOS 网络库默认使用 TLS1.2，Android4.4 以上支持 1.2。TLS1.3 iOS 还处于测试阶段，Android 未查到消息。对于普通 APP，只要正确配置证书，TLS1.2 已经能保证传输安全，只是在建连速度上会有所损耗，有一些大型 APP 像微信就自行实现了 TLS1.3 的部分协议，早一步全平台支持。&lt;/p&gt;

&lt;h3 id=&quot;最后&quot;&gt;最后&lt;/h3&gt;
&lt;p&gt;网络优化这个话题非常庞大，本文只是在学习过程中从优化思路上列举了目前业界常见的优化点，还有很多细节很多更深入的优化没涉及到，网络层实践开发经验不足，若有错误欢迎指出。&lt;/p&gt;
</description>
      </item>
    
      <item>
        <title>Sublime Text 3安装使用 MAC</title>
        <link>https://gorpeln.com//article/15501213244</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15501213244</guid>
        <pubDate>Thu, 14 Feb 2019 00:00:00 +0800</pubDate>
        <description>&lt;p&gt;Sublime Text：一款具有代码高亮、语法提示、自动完成且反应快速的编辑器软件，不仅具有华丽的界面，还支持插件扩展机制，用她来写代码，绝对是一种享受。相比于难于上手的Vim，浮肿沉重的Eclipse，VS，即便体积轻巧迅速启动的Editplus、Notepad++，在SublimeText面前大略显失色，无疑这款性感无比的编辑器是Coding和Writing最佳的选择，没有之一。&lt;/p&gt;

&lt;h3 id=&quot;安装&quot;&gt;安装&lt;/h3&gt;
&lt;p&gt;官网：&lt;a href=&quot;http://www.sublimetext.com/3&quot;&gt;http://www.sublimetext.com/3&lt;/a&gt;  选择对应的版本，点击下载安装&lt;/p&gt;

&lt;h3 id=&quot;注册&quot;&gt;注册&lt;/h3&gt;
&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;----- BEGIN LICENSE -----
sgbteam
Single User License
EA7E-1153259
8891CBB9 F1513E4F 1A3405C1 A865D53F
115F202E 7B91AB2D 0D2A40ED 352B269B
76E84F0B CD69BFC7 59F2DFEF E267328F
215652A3 E88F9D8F 4C38E3BA 5B2DAAE4
969624E7 DC9CD4D5 717FB40C 1B9738CF
20B3C4F1 E917B5B3 87C38D9C ACCE7DD8
5F7EF854 86B9743C FADC04AA FB0DA5C0
F913BE58 42FEA319 F954EFDD AE881E0B
------ END LICENSE ------
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;插件&quot;&gt;插件&lt;/h3&gt;

&lt;h4 id=&quot;1安装-package-control&quot;&gt;1、安装 package control&lt;/h4&gt;

&lt;p&gt;功能：安装插件的工具，有了它，以后安装其他插件更方便&lt;/p&gt;

&lt;p&gt;第一步：按 Ctrl + ~ 键，调出 sublime 的控制台；&lt;/p&gt;

&lt;p&gt;第二步：在调出的控制台输入如下指令（需要科学上网）&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;import urllib.request,os;pf='Package Control.sublime-package';ipp=sublime.installed_packages_path();urllib.request.install_opener(urllib.request.build_opener(urllib.request.ProxyHandler()));open(os.path.join(ipp,pf),'wb').write(urllib.request.urlopen('http://sublime.wbond.net/'+pf.replace(' ','%20')).read())
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;回车，稍等片刻，如果在 preferences 里有 package control 就说明安装成功了；&lt;/p&gt;

&lt;p&gt;第三步：重启Sublime Text 3，查看Perferences-&amp;gt;package settings中是否有package control这一项，如果有，则安装成功&lt;/p&gt;

&lt;hr /&gt;
&lt;hr /&gt;

&lt;p&gt;&lt;strong&gt;安装插件&lt;/strong&gt;：Ctrl+Shift+P调出命令面板，在输入框输入Install Package ，然后在新弹出的窗口中查询要安装的插件，点击需要安装的插件，即可；&lt;/p&gt;

&lt;p&gt;并可在Perferences-&amp;gt;package settings 中看到对应的包名。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;删除插件&lt;/strong&gt;：Ctrl+Shift+P调出命令面板，输入remove，调出Remove Package选项并回车，选择要删除的插件即可。&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;更新插件&lt;/strong&gt;：输入：upgrade packages，后回车，如果有列表出来则有插件需要更新，然后点击需要升级的插件即可；&lt;/p&gt;

&lt;h4 id=&quot;2常用插件&quot;&gt;2、常用插件&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;ChineseLocalization 汉化包&lt;/li&gt;
  &lt;li&gt;Color Highlight    显示所选颜色值的颜色，并集成了ColorPicker&lt;/li&gt;
  &lt;li&gt;HTML-CSS-JS Prettify 一款集成了格式化（美化）html、css、js三种文件类型的插件&lt;/li&gt;
  &lt;li&gt;…&lt;/li&gt;
&lt;/ul&gt;

</description>
      </item>
    
      <item>
        <title>神级注释</title>
        <link>https://gorpeln.com//article/15500354146</link>
        <guid isPermaLink="true">https://gorpeln.com//article/15500354146</guid>
        <pubDate>Wed, 13 Feb 2019 00:00:00 +0800</pubDate>
        <description>&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 * 这个公司没有年终奖的,兄弟别指望了,也别来了,我准备辞职了
 * 另外这个项目有很多*Bug* 你坚持不了多久的,拜拜!
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 * You may think you know what the following code does.
 * But you dont. Trust me.
 * Fiddle with it, and youll spend many a sleepless
 * night cursing the moment you thought youd be clever
 * enough to &quot;optimize&quot; the code below.
 * Now close this file and go play with something else.
 */
/***
 * 你可能会认为你读得懂以下的代码。但是你不会懂的，相信我吧。
 * 要是你尝试玩弄这段代码的话，你将会在无尽的通宵中不断地咒骂自己为什么会认为自己聪明到可以优化这段代码。
 * 现在请关闭这个文件去玩点别的吧。
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 * somedev1 -  6/7/02 Adding temporary tracking of Login screen
 * somedev2 -  5/22/07 Temporary my ass
 */
/***
 * 一些修改1 - 2002/6/7 增加临时的跟踪登录界面
 * 一些修改2 - 2007/5/22 我临时的犯傻
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 * 程序员1（于2014年06月07日）：在这个坑临时加入一些调料
 * 程序员2（于2015年05月22日）：临你个屁啊
 * 程序员3（于2016年07月23日）：楼上都是狗屎，鉴定完毕
 * 程序员4（于2017年08月02日）：fuck 楼上，三年了，这坑还在！！！
 * 程序员5（于2018年08月21日）：哈哈哈，这坑居然坑了这么多人，幸好我也不用填了，系统终止运行了，you're died
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 * For the brave souls who get this far: You are the chosen ones,
 * the valiant knights of programming who toil away, without rest,
 * fixing our most awful code. To you, true saviors, kings of men,
 * I say this: never gonna give you up, never gonna let you down,
 * never gonna run around and desert you. Never gonna make you cry,
 * never gonna say goodbye. Never gonna tell a lie and hurt you.
 */
/***
 * 致终于来到这里的勇敢的人：
 * 你是被上帝选中的人，是英勇的、不敌辛苦的、不眠不休的来修改我们这最棘手的代码的编程骑士。
 * 你，我们的救世主，人中之龙，我要对你说：永远不要放弃，永远不要对自己失望，永远不要逃走，辜负了自己，
 * 永远不要哭啼，永远不要说再见，永远不要说谎来伤害自己。
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 * Dear maintainer:
 *
 * Once you are done trying to 'optimize' this routine,
 * and have realized what a terrible mistake that was,
 * please increment the following counter as a warning
 * to the next guy:
 *
 * total_hours_wasted_here = 42
 */
/***
 * 亲爱的维护者：
 *
 * 如果你尝试了对这段程序进行'优化'
 * 下面这个计数器的个数用来对后来人进行警告
 *
 * 浪费在这里的总时间 = 42h
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 * When I wrote this, only God and I understood what I was doing
 * Now, God only knows
 */
/***
* 写这段代码的时候，只有上帝和我知道它是干嘛的
* 现在，只有上帝知道
*/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// drunk, fix later
// 有点晕了，以后再修改
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// Magic. Do not touch.
// 神奇。勿动。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;#define TRUE FALSE// Happy debugging suckers
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// I'm sorry.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/////////////////////////////////////// this is a well commented line
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// To understand recursion, see the bottom of this file
At the bottom of the file:
// To understand recursion, see the top of this file
// 想要明白递归须看文件末尾
到了文末
// 想要明白递归须看文件顶部
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// This code sucks, you know it and I know it.  
// Move on and call me an idiot later.
// 你我都知道这代码很烂
// 先不要骂我2B了，请先继续往下看
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// I am not sure why this works but it fixes the problem.
// 虽然我不知道为什么这样管用，但它却是修复了问题
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// If this comment is removed the program will blow up
// 如果删了此处注释程序就炸了
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// This function has been here since 1987. DON'T FXXKING TOUCH IT
// 这函数1987年就这在了，别他娘动它
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// no comments for you
// it was hard to write
// so it should be hard to read
// 难写的代码，肯定很难读。因此，我没有注释留给你。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// I am not responsible of this code.
// They made me write it, against my will.
// 下面的代码，我不负责。因为是他们逼我写的，违背了我的意愿。
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;br /&gt;
&lt;br /&gt;&lt;/p&gt;

&lt;hr /&gt;
&lt;hr /&gt;
&lt;hr /&gt;

&lt;h3 id=&quot;以下为魔性图&quot;&gt;以下为魔性图&lt;/h3&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 *                    _ooOoo_
 *                   o8888888o
 *                   88&quot; . &quot;88
 *                   (| -_- |)
 *                    O\ = /O
 *                ____/`---'\____
 *              .   ' \\| |// `.
 *               / \\||| : |||// \
 *             / _||||| -:- |||||- \
 *               | | \\\ - /// | |
 *             | \_| ''\---/'' | |
 *              \ .-\__ `-` ___/-. /
 *           ___`. .' /--.--\ `. . __
 *        .&quot;&quot; '&amp;lt; `.___\_&amp;lt;|&amp;gt;_/___.' &amp;gt;'&quot;&quot;.
 *       | | : `- \`.;`\ _ /`;.`/ - ` : | |
 *         \ \ `-. \_ __\ /__ _/ .-` / /
 * ======`-.____`-.___\_____/___.-`____.-'======
 *                    `=---='
 *
 * .............................................
 *          佛祖保佑             永无BUG
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 * _ooOoo_
 * o8888888o
 * 88&quot; . &quot;88
 * (| -_- |)
 *  O\ = /O
 * ___/`---'\____
 * .   ' \\| |// `.
 * / \\||| : |||// \
 * / _||||| -:- |||||- \
 * | | \\\ - /// | |
 * | \_| ''\---/'' | |
 * \ .-\__ `-` ___/-. /
 * ___`. .' /--.--\ `. . __
 * .&quot;&quot; '&amp;lt; `.___\_&amp;lt;|&amp;gt;_/___.' &amp;gt;'&quot;&quot;.
 * | | : `- \`.;`\ _ /`;.`/ - ` : | |
 * \ \ `-. \_ __\ /__ _/ .-` / /
 * ======`-.____`-.___\_____/___.-`____.-'======
 * `=---='
 *          .............................................
 *           佛曰：bug泛滥，我已瘫痪！
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 *  佛曰:
 *          写字楼里写字间，写字间里程序员；
 *          程序人员写程序，又拿程序换酒钱。
 *          酒醒只在网上坐，酒醉还来网下眠；
 *          酒醉酒醒日复日，网上网下年复年。
 *          但愿老死电脑间，不愿鞠躬老板前；
 *          奔驰宝马贵者趣，公交自行程序员。
 *          别人笑我忒疯癫，我笑自己命太贱；
 *          不见满街漂亮妹，哪个归得程序员？
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 *      ┌─┐       ┌─┐
 *   ┌──┘ ┴───────┘ ┴──┐
 *   │                 │
 *   │       ───       │
 *   │  ─┬┘       └┬─  │
 *   │                 │
 *   │       ─┴─       │
 *   │                 │
 *   └───┐         ┌───┘
 *       │         │
 *       │         │
 *       │         │
 *       │         └──────────────┐
 *       │                        │
 *       │                        ├─┐
 *       │                        ┌─┘
 *       │                        │
 *       └─┐  ┐  ┌───────┬──┐  ┌──┘
 *         │ ─┤ ─┤       │ ─┤ ─┤
 *         └──┴──┘       └──┴──┘
 *                神兽保佑
 *               代码无BUG!
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 *                  ___====-_  _-====___
 *            _--^^^#####//      \\#####^^^--_
 *         _-^##########// (    ) \\##########^-_
 *        -############//  |\^^/|  \\############-
 *      _/############//   (@::@)   \\############\_
 *     /#############((     \\//     ))#############\
 *    -###############\\    (oo)    //###############-
 *   -#################\\  / VV \  //#################-
 *  -###################\\/      \//###################-
 * _#/|##########/\######(   /\   )######/\##########|\#_
 * |/ |#/\#/\#/\/  \#/\##\  |  |  /##/\#/  \/\#/\#/\#| \|
 * `  |/  V  V  `   V  \#\| |  | |/#/  V   '  V  V  \|  '
 *    `   `  `      `   / | |  | | \   '      '  '   '
 *                     (  | |  | |  )
 *                    __\ | |  | | /__
 *                   (vvv(VVV)(VVV)vvv)                
 *                        神兽保佑
 *                       代码无BUG!
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 *
 *
 *                                                    __----~~~~~~~~~~~------___
 *                                   .  .   ~~//====......          __--~ ~~
 *                   -.            \_|//     |||\\  ~~~~~~::::... /~
 *                ___-==_       _-~o~  \/    |||  \\            _/~~-
 *        __---~~~.==~||\=_    -_--~/_-~|-   |\\   \\        _/~
 *    _-~~     .=~    |  \\-_    '-~7  /-   /  ||    \      /
 *  .~       .~       |   \\ -_    /  /-   /   ||      \   /
 * /  ____  /         |     \\ ~-_/  /|- _/   .||       \ /
 * |~~    ~~|--~~~~--_ \     ~==-/   | \~--===~~        .\
 *          '         ~-|      /|    |-~\~~       __--~~
 *                      |-~~-_/ |    |   ~\_   _-~            /\
 *                           /  \     \__   \/~                \__
 *                       _--~ _/ | .-~~____--~-/                  ~~==.
 *                      ((-&amp;gt;/~   '.|||' -_|    ~~-/ ,              . _||
 *                                 -_     ~\      ~~---l__i__i__i--~~_/
 *                                 _-~-__   ~)  \--______________--~~
 *                               //.-~~~-~_--~- |-------~~~~~~~~
 *                                      //.-~~~--\
 *                               神兽保佑
 *                              代码无BUG!
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 *                 .-~~~~~~~~~-._       _.-~~~~~~~~~-.
 *             __.'              ~.   .~              `.__
 *           .'//                  \./                  \\`.
 *         .'//                     |                     \\`.
 *       .'// .-~&quot;&quot;&quot;&quot;&quot;&quot;&quot;~~~~-._     |     _,-~~~~&quot;&quot;&quot;&quot;&quot;&quot;&quot;~-. \\`.
 *     .'//.-&quot;                 `-.  |  .-'                 &quot;-.\\`.
 *   .'//______.============-..   \ | /   ..-============.______\\`.
 * .'______________________________\|/______________________________`.
 *
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;/***
 *
 *   █████▒█    ██  ▄████▄   ██ ▄█▀       ██████╗ ██╗   ██╗ ██████╗
 * ▓██   ▒ ██  ▓██▒▒██▀ ▀█   ██▄█▒        ██╔══██╗██║   ██║██╔════╝
 * ▒████ ░▓██  ▒██░▒▓█    ▄ ▓███▄░        ██████╔╝██║   ██║██║  ███╗
 * ░▓█▒  ░▓▓█  ░██░▒▓▓▄ ▄██▒▓██ █▄        ██╔══██╗██║   ██║██║   ██║
 * ░▒█░   ▒▒█████▓ ▒ ▓███▀ ░▒██▒ █▄       ██████╔╝╚██████╔╝╚██████╔╝
 *  ▒ ░   ░▒▓▒ ▒ ▒ ░ ░▒ ▒  ░▒ ▒▒ ▓▒       ╚═════╝  ╚═════╝  ╚═════╝
 *  ░     ░░▒░ ░ ░   ░  ▒   ░ ░▒ ▒░
 *  ░ ░    ░░░ ░ ░ ░        ░ ░░ ░
 *           ░     ░ ░      ░  ░
 */
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

</description>
      </item>
    
  </channel>
</rss>